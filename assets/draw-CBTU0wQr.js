var Vp=Object.defineProperty;var $p=(C,i,r)=>i in C?Vp(C,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):C[i]=r;var ht=(C,i,r)=>$p(C,typeof i!="symbol"?i+"":i,r);import{c as Mi,S as Bn,a as Yp,i as Ou,f as Xp,d as zp,r as Zp,G as Jp,u as Wi,l as Tt,E as Mn,b as Un,e as Qp,g as jp,h as e0,j as Gt,m as t0,k as n0,n as i0,o as Gu,p as r0,q as s0,s as bu,t as o0,v as a0,w as u0,x as l0,y as h0,z as f0,A as Us,P as bt,B as c0,C as d0,D as g0,F as _0,H as p0,I as Cu,J as m0,K as v0,L as y0,M as C0,N as Ki,O as x0,Q as w0,R as S0,T as Ji,U as Bu,V as qi,W as oe,X as Bt,Y as T0,Z as Hi,_ as E0,$ as Uu,a0 as ke,a1 as A0,a2 as pe,a3 as Vi,a4 as xu,a5 as Os,a6 as ku,a7 as Qi,a8 as P0,a9 as F0,aa as I0,ab as L0,ac as R0,ad as sn,ae as $i,af as Ss,ag as Qe,ah as $e,ai as On,aj as D0,ak as Nu,al as Wu,am as M0,an as Ku,ao as O0,ap as G0,aq as wu,ar as b0,as as B0,at as U0,au as k0,av as N0,aw as W0,ax as K0,ay as q0,az as H0,aA as Su,aB as V0,aC as Tu,aD as $0,aE as Y0}from"./background-layer-group-8hBJptBk.js";import{l as X0,i as qu,a as Hu,b as z0,c as Z0,V as ks,d as Ns,F as ct,R as Vu,e as Yi,O as $u,f as J0}from"./overlay-layer-group-C7FaNVqM.js";var Rn={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var Q0=Rn.exports,Eu;function j0(){return Eu||(Eu=1,function(C,i){(function(){var r,o="4.17.21",u=200,f="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",_="Invalid `variable` option passed into `_.template`",m="__lodash_hash_undefined__",x=500,S="__lodash_placeholder__",I=1,P=2,F=4,M=1,k=2,K=1,J=2,ae=4,ee=8,fe=16,Le=32,an=64,je=128,un=256,tr=512,zu=30,Zu="...",Ju=800,Qu=16,Ws=1,ju=2,el=3,kn=1/0,Ut=9007199254740991,tl=17976931348623157e292,Nn=NaN,Xe=4294967295,nl=Xe-1,il=Xe>>>1,rl=[["ary",je],["bind",K],["bindKey",J],["curry",ee],["curryRight",fe],["flip",tr],["partial",Le],["partialRight",an],["rearg",un]],kt="[object Arguments]",Wn="[object Array]",sl="[object AsyncFunction]",ln="[object Boolean]",hn="[object Date]",ol="[object DOMException]",Kn="[object Error]",qn="[object Function]",Ks="[object GeneratorFunction]",Ne="[object Map]",fn="[object Number]",al="[object Null]",et="[object Object]",qs="[object Promise]",ul="[object Proxy]",cn="[object RegExp]",We="[object Set]",dn="[object String]",Hn="[object Symbol]",ll="[object Undefined]",gn="[object WeakMap]",hl="[object WeakSet]",_n="[object ArrayBuffer]",Nt="[object DataView]",nr="[object Float32Array]",ir="[object Float64Array]",rr="[object Int8Array]",sr="[object Int16Array]",or="[object Int32Array]",ar="[object Uint8Array]",ur="[object Uint8ClampedArray]",lr="[object Uint16Array]",hr="[object Uint32Array]",fl=/\b__p \+= '';/g,cl=/\b(__p \+=) '' \+/g,dl=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Hs=/&(?:amp|lt|gt|quot|#39);/g,Vs=/[&<>"']/g,gl=RegExp(Hs.source),_l=RegExp(Vs.source),pl=/<%-([\s\S]+?)%>/g,ml=/<%([\s\S]+?)%>/g,$s=/<%=([\s\S]+?)%>/g,vl=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,yl=/^\w*$/,Cl=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,fr=/[\\^$.*+?()[\]{}|]/g,xl=RegExp(fr.source),cr=/^\s+/,wl=/\s/,Sl=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Tl=/\{\n\/\* \[wrapped with (.+)\] \*/,El=/,? & /,Al=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Pl=/[()=,{}\[\]\/\s]/,Fl=/\\(\\)?/g,Il=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ys=/\w*$/,Ll=/^[-+]0x[0-9a-f]+$/i,Rl=/^0b[01]+$/i,Dl=/^\[object .+?Constructor\]$/,Ml=/^0o[0-7]+$/i,Ol=/^(?:0|[1-9]\d*)$/,Gl=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vn=/($^)/,bl=/['\n\r\u2028\u2029\\]/g,$n="\\ud800-\\udfff",Bl="\\u0300-\\u036f",Ul="\\ufe20-\\ufe2f",kl="\\u20d0-\\u20ff",Xs=Bl+Ul+kl,zs="\\u2700-\\u27bf",Zs="a-z\\xdf-\\xf6\\xf8-\\xff",Nl="\\xac\\xb1\\xd7\\xf7",Wl="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Kl="\\u2000-\\u206f",ql=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Js="A-Z\\xc0-\\xd6\\xd8-\\xde",Qs="\\ufe0e\\ufe0f",js=Nl+Wl+Kl+ql,dr="['’]",Hl="["+$n+"]",eo="["+js+"]",Yn="["+Xs+"]",to="\\d+",Vl="["+zs+"]",no="["+Zs+"]",io="[^"+$n+js+to+zs+Zs+Js+"]",gr="\\ud83c[\\udffb-\\udfff]",$l="(?:"+Yn+"|"+gr+")",ro="[^"+$n+"]",_r="(?:\\ud83c[\\udde6-\\uddff]){2}",pr="[\\ud800-\\udbff][\\udc00-\\udfff]",Wt="["+Js+"]",so="\\u200d",oo="(?:"+no+"|"+io+")",Yl="(?:"+Wt+"|"+io+")",ao="(?:"+dr+"(?:d|ll|m|re|s|t|ve))?",uo="(?:"+dr+"(?:D|LL|M|RE|S|T|VE))?",lo=$l+"?",ho="["+Qs+"]?",Xl="(?:"+so+"(?:"+[ro,_r,pr].join("|")+")"+ho+lo+")*",zl="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Zl="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",fo=ho+lo+Xl,Jl="(?:"+[Vl,_r,pr].join("|")+")"+fo,Ql="(?:"+[ro+Yn+"?",Yn,_r,pr,Hl].join("|")+")",jl=RegExp(dr,"g"),eh=RegExp(Yn,"g"),mr=RegExp(gr+"(?="+gr+")|"+Ql+fo,"g"),th=RegExp([Wt+"?"+no+"+"+ao+"(?="+[eo,Wt,"$"].join("|")+")",Yl+"+"+uo+"(?="+[eo,Wt+oo,"$"].join("|")+")",Wt+"?"+oo+"+"+ao,Wt+"+"+uo,Zl,zl,to,Jl].join("|"),"g"),nh=RegExp("["+so+$n+Xs+Qs+"]"),ih=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rh=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],sh=-1,j={};j[nr]=j[ir]=j[rr]=j[sr]=j[or]=j[ar]=j[ur]=j[lr]=j[hr]=!0,j[kt]=j[Wn]=j[_n]=j[ln]=j[Nt]=j[hn]=j[Kn]=j[qn]=j[Ne]=j[fn]=j[et]=j[cn]=j[We]=j[dn]=j[gn]=!1;var Q={};Q[kt]=Q[Wn]=Q[_n]=Q[Nt]=Q[ln]=Q[hn]=Q[nr]=Q[ir]=Q[rr]=Q[sr]=Q[or]=Q[Ne]=Q[fn]=Q[et]=Q[cn]=Q[We]=Q[dn]=Q[Hn]=Q[ar]=Q[ur]=Q[lr]=Q[hr]=!0,Q[Kn]=Q[qn]=Q[gn]=!1;var oh={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},ah={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},uh={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},lh={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},hh=parseFloat,fh=parseInt,co=typeof Mi=="object"&&Mi&&Mi.Object===Object&&Mi,ch=typeof self=="object"&&self&&self.Object===Object&&self,ce=co||ch||Function("return this")(),vr=i&&!i.nodeType&&i,At=vr&&!0&&C&&!C.nodeType&&C,go=At&&At.exports===vr,yr=go&&co.process,Re=function(){try{var p=At&&At.require&&At.require("util").types;return p||yr&&yr.binding&&yr.binding("util")}catch{}}(),_o=Re&&Re.isArrayBuffer,po=Re&&Re.isDate,mo=Re&&Re.isMap,vo=Re&&Re.isRegExp,yo=Re&&Re.isSet,Co=Re&&Re.isTypedArray;function Te(p,w,y){switch(y.length){case 0:return p.call(w);case 1:return p.call(w,y[0]);case 2:return p.call(w,y[0],y[1]);case 3:return p.call(w,y[0],y[1],y[2])}return p.apply(w,y)}function dh(p,w,y,R){for(var B=-1,Y=p==null?0:p.length;++B<Y;){var ue=p[B];w(R,ue,y(ue),p)}return R}function De(p,w){for(var y=-1,R=p==null?0:p.length;++y<R&&w(p[y],y,p)!==!1;);return p}function gh(p,w){for(var y=p==null?0:p.length;y--&&w(p[y],y,p)!==!1;);return p}function xo(p,w){for(var y=-1,R=p==null?0:p.length;++y<R;)if(!w(p[y],y,p))return!1;return!0}function gt(p,w){for(var y=-1,R=p==null?0:p.length,B=0,Y=[];++y<R;){var ue=p[y];w(ue,y,p)&&(Y[B++]=ue)}return Y}function Xn(p,w){var y=p==null?0:p.length;return!!y&&Kt(p,w,0)>-1}function Cr(p,w,y){for(var R=-1,B=p==null?0:p.length;++R<B;)if(y(w,p[R]))return!0;return!1}function te(p,w){for(var y=-1,R=p==null?0:p.length,B=Array(R);++y<R;)B[y]=w(p[y],y,p);return B}function _t(p,w){for(var y=-1,R=w.length,B=p.length;++y<R;)p[B+y]=w[y];return p}function xr(p,w,y,R){var B=-1,Y=p==null?0:p.length;for(R&&Y&&(y=p[++B]);++B<Y;)y=w(y,p[B],B,p);return y}function _h(p,w,y,R){var B=p==null?0:p.length;for(R&&B&&(y=p[--B]);B--;)y=w(y,p[B],B,p);return y}function wr(p,w){for(var y=-1,R=p==null?0:p.length;++y<R;)if(w(p[y],y,p))return!0;return!1}var ph=Sr("length");function mh(p){return p.split("")}function vh(p){return p.match(Al)||[]}function wo(p,w,y){var R;return y(p,function(B,Y,ue){if(w(B,Y,ue))return R=Y,!1}),R}function zn(p,w,y,R){for(var B=p.length,Y=y+(R?1:-1);R?Y--:++Y<B;)if(w(p[Y],Y,p))return Y;return-1}function Kt(p,w,y){return w===w?Lh(p,w,y):zn(p,So,y)}function yh(p,w,y,R){for(var B=y-1,Y=p.length;++B<Y;)if(R(p[B],w))return B;return-1}function So(p){return p!==p}function To(p,w){var y=p==null?0:p.length;return y?Er(p,w)/y:Nn}function Sr(p){return function(w){return w==null?r:w[p]}}function Tr(p){return function(w){return p==null?r:p[w]}}function Eo(p,w,y,R,B){return B(p,function(Y,ue,Z){y=R?(R=!1,Y):w(y,Y,ue,Z)}),y}function Ch(p,w){var y=p.length;for(p.sort(w);y--;)p[y]=p[y].value;return p}function Er(p,w){for(var y,R=-1,B=p.length;++R<B;){var Y=w(p[R]);Y!==r&&(y=y===r?Y:y+Y)}return y}function Ar(p,w){for(var y=-1,R=Array(p);++y<p;)R[y]=w(y);return R}function xh(p,w){return te(w,function(y){return[y,p[y]]})}function Ao(p){return p&&p.slice(0,Lo(p)+1).replace(cr,"")}function Ee(p){return function(w){return p(w)}}function Pr(p,w){return te(w,function(y){return p[y]})}function pn(p,w){return p.has(w)}function Po(p,w){for(var y=-1,R=p.length;++y<R&&Kt(w,p[y],0)>-1;);return y}function Fo(p,w){for(var y=p.length;y--&&Kt(w,p[y],0)>-1;);return y}function wh(p,w){for(var y=p.length,R=0;y--;)p[y]===w&&++R;return R}var Sh=Tr(oh),Th=Tr(ah);function Eh(p){return"\\"+lh[p]}function Ah(p,w){return p==null?r:p[w]}function qt(p){return nh.test(p)}function Ph(p){return ih.test(p)}function Fh(p){for(var w,y=[];!(w=p.next()).done;)y.push(w.value);return y}function Fr(p){var w=-1,y=Array(p.size);return p.forEach(function(R,B){y[++w]=[B,R]}),y}function Io(p,w){return function(y){return p(w(y))}}function pt(p,w){for(var y=-1,R=p.length,B=0,Y=[];++y<R;){var ue=p[y];(ue===w||ue===S)&&(p[y]=S,Y[B++]=y)}return Y}function Zn(p){var w=-1,y=Array(p.size);return p.forEach(function(R){y[++w]=R}),y}function Ih(p){var w=-1,y=Array(p.size);return p.forEach(function(R){y[++w]=[R,R]}),y}function Lh(p,w,y){for(var R=y-1,B=p.length;++R<B;)if(p[R]===w)return R;return-1}function Rh(p,w,y){for(var R=y+1;R--;)if(p[R]===w)return R;return R}function Ht(p){return qt(p)?Mh(p):ph(p)}function Ke(p){return qt(p)?Oh(p):mh(p)}function Lo(p){for(var w=p.length;w--&&wl.test(p.charAt(w)););return w}var Dh=Tr(uh);function Mh(p){for(var w=mr.lastIndex=0;mr.test(p);)++w;return w}function Oh(p){return p.match(mr)||[]}function Gh(p){return p.match(th)||[]}var bh=function p(w){w=w==null?ce:Vt.defaults(ce.Object(),w,Vt.pick(ce,rh));var y=w.Array,R=w.Date,B=w.Error,Y=w.Function,ue=w.Math,Z=w.Object,Ir=w.RegExp,Bh=w.String,Me=w.TypeError,Jn=y.prototype,Uh=Y.prototype,$t=Z.prototype,Qn=w["__core-js_shared__"],jn=Uh.toString,z=$t.hasOwnProperty,kh=0,Ro=function(){var e=/[^.]+$/.exec(Qn&&Qn.keys&&Qn.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ei=$t.toString,Nh=jn.call(Z),Wh=ce._,Kh=Ir("^"+jn.call(z).replace(fr,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ti=go?w.Buffer:r,mt=w.Symbol,ni=w.Uint8Array,Do=ti?ti.allocUnsafe:r,ii=Io(Z.getPrototypeOf,Z),Mo=Z.create,Oo=$t.propertyIsEnumerable,ri=Jn.splice,Go=mt?mt.isConcatSpreadable:r,mn=mt?mt.iterator:r,Pt=mt?mt.toStringTag:r,si=function(){try{var e=Dt(Z,"defineProperty");return e({},"",{}),e}catch{}}(),qh=w.clearTimeout!==ce.clearTimeout&&w.clearTimeout,Hh=R&&R.now!==ce.Date.now&&R.now,Vh=w.setTimeout!==ce.setTimeout&&w.setTimeout,oi=ue.ceil,ai=ue.floor,Lr=Z.getOwnPropertySymbols,$h=ti?ti.isBuffer:r,bo=w.isFinite,Yh=Jn.join,Xh=Io(Z.keys,Z),le=ue.max,ge=ue.min,zh=R.now,Zh=w.parseInt,Bo=ue.random,Jh=Jn.reverse,Rr=Dt(w,"DataView"),vn=Dt(w,"Map"),Dr=Dt(w,"Promise"),Yt=Dt(w,"Set"),yn=Dt(w,"WeakMap"),Cn=Dt(Z,"create"),ui=yn&&new yn,Xt={},Qh=Mt(Rr),jh=Mt(vn),ef=Mt(Dr),tf=Mt(Yt),nf=Mt(yn),li=mt?mt.prototype:r,xn=li?li.valueOf:r,Uo=li?li.toString:r;function l(e){if(ie(e)&&!U(e)&&!(e instanceof V)){if(e instanceof Oe)return e;if(z.call(e,"__wrapped__"))return ka(e)}return new Oe(e)}var zt=function(){function e(){}return function(t){if(!ne(t))return{};if(Mo)return Mo(t);e.prototype=t;var n=new e;return e.prototype=r,n}}();function hi(){}function Oe(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=r}l.templateSettings={escape:pl,evaluate:ml,interpolate:$s,variable:"",imports:{_:l}},l.prototype=hi.prototype,l.prototype.constructor=l,Oe.prototype=zt(hi.prototype),Oe.prototype.constructor=Oe;function V(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Xe,this.__views__=[]}function rf(){var e=new V(this.__wrapped__);return e.__actions__=Ce(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=Ce(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=Ce(this.__views__),e}function sf(){if(this.__filtered__){var e=new V(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function of(){var e=this.__wrapped__.value(),t=this.__dir__,n=U(e),s=t<0,a=n?e.length:0,h=vc(0,a,this.__views__),c=h.start,g=h.end,v=g-c,T=s?g:c-1,E=this.__iteratees__,A=E.length,L=0,D=ge(v,this.__takeCount__);if(!n||!s&&a==v&&D==v)return ua(e,this.__actions__);var G=[];e:for(;v--&&L<D;){T+=t;for(var W=-1,b=e[T];++W<A;){var H=E[W],$=H.iteratee,Fe=H.type,ye=$(b);if(Fe==ju)b=ye;else if(!ye){if(Fe==Ws)continue e;break e}}G[L++]=b}return G}V.prototype=zt(hi.prototype),V.prototype.constructor=V;function Ft(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function af(){this.__data__=Cn?Cn(null):{},this.size=0}function uf(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}function lf(e){var t=this.__data__;if(Cn){var n=t[e];return n===m?r:n}return z.call(t,e)?t[e]:r}function hf(e){var t=this.__data__;return Cn?t[e]!==r:z.call(t,e)}function ff(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Cn&&t===r?m:t,this}Ft.prototype.clear=af,Ft.prototype.delete=uf,Ft.prototype.get=lf,Ft.prototype.has=hf,Ft.prototype.set=ff;function tt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function cf(){this.__data__=[],this.size=0}function df(e){var t=this.__data__,n=fi(t,e);if(n<0)return!1;var s=t.length-1;return n==s?t.pop():ri.call(t,n,1),--this.size,!0}function gf(e){var t=this.__data__,n=fi(t,e);return n<0?r:t[n][1]}function _f(e){return fi(this.__data__,e)>-1}function pf(e,t){var n=this.__data__,s=fi(n,e);return s<0?(++this.size,n.push([e,t])):n[s][1]=t,this}tt.prototype.clear=cf,tt.prototype.delete=df,tt.prototype.get=gf,tt.prototype.has=_f,tt.prototype.set=pf;function nt(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var s=e[t];this.set(s[0],s[1])}}function mf(){this.size=0,this.__data__={hash:new Ft,map:new(vn||tt),string:new Ft}}function vf(e){var t=Si(this,e).delete(e);return this.size-=t?1:0,t}function yf(e){return Si(this,e).get(e)}function Cf(e){return Si(this,e).has(e)}function xf(e,t){var n=Si(this,e),s=n.size;return n.set(e,t),this.size+=n.size==s?0:1,this}nt.prototype.clear=mf,nt.prototype.delete=vf,nt.prototype.get=yf,nt.prototype.has=Cf,nt.prototype.set=xf;function It(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new nt;++t<n;)this.add(e[t])}function wf(e){return this.__data__.set(e,m),this}function Sf(e){return this.__data__.has(e)}It.prototype.add=It.prototype.push=wf,It.prototype.has=Sf;function qe(e){var t=this.__data__=new tt(e);this.size=t.size}function Tf(){this.__data__=new tt,this.size=0}function Ef(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Af(e){return this.__data__.get(e)}function Pf(e){return this.__data__.has(e)}function Ff(e,t){var n=this.__data__;if(n instanceof tt){var s=n.__data__;if(!vn||s.length<u-1)return s.push([e,t]),this.size=++n.size,this;n=this.__data__=new nt(s)}return n.set(e,t),this.size=n.size,this}qe.prototype.clear=Tf,qe.prototype.delete=Ef,qe.prototype.get=Af,qe.prototype.has=Pf,qe.prototype.set=Ff;function ko(e,t){var n=U(e),s=!n&&Ot(e),a=!n&&!s&&wt(e),h=!n&&!s&&!a&&jt(e),c=n||s||a||h,g=c?Ar(e.length,Bh):[],v=g.length;for(var T in e)(t||z.call(e,T))&&!(c&&(T=="length"||a&&(T=="offset"||T=="parent")||h&&(T=="buffer"||T=="byteLength"||T=="byteOffset")||ot(T,v)))&&g.push(T);return g}function No(e){var t=e.length;return t?e[qr(0,t-1)]:r}function If(e,t){return Ti(Ce(e),Lt(t,0,e.length))}function Lf(e){return Ti(Ce(e))}function Mr(e,t,n){(n!==r&&!He(e[t],n)||n===r&&!(t in e))&&it(e,t,n)}function wn(e,t,n){var s=e[t];(!(z.call(e,t)&&He(s,n))||n===r&&!(t in e))&&it(e,t,n)}function fi(e,t){for(var n=e.length;n--;)if(He(e[n][0],t))return n;return-1}function Rf(e,t,n,s){return vt(e,function(a,h,c){t(s,a,n(a),c)}),s}function Wo(e,t){return e&&Ze(t,he(t),e)}function Df(e,t){return e&&Ze(t,we(t),e)}function it(e,t,n){t=="__proto__"&&si?si(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Or(e,t){for(var n=-1,s=t.length,a=y(s),h=e==null;++n<s;)a[n]=h?r:gs(e,t[n]);return a}function Lt(e,t,n){return e===e&&(n!==r&&(e=e<=n?e:n),t!==r&&(e=e>=t?e:t)),e}function Ge(e,t,n,s,a,h){var c,g=t&I,v=t&P,T=t&F;if(n&&(c=a?n(e,s,a,h):n(e)),c!==r)return c;if(!ne(e))return e;var E=U(e);if(E){if(c=Cc(e),!g)return Ce(e,c)}else{var A=_e(e),L=A==qn||A==Ks;if(wt(e))return fa(e,g);if(A==et||A==kt||L&&!a){if(c=v||L?{}:La(e),!g)return v?lc(e,Df(c,e)):uc(e,Wo(c,e))}else{if(!Q[A])return a?e:{};c=xc(e,A,g)}}h||(h=new qe);var D=h.get(e);if(D)return D;h.set(e,c),su(e)?e.forEach(function(b){c.add(Ge(b,t,n,b,e,h))}):iu(e)&&e.forEach(function(b,H){c.set(H,Ge(b,t,n,H,e,h))});var G=T?v?es:jr:v?we:he,W=E?r:G(e);return De(W||e,function(b,H){W&&(H=b,b=e[H]),wn(c,H,Ge(b,t,n,H,e,h))}),c}function Mf(e){var t=he(e);return function(n){return Ko(n,e,t)}}function Ko(e,t,n){var s=n.length;if(e==null)return!s;for(e=Z(e);s--;){var a=n[s],h=t[a],c=e[a];if(c===r&&!(a in e)||!h(c))return!1}return!0}function qo(e,t,n){if(typeof e!="function")throw new Me(d);return In(function(){e.apply(r,n)},t)}function Sn(e,t,n,s){var a=-1,h=Xn,c=!0,g=e.length,v=[],T=t.length;if(!g)return v;n&&(t=te(t,Ee(n))),s?(h=Cr,c=!1):t.length>=u&&(h=pn,c=!1,t=new It(t));e:for(;++a<g;){var E=e[a],A=n==null?E:n(E);if(E=s||E!==0?E:0,c&&A===A){for(var L=T;L--;)if(t[L]===A)continue e;v.push(E)}else h(t,A,s)||v.push(E)}return v}var vt=pa(ze),Ho=pa(br,!0);function Of(e,t){var n=!0;return vt(e,function(s,a,h){return n=!!t(s,a,h),n}),n}function ci(e,t,n){for(var s=-1,a=e.length;++s<a;){var h=e[s],c=t(h);if(c!=null&&(g===r?c===c&&!Pe(c):n(c,g)))var g=c,v=h}return v}function Gf(e,t,n,s){var a=e.length;for(n=N(n),n<0&&(n=-n>a?0:a+n),s=s===r||s>a?a:N(s),s<0&&(s+=a),s=n>s?0:au(s);n<s;)e[n++]=t;return e}function Vo(e,t){var n=[];return vt(e,function(s,a,h){t(s,a,h)&&n.push(s)}),n}function de(e,t,n,s,a){var h=-1,c=e.length;for(n||(n=Sc),a||(a=[]);++h<c;){var g=e[h];t>0&&n(g)?t>1?de(g,t-1,n,s,a):_t(a,g):s||(a[a.length]=g)}return a}var Gr=ma(),$o=ma(!0);function ze(e,t){return e&&Gr(e,t,he)}function br(e,t){return e&&$o(e,t,he)}function di(e,t){return gt(t,function(n){return at(e[n])})}function Rt(e,t){t=Ct(t,e);for(var n=0,s=t.length;e!=null&&n<s;)e=e[Je(t[n++])];return n&&n==s?e:r}function Yo(e,t,n){var s=t(e);return U(e)?s:_t(s,n(e))}function me(e){return e==null?e===r?ll:al:Pt&&Pt in Z(e)?mc(e):Lc(e)}function Br(e,t){return e>t}function bf(e,t){return e!=null&&z.call(e,t)}function Bf(e,t){return e!=null&&t in Z(e)}function Uf(e,t,n){return e>=ge(t,n)&&e<le(t,n)}function Ur(e,t,n){for(var s=n?Cr:Xn,a=e[0].length,h=e.length,c=h,g=y(h),v=1/0,T=[];c--;){var E=e[c];c&&t&&(E=te(E,Ee(t))),v=ge(E.length,v),g[c]=!n&&(t||a>=120&&E.length>=120)?new It(c&&E):r}E=e[0];var A=-1,L=g[0];e:for(;++A<a&&T.length<v;){var D=E[A],G=t?t(D):D;if(D=n||D!==0?D:0,!(L?pn(L,G):s(T,G,n))){for(c=h;--c;){var W=g[c];if(!(W?pn(W,G):s(e[c],G,n)))continue e}L&&L.push(G),T.push(D)}}return T}function kf(e,t,n,s){return ze(e,function(a,h,c){t(s,n(a),h,c)}),s}function Tn(e,t,n){t=Ct(t,e),e=Oa(e,t);var s=e==null?e:e[Je(Be(t))];return s==null?r:Te(s,e,n)}function Xo(e){return ie(e)&&me(e)==kt}function Nf(e){return ie(e)&&me(e)==_n}function Wf(e){return ie(e)&&me(e)==hn}function En(e,t,n,s,a){return e===t?!0:e==null||t==null||!ie(e)&&!ie(t)?e!==e&&t!==t:Kf(e,t,n,s,En,a)}function Kf(e,t,n,s,a,h){var c=U(e),g=U(t),v=c?Wn:_e(e),T=g?Wn:_e(t);v=v==kt?et:v,T=T==kt?et:T;var E=v==et,A=T==et,L=v==T;if(L&&wt(e)){if(!wt(t))return!1;c=!0,E=!1}if(L&&!E)return h||(h=new qe),c||jt(e)?Pa(e,t,n,s,a,h):_c(e,t,v,n,s,a,h);if(!(n&M)){var D=E&&z.call(e,"__wrapped__"),G=A&&z.call(t,"__wrapped__");if(D||G){var W=D?e.value():e,b=G?t.value():t;return h||(h=new qe),a(W,b,n,s,h)}}return L?(h||(h=new qe),pc(e,t,n,s,a,h)):!1}function qf(e){return ie(e)&&_e(e)==Ne}function kr(e,t,n,s){var a=n.length,h=a,c=!s;if(e==null)return!h;for(e=Z(e);a--;){var g=n[a];if(c&&g[2]?g[1]!==e[g[0]]:!(g[0]in e))return!1}for(;++a<h;){g=n[a];var v=g[0],T=e[v],E=g[1];if(c&&g[2]){if(T===r&&!(v in e))return!1}else{var A=new qe;if(s)var L=s(T,E,v,e,t,A);if(!(L===r?En(E,T,M|k,s,A):L))return!1}}return!0}function zo(e){if(!ne(e)||Ec(e))return!1;var t=at(e)?Kh:Dl;return t.test(Mt(e))}function Hf(e){return ie(e)&&me(e)==cn}function Vf(e){return ie(e)&&_e(e)==We}function $f(e){return ie(e)&&Li(e.length)&&!!j[me(e)]}function Zo(e){return typeof e=="function"?e:e==null?Se:typeof e=="object"?U(e)?jo(e[0],e[1]):Qo(e):vu(e)}function Nr(e){if(!Fn(e))return Xh(e);var t=[];for(var n in Z(e))z.call(e,n)&&n!="constructor"&&t.push(n);return t}function Yf(e){if(!ne(e))return Ic(e);var t=Fn(e),n=[];for(var s in e)s=="constructor"&&(t||!z.call(e,s))||n.push(s);return n}function Wr(e,t){return e<t}function Jo(e,t){var n=-1,s=xe(e)?y(e.length):[];return vt(e,function(a,h,c){s[++n]=t(a,h,c)}),s}function Qo(e){var t=ns(e);return t.length==1&&t[0][2]?Da(t[0][0],t[0][1]):function(n){return n===e||kr(n,e,t)}}function jo(e,t){return rs(e)&&Ra(t)?Da(Je(e),t):function(n){var s=gs(n,e);return s===r&&s===t?_s(n,e):En(t,s,M|k)}}function gi(e,t,n,s,a){e!==t&&Gr(t,function(h,c){if(a||(a=new qe),ne(h))Xf(e,t,c,n,gi,s,a);else{var g=s?s(os(e,c),h,c+"",e,t,a):r;g===r&&(g=h),Mr(e,c,g)}},we)}function Xf(e,t,n,s,a,h,c){var g=os(e,n),v=os(t,n),T=c.get(v);if(T){Mr(e,n,T);return}var E=h?h(g,v,n+"",e,t,c):r,A=E===r;if(A){var L=U(v),D=!L&&wt(v),G=!L&&!D&&jt(v);E=v,L||D||G?U(g)?E=g:re(g)?E=Ce(g):D?(A=!1,E=fa(v,!0)):G?(A=!1,E=ca(v,!0)):E=[]:Ln(v)||Ot(v)?(E=g,Ot(g)?E=uu(g):(!ne(g)||at(g))&&(E=La(v))):A=!1}A&&(c.set(v,E),a(E,v,s,h,c),c.delete(v)),Mr(e,n,E)}function ea(e,t){var n=e.length;if(n)return t+=t<0?n:0,ot(t,n)?e[t]:r}function ta(e,t,n){t.length?t=te(t,function(h){return U(h)?function(c){return Rt(c,h.length===1?h[0]:h)}:h}):t=[Se];var s=-1;t=te(t,Ee(O()));var a=Jo(e,function(h,c,g){var v=te(t,function(T){return T(h)});return{criteria:v,index:++s,value:h}});return Ch(a,function(h,c){return ac(h,c,n)})}function zf(e,t){return na(e,t,function(n,s){return _s(e,s)})}function na(e,t,n){for(var s=-1,a=t.length,h={};++s<a;){var c=t[s],g=Rt(e,c);n(g,c)&&An(h,Ct(c,e),g)}return h}function Zf(e){return function(t){return Rt(t,e)}}function Kr(e,t,n,s){var a=s?yh:Kt,h=-1,c=t.length,g=e;for(e===t&&(t=Ce(t)),n&&(g=te(e,Ee(n)));++h<c;)for(var v=0,T=t[h],E=n?n(T):T;(v=a(g,E,v,s))>-1;)g!==e&&ri.call(g,v,1),ri.call(e,v,1);return e}function ia(e,t){for(var n=e?t.length:0,s=n-1;n--;){var a=t[n];if(n==s||a!==h){var h=a;ot(a)?ri.call(e,a,1):$r(e,a)}}return e}function qr(e,t){return e+ai(Bo()*(t-e+1))}function Jf(e,t,n,s){for(var a=-1,h=le(oi((t-e)/(n||1)),0),c=y(h);h--;)c[s?h:++a]=e,e+=n;return c}function Hr(e,t){var n="";if(!e||t<1||t>Ut)return n;do t%2&&(n+=e),t=ai(t/2),t&&(e+=e);while(t);return n}function q(e,t){return as(Ma(e,t,Se),e+"")}function Qf(e){return No(en(e))}function jf(e,t){var n=en(e);return Ti(n,Lt(t,0,n.length))}function An(e,t,n,s){if(!ne(e))return e;t=Ct(t,e);for(var a=-1,h=t.length,c=h-1,g=e;g!=null&&++a<h;){var v=Je(t[a]),T=n;if(v==="__proto__"||v==="constructor"||v==="prototype")return e;if(a!=c){var E=g[v];T=s?s(E,v,g):r,T===r&&(T=ne(E)?E:ot(t[a+1])?[]:{})}wn(g,v,T),g=g[v]}return e}var ra=ui?function(e,t){return ui.set(e,t),e}:Se,ec=si?function(e,t){return si(e,"toString",{configurable:!0,enumerable:!1,value:ms(t),writable:!0})}:Se;function tc(e){return Ti(en(e))}function be(e,t,n){var s=-1,a=e.length;t<0&&(t=-t>a?0:a+t),n=n>a?a:n,n<0&&(n+=a),a=t>n?0:n-t>>>0,t>>>=0;for(var h=y(a);++s<a;)h[s]=e[s+t];return h}function nc(e,t){var n;return vt(e,function(s,a,h){return n=t(s,a,h),!n}),!!n}function _i(e,t,n){var s=0,a=e==null?s:e.length;if(typeof t=="number"&&t===t&&a<=il){for(;s<a;){var h=s+a>>>1,c=e[h];c!==null&&!Pe(c)&&(n?c<=t:c<t)?s=h+1:a=h}return a}return Vr(e,t,Se,n)}function Vr(e,t,n,s){var a=0,h=e==null?0:e.length;if(h===0)return 0;t=n(t);for(var c=t!==t,g=t===null,v=Pe(t),T=t===r;a<h;){var E=ai((a+h)/2),A=n(e[E]),L=A!==r,D=A===null,G=A===A,W=Pe(A);if(c)var b=s||G;else T?b=G&&(s||L):g?b=G&&L&&(s||!D):v?b=G&&L&&!D&&(s||!W):D||W?b=!1:b=s?A<=t:A<t;b?a=E+1:h=E}return ge(h,nl)}function sa(e,t){for(var n=-1,s=e.length,a=0,h=[];++n<s;){var c=e[n],g=t?t(c):c;if(!n||!He(g,v)){var v=g;h[a++]=c===0?0:c}}return h}function oa(e){return typeof e=="number"?e:Pe(e)?Nn:+e}function Ae(e){if(typeof e=="string")return e;if(U(e))return te(e,Ae)+"";if(Pe(e))return Uo?Uo.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function yt(e,t,n){var s=-1,a=Xn,h=e.length,c=!0,g=[],v=g;if(n)c=!1,a=Cr;else if(h>=u){var T=t?null:dc(e);if(T)return Zn(T);c=!1,a=pn,v=new It}else v=t?[]:g;e:for(;++s<h;){var E=e[s],A=t?t(E):E;if(E=n||E!==0?E:0,c&&A===A){for(var L=v.length;L--;)if(v[L]===A)continue e;t&&v.push(A),g.push(E)}else a(v,A,n)||(v!==g&&v.push(A),g.push(E))}return g}function $r(e,t){return t=Ct(t,e),e=Oa(e,t),e==null||delete e[Je(Be(t))]}function aa(e,t,n,s){return An(e,t,n(Rt(e,t)),s)}function pi(e,t,n,s){for(var a=e.length,h=s?a:-1;(s?h--:++h<a)&&t(e[h],h,e););return n?be(e,s?0:h,s?h+1:a):be(e,s?h+1:0,s?a:h)}function ua(e,t){var n=e;return n instanceof V&&(n=n.value()),xr(t,function(s,a){return a.func.apply(a.thisArg,_t([s],a.args))},n)}function Yr(e,t,n){var s=e.length;if(s<2)return s?yt(e[0]):[];for(var a=-1,h=y(s);++a<s;)for(var c=e[a],g=-1;++g<s;)g!=a&&(h[a]=Sn(h[a]||c,e[g],t,n));return yt(de(h,1),t,n)}function la(e,t,n){for(var s=-1,a=e.length,h=t.length,c={};++s<a;){var g=s<h?t[s]:r;n(c,e[s],g)}return c}function Xr(e){return re(e)?e:[]}function zr(e){return typeof e=="function"?e:Se}function Ct(e,t){return U(e)?e:rs(e,t)?[e]:Ua(X(e))}var ic=q;function xt(e,t,n){var s=e.length;return n=n===r?s:n,!t&&n>=s?e:be(e,t,n)}var ha=qh||function(e){return ce.clearTimeout(e)};function fa(e,t){if(t)return e.slice();var n=e.length,s=Do?Do(n):new e.constructor(n);return e.copy(s),s}function Zr(e){var t=new e.constructor(e.byteLength);return new ni(t).set(new ni(e)),t}function rc(e,t){var n=t?Zr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}function sc(e){var t=new e.constructor(e.source,Ys.exec(e));return t.lastIndex=e.lastIndex,t}function oc(e){return xn?Z(xn.call(e)):{}}function ca(e,t){var n=t?Zr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function da(e,t){if(e!==t){var n=e!==r,s=e===null,a=e===e,h=Pe(e),c=t!==r,g=t===null,v=t===t,T=Pe(t);if(!g&&!T&&!h&&e>t||h&&c&&v&&!g&&!T||s&&c&&v||!n&&v||!a)return 1;if(!s&&!h&&!T&&e<t||T&&n&&a&&!s&&!h||g&&n&&a||!c&&a||!v)return-1}return 0}function ac(e,t,n){for(var s=-1,a=e.criteria,h=t.criteria,c=a.length,g=n.length;++s<c;){var v=da(a[s],h[s]);if(v){if(s>=g)return v;var T=n[s];return v*(T=="desc"?-1:1)}}return e.index-t.index}function ga(e,t,n,s){for(var a=-1,h=e.length,c=n.length,g=-1,v=t.length,T=le(h-c,0),E=y(v+T),A=!s;++g<v;)E[g]=t[g];for(;++a<c;)(A||a<h)&&(E[n[a]]=e[a]);for(;T--;)E[g++]=e[a++];return E}function _a(e,t,n,s){for(var a=-1,h=e.length,c=-1,g=n.length,v=-1,T=t.length,E=le(h-g,0),A=y(E+T),L=!s;++a<E;)A[a]=e[a];for(var D=a;++v<T;)A[D+v]=t[v];for(;++c<g;)(L||a<h)&&(A[D+n[c]]=e[a++]);return A}function Ce(e,t){var n=-1,s=e.length;for(t||(t=y(s));++n<s;)t[n]=e[n];return t}function Ze(e,t,n,s){var a=!n;n||(n={});for(var h=-1,c=t.length;++h<c;){var g=t[h],v=s?s(n[g],e[g],g,n,e):r;v===r&&(v=e[g]),a?it(n,g,v):wn(n,g,v)}return n}function uc(e,t){return Ze(e,is(e),t)}function lc(e,t){return Ze(e,Fa(e),t)}function mi(e,t){return function(n,s){var a=U(n)?dh:Rf,h=t?t():{};return a(n,e,O(s,2),h)}}function Zt(e){return q(function(t,n){var s=-1,a=n.length,h=a>1?n[a-1]:r,c=a>2?n[2]:r;for(h=e.length>3&&typeof h=="function"?(a--,h):r,c&&ve(n[0],n[1],c)&&(h=a<3?r:h,a=1),t=Z(t);++s<a;){var g=n[s];g&&e(t,g,s,h)}return t})}function pa(e,t){return function(n,s){if(n==null)return n;if(!xe(n))return e(n,s);for(var a=n.length,h=t?a:-1,c=Z(n);(t?h--:++h<a)&&s(c[h],h,c)!==!1;);return n}}function ma(e){return function(t,n,s){for(var a=-1,h=Z(t),c=s(t),g=c.length;g--;){var v=c[e?g:++a];if(n(h[v],v,h)===!1)break}return t}}function hc(e,t,n){var s=t&K,a=Pn(e);function h(){var c=this&&this!==ce&&this instanceof h?a:e;return c.apply(s?n:this,arguments)}return h}function va(e){return function(t){t=X(t);var n=qt(t)?Ke(t):r,s=n?n[0]:t.charAt(0),a=n?xt(n,1).join(""):t.slice(1);return s[e]()+a}}function Jt(e){return function(t){return xr(pu(_u(t).replace(jl,"")),e,"")}}function Pn(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=zt(e.prototype),s=e.apply(n,t);return ne(s)?s:n}}function fc(e,t,n){var s=Pn(e);function a(){for(var h=arguments.length,c=y(h),g=h,v=Qt(a);g--;)c[g]=arguments[g];var T=h<3&&c[0]!==v&&c[h-1]!==v?[]:pt(c,v);if(h-=T.length,h<n)return Sa(e,t,vi,a.placeholder,r,c,T,r,r,n-h);var E=this&&this!==ce&&this instanceof a?s:e;return Te(E,this,c)}return a}function ya(e){return function(t,n,s){var a=Z(t);if(!xe(t)){var h=O(n,3);t=he(t),n=function(g){return h(a[g],g,a)}}var c=e(t,n,s);return c>-1?a[h?t[c]:c]:r}}function Ca(e){return st(function(t){var n=t.length,s=n,a=Oe.prototype.thru;for(e&&t.reverse();s--;){var h=t[s];if(typeof h!="function")throw new Me(d);if(a&&!c&&wi(h)=="wrapper")var c=new Oe([],!0)}for(s=c?s:n;++s<n;){h=t[s];var g=wi(h),v=g=="wrapper"?ts(h):r;v&&ss(v[0])&&v[1]==(je|ee|Le|un)&&!v[4].length&&v[9]==1?c=c[wi(v[0])].apply(c,v[3]):c=h.length==1&&ss(h)?c[g]():c.thru(h)}return function(){var T=arguments,E=T[0];if(c&&T.length==1&&U(E))return c.plant(E).value();for(var A=0,L=n?t[A].apply(this,T):E;++A<n;)L=t[A].call(this,L);return L}})}function vi(e,t,n,s,a,h,c,g,v,T){var E=t&je,A=t&K,L=t&J,D=t&(ee|fe),G=t&tr,W=L?r:Pn(e);function b(){for(var H=arguments.length,$=y(H),Fe=H;Fe--;)$[Fe]=arguments[Fe];if(D)var ye=Qt(b),Ie=wh($,ye);if(s&&($=ga($,s,a,D)),h&&($=_a($,h,c,D)),H-=Ie,D&&H<T){var se=pt($,ye);return Sa(e,t,vi,b.placeholder,n,$,se,g,v,T-H)}var Ve=A?n:this,lt=L?Ve[e]:e;return H=$.length,g?$=Rc($,g):G&&H>1&&$.reverse(),E&&v<H&&($.length=v),this&&this!==ce&&this instanceof b&&(lt=W||Pn(lt)),lt.apply(Ve,$)}return b}function xa(e,t){return function(n,s){return kf(n,e,t(s),{})}}function yi(e,t){return function(n,s){var a;if(n===r&&s===r)return t;if(n!==r&&(a=n),s!==r){if(a===r)return s;typeof n=="string"||typeof s=="string"?(n=Ae(n),s=Ae(s)):(n=oa(n),s=oa(s)),a=e(n,s)}return a}}function Jr(e){return st(function(t){return t=te(t,Ee(O())),q(function(n){var s=this;return e(t,function(a){return Te(a,s,n)})})})}function Ci(e,t){t=t===r?" ":Ae(t);var n=t.length;if(n<2)return n?Hr(t,e):t;var s=Hr(t,oi(e/Ht(t)));return qt(t)?xt(Ke(s),0,e).join(""):s.slice(0,e)}function cc(e,t,n,s){var a=t&K,h=Pn(e);function c(){for(var g=-1,v=arguments.length,T=-1,E=s.length,A=y(E+v),L=this&&this!==ce&&this instanceof c?h:e;++T<E;)A[T]=s[T];for(;v--;)A[T++]=arguments[++g];return Te(L,a?n:this,A)}return c}function wa(e){return function(t,n,s){return s&&typeof s!="number"&&ve(t,n,s)&&(n=s=r),t=ut(t),n===r?(n=t,t=0):n=ut(n),s=s===r?t<n?1:-1:ut(s),Jf(t,n,s,e)}}function xi(e){return function(t,n){return typeof t=="string"&&typeof n=="string"||(t=Ue(t),n=Ue(n)),e(t,n)}}function Sa(e,t,n,s,a,h,c,g,v,T){var E=t&ee,A=E?c:r,L=E?r:c,D=E?h:r,G=E?r:h;t|=E?Le:an,t&=~(E?an:Le),t&ae||(t&=-4);var W=[e,t,a,D,A,G,L,g,v,T],b=n.apply(r,W);return ss(e)&&Ga(b,W),b.placeholder=s,ba(b,e,t)}function Qr(e){var t=ue[e];return function(n,s){if(n=Ue(n),s=s==null?0:ge(N(s),292),s&&bo(n)){var a=(X(n)+"e").split("e"),h=t(a[0]+"e"+(+a[1]+s));return a=(X(h)+"e").split("e"),+(a[0]+"e"+(+a[1]-s))}return t(n)}}var dc=Yt&&1/Zn(new Yt([,-0]))[1]==kn?function(e){return new Yt(e)}:Cs;function Ta(e){return function(t){var n=_e(t);return n==Ne?Fr(t):n==We?Ih(t):xh(t,e(t))}}function rt(e,t,n,s,a,h,c,g){var v=t&J;if(!v&&typeof e!="function")throw new Me(d);var T=s?s.length:0;if(T||(t&=-97,s=a=r),c=c===r?c:le(N(c),0),g=g===r?g:N(g),T-=a?a.length:0,t&an){var E=s,A=a;s=a=r}var L=v?r:ts(e),D=[e,t,n,s,a,E,A,h,c,g];if(L&&Fc(D,L),e=D[0],t=D[1],n=D[2],s=D[3],a=D[4],g=D[9]=D[9]===r?v?0:e.length:le(D[9]-T,0),!g&&t&(ee|fe)&&(t&=-25),!t||t==K)var G=hc(e,t,n);else t==ee||t==fe?G=fc(e,t,g):(t==Le||t==(K|Le))&&!a.length?G=cc(e,t,n,s):G=vi.apply(r,D);var W=L?ra:Ga;return ba(W(G,D),e,t)}function Ea(e,t,n,s){return e===r||He(e,$t[n])&&!z.call(s,n)?t:e}function Aa(e,t,n,s,a,h){return ne(e)&&ne(t)&&(h.set(t,e),gi(e,t,r,Aa,h),h.delete(t)),e}function gc(e){return Ln(e)?r:e}function Pa(e,t,n,s,a,h){var c=n&M,g=e.length,v=t.length;if(g!=v&&!(c&&v>g))return!1;var T=h.get(e),E=h.get(t);if(T&&E)return T==t&&E==e;var A=-1,L=!0,D=n&k?new It:r;for(h.set(e,t),h.set(t,e);++A<g;){var G=e[A],W=t[A];if(s)var b=c?s(W,G,A,t,e,h):s(G,W,A,e,t,h);if(b!==r){if(b)continue;L=!1;break}if(D){if(!wr(t,function(H,$){if(!pn(D,$)&&(G===H||a(G,H,n,s,h)))return D.push($)})){L=!1;break}}else if(!(G===W||a(G,W,n,s,h))){L=!1;break}}return h.delete(e),h.delete(t),L}function _c(e,t,n,s,a,h,c){switch(n){case Nt:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case _n:return!(e.byteLength!=t.byteLength||!h(new ni(e),new ni(t)));case ln:case hn:case fn:return He(+e,+t);case Kn:return e.name==t.name&&e.message==t.message;case cn:case dn:return e==t+"";case Ne:var g=Fr;case We:var v=s&M;if(g||(g=Zn),e.size!=t.size&&!v)return!1;var T=c.get(e);if(T)return T==t;s|=k,c.set(e,t);var E=Pa(g(e),g(t),s,a,h,c);return c.delete(e),E;case Hn:if(xn)return xn.call(e)==xn.call(t)}return!1}function pc(e,t,n,s,a,h){var c=n&M,g=jr(e),v=g.length,T=jr(t),E=T.length;if(v!=E&&!c)return!1;for(var A=v;A--;){var L=g[A];if(!(c?L in t:z.call(t,L)))return!1}var D=h.get(e),G=h.get(t);if(D&&G)return D==t&&G==e;var W=!0;h.set(e,t),h.set(t,e);for(var b=c;++A<v;){L=g[A];var H=e[L],$=t[L];if(s)var Fe=c?s($,H,L,t,e,h):s(H,$,L,e,t,h);if(!(Fe===r?H===$||a(H,$,n,s,h):Fe)){W=!1;break}b||(b=L=="constructor")}if(W&&!b){var ye=e.constructor,Ie=t.constructor;ye!=Ie&&"constructor"in e&&"constructor"in t&&!(typeof ye=="function"&&ye instanceof ye&&typeof Ie=="function"&&Ie instanceof Ie)&&(W=!1)}return h.delete(e),h.delete(t),W}function st(e){return as(Ma(e,r,Ka),e+"")}function jr(e){return Yo(e,he,is)}function es(e){return Yo(e,we,Fa)}var ts=ui?function(e){return ui.get(e)}:Cs;function wi(e){for(var t=e.name+"",n=Xt[t],s=z.call(Xt,t)?n.length:0;s--;){var a=n[s],h=a.func;if(h==null||h==e)return a.name}return t}function Qt(e){var t=z.call(l,"placeholder")?l:e;return t.placeholder}function O(){var e=l.iteratee||vs;return e=e===vs?Zo:e,arguments.length?e(arguments[0],arguments[1]):e}function Si(e,t){var n=e.__data__;return Tc(t)?n[typeof t=="string"?"string":"hash"]:n.map}function ns(e){for(var t=he(e),n=t.length;n--;){var s=t[n],a=e[s];t[n]=[s,a,Ra(a)]}return t}function Dt(e,t){var n=Ah(e,t);return zo(n)?n:r}function mc(e){var t=z.call(e,Pt),n=e[Pt];try{e[Pt]=r;var s=!0}catch{}var a=ei.call(e);return s&&(t?e[Pt]=n:delete e[Pt]),a}var is=Lr?function(e){return e==null?[]:(e=Z(e),gt(Lr(e),function(t){return Oo.call(e,t)}))}:xs,Fa=Lr?function(e){for(var t=[];e;)_t(t,is(e)),e=ii(e);return t}:xs,_e=me;(Rr&&_e(new Rr(new ArrayBuffer(1)))!=Nt||vn&&_e(new vn)!=Ne||Dr&&_e(Dr.resolve())!=qs||Yt&&_e(new Yt)!=We||yn&&_e(new yn)!=gn)&&(_e=function(e){var t=me(e),n=t==et?e.constructor:r,s=n?Mt(n):"";if(s)switch(s){case Qh:return Nt;case jh:return Ne;case ef:return qs;case tf:return We;case nf:return gn}return t});function vc(e,t,n){for(var s=-1,a=n.length;++s<a;){var h=n[s],c=h.size;switch(h.type){case"drop":e+=c;break;case"dropRight":t-=c;break;case"take":t=ge(t,e+c);break;case"takeRight":e=le(e,t-c);break}}return{start:e,end:t}}function yc(e){var t=e.match(Tl);return t?t[1].split(El):[]}function Ia(e,t,n){t=Ct(t,e);for(var s=-1,a=t.length,h=!1;++s<a;){var c=Je(t[s]);if(!(h=e!=null&&n(e,c)))break;e=e[c]}return h||++s!=a?h:(a=e==null?0:e.length,!!a&&Li(a)&&ot(c,a)&&(U(e)||Ot(e)))}function Cc(e){var t=e.length,n=new e.constructor(t);return t&&typeof e[0]=="string"&&z.call(e,"index")&&(n.index=e.index,n.input=e.input),n}function La(e){return typeof e.constructor=="function"&&!Fn(e)?zt(ii(e)):{}}function xc(e,t,n){var s=e.constructor;switch(t){case _n:return Zr(e);case ln:case hn:return new s(+e);case Nt:return rc(e,n);case nr:case ir:case rr:case sr:case or:case ar:case ur:case lr:case hr:return ca(e,n);case Ne:return new s;case fn:case dn:return new s(e);case cn:return sc(e);case We:return new s;case Hn:return oc(e)}}function wc(e,t){var n=t.length;if(!n)return e;var s=n-1;return t[s]=(n>1?"& ":"")+t[s],t=t.join(n>2?", ":" "),e.replace(Sl,`{
/* [wrapped with `+t+`] */
`)}function Sc(e){return U(e)||Ot(e)||!!(Go&&e&&e[Go])}function ot(e,t){var n=typeof e;return t=t??Ut,!!t&&(n=="number"||n!="symbol"&&Ol.test(e))&&e>-1&&e%1==0&&e<t}function ve(e,t,n){if(!ne(n))return!1;var s=typeof t;return(s=="number"?xe(n)&&ot(t,n.length):s=="string"&&t in n)?He(n[t],e):!1}function rs(e,t){if(U(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Pe(e)?!0:yl.test(e)||!vl.test(e)||t!=null&&e in Z(t)}function Tc(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function ss(e){var t=wi(e),n=l[t];if(typeof n!="function"||!(t in V.prototype))return!1;if(e===n)return!0;var s=ts(n);return!!s&&e===s[0]}function Ec(e){return!!Ro&&Ro in e}var Ac=Qn?at:ws;function Fn(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||$t;return e===n}function Ra(e){return e===e&&!ne(e)}function Da(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==r||e in Z(n))}}function Pc(e){var t=Fi(e,function(s){return n.size===x&&n.clear(),s}),n=t.cache;return t}function Fc(e,t){var n=e[1],s=t[1],a=n|s,h=a<(K|J|je),c=s==je&&n==ee||s==je&&n==un&&e[7].length<=t[8]||s==(je|un)&&t[7].length<=t[8]&&n==ee;if(!(h||c))return e;s&K&&(e[2]=t[2],a|=n&K?0:ae);var g=t[3];if(g){var v=e[3];e[3]=v?ga(v,g,t[4]):g,e[4]=v?pt(e[3],S):t[4]}return g=t[5],g&&(v=e[5],e[5]=v?_a(v,g,t[6]):g,e[6]=v?pt(e[5],S):t[6]),g=t[7],g&&(e[7]=g),s&je&&(e[8]=e[8]==null?t[8]:ge(e[8],t[8])),e[9]==null&&(e[9]=t[9]),e[0]=t[0],e[1]=a,e}function Ic(e){var t=[];if(e!=null)for(var n in Z(e))t.push(n);return t}function Lc(e){return ei.call(e)}function Ma(e,t,n){return t=le(t===r?e.length-1:t,0),function(){for(var s=arguments,a=-1,h=le(s.length-t,0),c=y(h);++a<h;)c[a]=s[t+a];a=-1;for(var g=y(t+1);++a<t;)g[a]=s[a];return g[t]=n(c),Te(e,this,g)}}function Oa(e,t){return t.length<2?e:Rt(e,be(t,0,-1))}function Rc(e,t){for(var n=e.length,s=ge(t.length,n),a=Ce(e);s--;){var h=t[s];e[s]=ot(h,n)?a[h]:r}return e}function os(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Ga=Ba(ra),In=Vh||function(e,t){return ce.setTimeout(e,t)},as=Ba(ec);function ba(e,t,n){var s=t+"";return as(e,wc(s,Dc(yc(s),n)))}function Ba(e){var t=0,n=0;return function(){var s=zh(),a=Qu-(s-n);if(n=s,a>0){if(++t>=Ju)return arguments[0]}else t=0;return e.apply(r,arguments)}}function Ti(e,t){var n=-1,s=e.length,a=s-1;for(t=t===r?s:t;++n<t;){var h=qr(n,a),c=e[h];e[h]=e[n],e[n]=c}return e.length=t,e}var Ua=Pc(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Cl,function(n,s,a,h){t.push(a?h.replace(Fl,"$1"):s||n)}),t});function Je(e){if(typeof e=="string"||Pe(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}function Mt(e){if(e!=null){try{return jn.call(e)}catch{}try{return e+""}catch{}}return""}function Dc(e,t){return De(rl,function(n){var s="_."+n[0];t&n[1]&&!Xn(e,s)&&e.push(s)}),e.sort()}function ka(e){if(e instanceof V)return e.clone();var t=new Oe(e.__wrapped__,e.__chain__);return t.__actions__=Ce(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}function Mc(e,t,n){(n?ve(e,t,n):t===r)?t=1:t=le(N(t),0);var s=e==null?0:e.length;if(!s||t<1)return[];for(var a=0,h=0,c=y(oi(s/t));a<s;)c[h++]=be(e,a,a+=t);return c}function Oc(e){for(var t=-1,n=e==null?0:e.length,s=0,a=[];++t<n;){var h=e[t];h&&(a[s++]=h)}return a}function Gc(){var e=arguments.length;if(!e)return[];for(var t=y(e-1),n=arguments[0],s=e;s--;)t[s-1]=arguments[s];return _t(U(n)?Ce(n):[n],de(t,1))}var bc=q(function(e,t){return re(e)?Sn(e,de(t,1,re,!0)):[]}),Bc=q(function(e,t){var n=Be(t);return re(n)&&(n=r),re(e)?Sn(e,de(t,1,re,!0),O(n,2)):[]}),Uc=q(function(e,t){var n=Be(t);return re(n)&&(n=r),re(e)?Sn(e,de(t,1,re,!0),r,n):[]});function kc(e,t,n){var s=e==null?0:e.length;return s?(t=n||t===r?1:N(t),be(e,t<0?0:t,s)):[]}function Nc(e,t,n){var s=e==null?0:e.length;return s?(t=n||t===r?1:N(t),t=s-t,be(e,0,t<0?0:t)):[]}function Wc(e,t){return e&&e.length?pi(e,O(t,3),!0,!0):[]}function Kc(e,t){return e&&e.length?pi(e,O(t,3),!0):[]}function qc(e,t,n,s){var a=e==null?0:e.length;return a?(n&&typeof n!="number"&&ve(e,t,n)&&(n=0,s=a),Gf(e,t,n,s)):[]}function Na(e,t,n){var s=e==null?0:e.length;if(!s)return-1;var a=n==null?0:N(n);return a<0&&(a=le(s+a,0)),zn(e,O(t,3),a)}function Wa(e,t,n){var s=e==null?0:e.length;if(!s)return-1;var a=s-1;return n!==r&&(a=N(n),a=n<0?le(s+a,0):ge(a,s-1)),zn(e,O(t,3),a,!0)}function Ka(e){var t=e==null?0:e.length;return t?de(e,1):[]}function Hc(e){var t=e==null?0:e.length;return t?de(e,kn):[]}function Vc(e,t){var n=e==null?0:e.length;return n?(t=t===r?1:N(t),de(e,t)):[]}function $c(e){for(var t=-1,n=e==null?0:e.length,s={};++t<n;){var a=e[t];s[a[0]]=a[1]}return s}function qa(e){return e&&e.length?e[0]:r}function Yc(e,t,n){var s=e==null?0:e.length;if(!s)return-1;var a=n==null?0:N(n);return a<0&&(a=le(s+a,0)),Kt(e,t,a)}function Xc(e){var t=e==null?0:e.length;return t?be(e,0,-1):[]}var zc=q(function(e){var t=te(e,Xr);return t.length&&t[0]===e[0]?Ur(t):[]}),Zc=q(function(e){var t=Be(e),n=te(e,Xr);return t===Be(n)?t=r:n.pop(),n.length&&n[0]===e[0]?Ur(n,O(t,2)):[]}),Jc=q(function(e){var t=Be(e),n=te(e,Xr);return t=typeof t=="function"?t:r,t&&n.pop(),n.length&&n[0]===e[0]?Ur(n,r,t):[]});function Qc(e,t){return e==null?"":Yh.call(e,t)}function Be(e){var t=e==null?0:e.length;return t?e[t-1]:r}function jc(e,t,n){var s=e==null?0:e.length;if(!s)return-1;var a=s;return n!==r&&(a=N(n),a=a<0?le(s+a,0):ge(a,s-1)),t===t?Rh(e,t,a):zn(e,So,a,!0)}function ed(e,t){return e&&e.length?ea(e,N(t)):r}var td=q(Ha);function Ha(e,t){return e&&e.length&&t&&t.length?Kr(e,t):e}function nd(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,O(n,2)):e}function id(e,t,n){return e&&e.length&&t&&t.length?Kr(e,t,r,n):e}var rd=st(function(e,t){var n=e==null?0:e.length,s=Or(e,t);return ia(e,te(t,function(a){return ot(a,n)?+a:a}).sort(da)),s});function sd(e,t){var n=[];if(!(e&&e.length))return n;var s=-1,a=[],h=e.length;for(t=O(t,3);++s<h;){var c=e[s];t(c,s,e)&&(n.push(c),a.push(s))}return ia(e,a),n}function us(e){return e==null?e:Jh.call(e)}function od(e,t,n){var s=e==null?0:e.length;return s?(n&&typeof n!="number"&&ve(e,t,n)?(t=0,n=s):(t=t==null?0:N(t),n=n===r?s:N(n)),be(e,t,n)):[]}function ad(e,t){return _i(e,t)}function ud(e,t,n){return Vr(e,t,O(n,2))}function ld(e,t){var n=e==null?0:e.length;if(n){var s=_i(e,t);if(s<n&&He(e[s],t))return s}return-1}function hd(e,t){return _i(e,t,!0)}function fd(e,t,n){return Vr(e,t,O(n,2),!0)}function cd(e,t){var n=e==null?0:e.length;if(n){var s=_i(e,t,!0)-1;if(He(e[s],t))return s}return-1}function dd(e){return e&&e.length?sa(e):[]}function gd(e,t){return e&&e.length?sa(e,O(t,2)):[]}function _d(e){var t=e==null?0:e.length;return t?be(e,1,t):[]}function pd(e,t,n){return e&&e.length?(t=n||t===r?1:N(t),be(e,0,t<0?0:t)):[]}function md(e,t,n){var s=e==null?0:e.length;return s?(t=n||t===r?1:N(t),t=s-t,be(e,t<0?0:t,s)):[]}function vd(e,t){return e&&e.length?pi(e,O(t,3),!1,!0):[]}function yd(e,t){return e&&e.length?pi(e,O(t,3)):[]}var Cd=q(function(e){return yt(de(e,1,re,!0))}),xd=q(function(e){var t=Be(e);return re(t)&&(t=r),yt(de(e,1,re,!0),O(t,2))}),wd=q(function(e){var t=Be(e);return t=typeof t=="function"?t:r,yt(de(e,1,re,!0),r,t)});function Sd(e){return e&&e.length?yt(e):[]}function Td(e,t){return e&&e.length?yt(e,O(t,2)):[]}function Ed(e,t){return t=typeof t=="function"?t:r,e&&e.length?yt(e,r,t):[]}function ls(e){if(!(e&&e.length))return[];var t=0;return e=gt(e,function(n){if(re(n))return t=le(n.length,t),!0}),Ar(t,function(n){return te(e,Sr(n))})}function Va(e,t){if(!(e&&e.length))return[];var n=ls(e);return t==null?n:te(n,function(s){return Te(t,r,s)})}var Ad=q(function(e,t){return re(e)?Sn(e,t):[]}),Pd=q(function(e){return Yr(gt(e,re))}),Fd=q(function(e){var t=Be(e);return re(t)&&(t=r),Yr(gt(e,re),O(t,2))}),Id=q(function(e){var t=Be(e);return t=typeof t=="function"?t:r,Yr(gt(e,re),r,t)}),Ld=q(ls);function Rd(e,t){return la(e||[],t||[],wn)}function Dd(e,t){return la(e||[],t||[],An)}var Md=q(function(e){var t=e.length,n=t>1?e[t-1]:r;return n=typeof n=="function"?(e.pop(),n):r,Va(e,n)});function $a(e){var t=l(e);return t.__chain__=!0,t}function Od(e,t){return t(e),e}function Ei(e,t){return t(e)}var Gd=st(function(e){var t=e.length,n=t?e[0]:0,s=this.__wrapped__,a=function(h){return Or(h,e)};return t>1||this.__actions__.length||!(s instanceof V)||!ot(n)?this.thru(a):(s=s.slice(n,+n+(t?1:0)),s.__actions__.push({func:Ei,args:[a],thisArg:r}),new Oe(s,this.__chain__).thru(function(h){return t&&!h.length&&h.push(r),h}))});function bd(){return $a(this)}function Bd(){return new Oe(this.value(),this.__chain__)}function Ud(){this.__values__===r&&(this.__values__=ou(this.value()));var e=this.__index__>=this.__values__.length,t=e?r:this.__values__[this.__index__++];return{done:e,value:t}}function kd(){return this}function Nd(e){for(var t,n=this;n instanceof hi;){var s=ka(n);s.__index__=0,s.__values__=r,t?a.__wrapped__=s:t=s;var a=s;n=n.__wrapped__}return a.__wrapped__=e,t}function Wd(){var e=this.__wrapped__;if(e instanceof V){var t=e;return this.__actions__.length&&(t=new V(this)),t=t.reverse(),t.__actions__.push({func:Ei,args:[us],thisArg:r}),new Oe(t,this.__chain__)}return this.thru(us)}function Kd(){return ua(this.__wrapped__,this.__actions__)}var qd=mi(function(e,t,n){z.call(e,n)?++e[n]:it(e,n,1)});function Hd(e,t,n){var s=U(e)?xo:Of;return n&&ve(e,t,n)&&(t=r),s(e,O(t,3))}function Vd(e,t){var n=U(e)?gt:Vo;return n(e,O(t,3))}var $d=ya(Na),Yd=ya(Wa);function Xd(e,t){return de(Ai(e,t),1)}function zd(e,t){return de(Ai(e,t),kn)}function Zd(e,t,n){return n=n===r?1:N(n),de(Ai(e,t),n)}function Ya(e,t){var n=U(e)?De:vt;return n(e,O(t,3))}function Xa(e,t){var n=U(e)?gh:Ho;return n(e,O(t,3))}var Jd=mi(function(e,t,n){z.call(e,n)?e[n].push(t):it(e,n,[t])});function Qd(e,t,n,s){e=xe(e)?e:en(e),n=n&&!s?N(n):0;var a=e.length;return n<0&&(n=le(a+n,0)),Ri(e)?n<=a&&e.indexOf(t,n)>-1:!!a&&Kt(e,t,n)>-1}var jd=q(function(e,t,n){var s=-1,a=typeof t=="function",h=xe(e)?y(e.length):[];return vt(e,function(c){h[++s]=a?Te(t,c,n):Tn(c,t,n)}),h}),eg=mi(function(e,t,n){it(e,n,t)});function Ai(e,t){var n=U(e)?te:Jo;return n(e,O(t,3))}function tg(e,t,n,s){return e==null?[]:(U(t)||(t=t==null?[]:[t]),n=s?r:n,U(n)||(n=n==null?[]:[n]),ta(e,t,n))}var ng=mi(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});function ig(e,t,n){var s=U(e)?xr:Eo,a=arguments.length<3;return s(e,O(t,4),n,a,vt)}function rg(e,t,n){var s=U(e)?_h:Eo,a=arguments.length<3;return s(e,O(t,4),n,a,Ho)}function sg(e,t){var n=U(e)?gt:Vo;return n(e,Ii(O(t,3)))}function og(e){var t=U(e)?No:Qf;return t(e)}function ag(e,t,n){(n?ve(e,t,n):t===r)?t=1:t=N(t);var s=U(e)?If:jf;return s(e,t)}function ug(e){var t=U(e)?Lf:tc;return t(e)}function lg(e){if(e==null)return 0;if(xe(e))return Ri(e)?Ht(e):e.length;var t=_e(e);return t==Ne||t==We?e.size:Nr(e).length}function hg(e,t,n){var s=U(e)?wr:nc;return n&&ve(e,t,n)&&(t=r),s(e,O(t,3))}var fg=q(function(e,t){if(e==null)return[];var n=t.length;return n>1&&ve(e,t[0],t[1])?t=[]:n>2&&ve(t[0],t[1],t[2])&&(t=[t[0]]),ta(e,de(t,1),[])}),Pi=Hh||function(){return ce.Date.now()};function cg(e,t){if(typeof t!="function")throw new Me(d);return e=N(e),function(){if(--e<1)return t.apply(this,arguments)}}function za(e,t,n){return t=n?r:t,t=e&&t==null?e.length:t,rt(e,je,r,r,r,r,t)}function Za(e,t){var n;if(typeof t!="function")throw new Me(d);return e=N(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=r),n}}var hs=q(function(e,t,n){var s=K;if(n.length){var a=pt(n,Qt(hs));s|=Le}return rt(e,s,t,n,a)}),Ja=q(function(e,t,n){var s=K|J;if(n.length){var a=pt(n,Qt(Ja));s|=Le}return rt(t,s,e,n,a)});function Qa(e,t,n){t=n?r:t;var s=rt(e,ee,r,r,r,r,r,t);return s.placeholder=Qa.placeholder,s}function ja(e,t,n){t=n?r:t;var s=rt(e,fe,r,r,r,r,r,t);return s.placeholder=ja.placeholder,s}function eu(e,t,n){var s,a,h,c,g,v,T=0,E=!1,A=!1,L=!0;if(typeof e!="function")throw new Me(d);t=Ue(t)||0,ne(n)&&(E=!!n.leading,A="maxWait"in n,h=A?le(Ue(n.maxWait)||0,t):h,L="trailing"in n?!!n.trailing:L);function D(se){var Ve=s,lt=a;return s=a=r,T=se,c=e.apply(lt,Ve),c}function G(se){return T=se,g=In(H,t),E?D(se):c}function W(se){var Ve=se-v,lt=se-T,yu=t-Ve;return A?ge(yu,h-lt):yu}function b(se){var Ve=se-v,lt=se-T;return v===r||Ve>=t||Ve<0||A&&lt>=h}function H(){var se=Pi();if(b(se))return $(se);g=In(H,W(se))}function $(se){return g=r,L&&s?D(se):(s=a=r,c)}function Fe(){g!==r&&ha(g),T=0,s=v=a=g=r}function ye(){return g===r?c:$(Pi())}function Ie(){var se=Pi(),Ve=b(se);if(s=arguments,a=this,v=se,Ve){if(g===r)return G(v);if(A)return ha(g),g=In(H,t),D(v)}return g===r&&(g=In(H,t)),c}return Ie.cancel=Fe,Ie.flush=ye,Ie}var dg=q(function(e,t){return qo(e,1,t)}),gg=q(function(e,t,n){return qo(e,Ue(t)||0,n)});function _g(e){return rt(e,tr)}function Fi(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new Me(d);var n=function(){var s=arguments,a=t?t.apply(this,s):s[0],h=n.cache;if(h.has(a))return h.get(a);var c=e.apply(this,s);return n.cache=h.set(a,c)||h,c};return n.cache=new(Fi.Cache||nt),n}Fi.Cache=nt;function Ii(e){if(typeof e!="function")throw new Me(d);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}function pg(e){return Za(2,e)}var mg=ic(function(e,t){t=t.length==1&&U(t[0])?te(t[0],Ee(O())):te(de(t,1),Ee(O()));var n=t.length;return q(function(s){for(var a=-1,h=ge(s.length,n);++a<h;)s[a]=t[a].call(this,s[a]);return Te(e,this,s)})}),fs=q(function(e,t){var n=pt(t,Qt(fs));return rt(e,Le,r,t,n)}),tu=q(function(e,t){var n=pt(t,Qt(tu));return rt(e,an,r,t,n)}),vg=st(function(e,t){return rt(e,un,r,r,r,t)});function yg(e,t){if(typeof e!="function")throw new Me(d);return t=t===r?t:N(t),q(e,t)}function Cg(e,t){if(typeof e!="function")throw new Me(d);return t=t==null?0:le(N(t),0),q(function(n){var s=n[t],a=xt(n,0,t);return s&&_t(a,s),Te(e,this,a)})}function xg(e,t,n){var s=!0,a=!0;if(typeof e!="function")throw new Me(d);return ne(n)&&(s="leading"in n?!!n.leading:s,a="trailing"in n?!!n.trailing:a),eu(e,t,{leading:s,maxWait:t,trailing:a})}function wg(e){return za(e,1)}function Sg(e,t){return fs(zr(t),e)}function Tg(){if(!arguments.length)return[];var e=arguments[0];return U(e)?e:[e]}function Eg(e){return Ge(e,F)}function Ag(e,t){return t=typeof t=="function"?t:r,Ge(e,F,t)}function Pg(e){return Ge(e,I|F)}function Fg(e,t){return t=typeof t=="function"?t:r,Ge(e,I|F,t)}function Ig(e,t){return t==null||Ko(e,t,he(t))}function He(e,t){return e===t||e!==e&&t!==t}var Lg=xi(Br),Rg=xi(function(e,t){return e>=t}),Ot=Xo(function(){return arguments}())?Xo:function(e){return ie(e)&&z.call(e,"callee")&&!Oo.call(e,"callee")},U=y.isArray,Dg=_o?Ee(_o):Nf;function xe(e){return e!=null&&Li(e.length)&&!at(e)}function re(e){return ie(e)&&xe(e)}function Mg(e){return e===!0||e===!1||ie(e)&&me(e)==ln}var wt=$h||ws,Og=po?Ee(po):Wf;function Gg(e){return ie(e)&&e.nodeType===1&&!Ln(e)}function bg(e){if(e==null)return!0;if(xe(e)&&(U(e)||typeof e=="string"||typeof e.splice=="function"||wt(e)||jt(e)||Ot(e)))return!e.length;var t=_e(e);if(t==Ne||t==We)return!e.size;if(Fn(e))return!Nr(e).length;for(var n in e)if(z.call(e,n))return!1;return!0}function Bg(e,t){return En(e,t)}function Ug(e,t,n){n=typeof n=="function"?n:r;var s=n?n(e,t):r;return s===r?En(e,t,r,n):!!s}function cs(e){if(!ie(e))return!1;var t=me(e);return t==Kn||t==ol||typeof e.message=="string"&&typeof e.name=="string"&&!Ln(e)}function kg(e){return typeof e=="number"&&bo(e)}function at(e){if(!ne(e))return!1;var t=me(e);return t==qn||t==Ks||t==sl||t==ul}function nu(e){return typeof e=="number"&&e==N(e)}function Li(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ut}function ne(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}function ie(e){return e!=null&&typeof e=="object"}var iu=mo?Ee(mo):qf;function Ng(e,t){return e===t||kr(e,t,ns(t))}function Wg(e,t,n){return n=typeof n=="function"?n:r,kr(e,t,ns(t),n)}function Kg(e){return ru(e)&&e!=+e}function qg(e){if(Ac(e))throw new B(f);return zo(e)}function Hg(e){return e===null}function Vg(e){return e==null}function ru(e){return typeof e=="number"||ie(e)&&me(e)==fn}function Ln(e){if(!ie(e)||me(e)!=et)return!1;var t=ii(e);if(t===null)return!0;var n=z.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&jn.call(n)==Nh}var ds=vo?Ee(vo):Hf;function $g(e){return nu(e)&&e>=-9007199254740991&&e<=Ut}var su=yo?Ee(yo):Vf;function Ri(e){return typeof e=="string"||!U(e)&&ie(e)&&me(e)==dn}function Pe(e){return typeof e=="symbol"||ie(e)&&me(e)==Hn}var jt=Co?Ee(Co):$f;function Yg(e){return e===r}function Xg(e){return ie(e)&&_e(e)==gn}function zg(e){return ie(e)&&me(e)==hl}var Zg=xi(Wr),Jg=xi(function(e,t){return e<=t});function ou(e){if(!e)return[];if(xe(e))return Ri(e)?Ke(e):Ce(e);if(mn&&e[mn])return Fh(e[mn]());var t=_e(e),n=t==Ne?Fr:t==We?Zn:en;return n(e)}function ut(e){if(!e)return e===0?e:0;if(e=Ue(e),e===kn||e===-1/0){var t=e<0?-1:1;return t*tl}return e===e?e:0}function N(e){var t=ut(e),n=t%1;return t===t?n?t-n:t:0}function au(e){return e?Lt(N(e),0,Xe):0}function Ue(e){if(typeof e=="number")return e;if(Pe(e))return Nn;if(ne(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=ne(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=Ao(e);var n=Rl.test(e);return n||Ml.test(e)?fh(e.slice(2),n?2:8):Ll.test(e)?Nn:+e}function uu(e){return Ze(e,we(e))}function Qg(e){return e?Lt(N(e),-9007199254740991,Ut):e===0?e:0}function X(e){return e==null?"":Ae(e)}var jg=Zt(function(e,t){if(Fn(t)||xe(t)){Ze(t,he(t),e);return}for(var n in t)z.call(t,n)&&wn(e,n,t[n])}),lu=Zt(function(e,t){Ze(t,we(t),e)}),Di=Zt(function(e,t,n,s){Ze(t,we(t),e,s)}),e_=Zt(function(e,t,n,s){Ze(t,he(t),e,s)}),t_=st(Or);function n_(e,t){var n=zt(e);return t==null?n:Wo(n,t)}var i_=q(function(e,t){e=Z(e);var n=-1,s=t.length,a=s>2?t[2]:r;for(a&&ve(t[0],t[1],a)&&(s=1);++n<s;)for(var h=t[n],c=we(h),g=-1,v=c.length;++g<v;){var T=c[g],E=e[T];(E===r||He(E,$t[T])&&!z.call(e,T))&&(e[T]=h[T])}return e}),r_=q(function(e){return e.push(r,Aa),Te(hu,r,e)});function s_(e,t){return wo(e,O(t,3),ze)}function o_(e,t){return wo(e,O(t,3),br)}function a_(e,t){return e==null?e:Gr(e,O(t,3),we)}function u_(e,t){return e==null?e:$o(e,O(t,3),we)}function l_(e,t){return e&&ze(e,O(t,3))}function h_(e,t){return e&&br(e,O(t,3))}function f_(e){return e==null?[]:di(e,he(e))}function c_(e){return e==null?[]:di(e,we(e))}function gs(e,t,n){var s=e==null?r:Rt(e,t);return s===r?n:s}function d_(e,t){return e!=null&&Ia(e,t,bf)}function _s(e,t){return e!=null&&Ia(e,t,Bf)}var g_=xa(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=ei.call(t)),e[t]=n},ms(Se)),__=xa(function(e,t,n){t!=null&&typeof t.toString!="function"&&(t=ei.call(t)),z.call(e,t)?e[t].push(n):e[t]=[n]},O),p_=q(Tn);function he(e){return xe(e)?ko(e):Nr(e)}function we(e){return xe(e)?ko(e,!0):Yf(e)}function m_(e,t){var n={};return t=O(t,3),ze(e,function(s,a,h){it(n,t(s,a,h),s)}),n}function v_(e,t){var n={};return t=O(t,3),ze(e,function(s,a,h){it(n,a,t(s,a,h))}),n}var y_=Zt(function(e,t,n){gi(e,t,n)}),hu=Zt(function(e,t,n,s){gi(e,t,n,s)}),C_=st(function(e,t){var n={};if(e==null)return n;var s=!1;t=te(t,function(h){return h=Ct(h,e),s||(s=h.length>1),h}),Ze(e,es(e),n),s&&(n=Ge(n,I|P|F,gc));for(var a=t.length;a--;)$r(n,t[a]);return n});function x_(e,t){return fu(e,Ii(O(t)))}var w_=st(function(e,t){return e==null?{}:zf(e,t)});function fu(e,t){if(e==null)return{};var n=te(es(e),function(s){return[s]});return t=O(t),na(e,n,function(s,a){return t(s,a[0])})}function S_(e,t,n){t=Ct(t,e);var s=-1,a=t.length;for(a||(a=1,e=r);++s<a;){var h=e==null?r:e[Je(t[s])];h===r&&(s=a,h=n),e=at(h)?h.call(e):h}return e}function T_(e,t,n){return e==null?e:An(e,t,n)}function E_(e,t,n,s){return s=typeof s=="function"?s:r,e==null?e:An(e,t,n,s)}var cu=Ta(he),du=Ta(we);function A_(e,t,n){var s=U(e),a=s||wt(e)||jt(e);if(t=O(t,4),n==null){var h=e&&e.constructor;a?n=s?new h:[]:ne(e)?n=at(h)?zt(ii(e)):{}:n={}}return(a?De:ze)(e,function(c,g,v){return t(n,c,g,v)}),n}function P_(e,t){return e==null?!0:$r(e,t)}function F_(e,t,n){return e==null?e:aa(e,t,zr(n))}function I_(e,t,n,s){return s=typeof s=="function"?s:r,e==null?e:aa(e,t,zr(n),s)}function en(e){return e==null?[]:Pr(e,he(e))}function L_(e){return e==null?[]:Pr(e,we(e))}function R_(e,t,n){return n===r&&(n=t,t=r),n!==r&&(n=Ue(n),n=n===n?n:0),t!==r&&(t=Ue(t),t=t===t?t:0),Lt(Ue(e),t,n)}function D_(e,t,n){return t=ut(t),n===r?(n=t,t=0):n=ut(n),e=Ue(e),Uf(e,t,n)}function M_(e,t,n){if(n&&typeof n!="boolean"&&ve(e,t,n)&&(t=n=r),n===r&&(typeof t=="boolean"?(n=t,t=r):typeof e=="boolean"&&(n=e,e=r)),e===r&&t===r?(e=0,t=1):(e=ut(e),t===r?(t=e,e=0):t=ut(t)),e>t){var s=e;e=t,t=s}if(n||e%1||t%1){var a=Bo();return ge(e+a*(t-e+hh("1e-"+((a+"").length-1))),t)}return qr(e,t)}var O_=Jt(function(e,t,n){return t=t.toLowerCase(),e+(n?gu(t):t)});function gu(e){return ps(X(e).toLowerCase())}function _u(e){return e=X(e),e&&e.replace(Gl,Sh).replace(eh,"")}function G_(e,t,n){e=X(e),t=Ae(t);var s=e.length;n=n===r?s:Lt(N(n),0,s);var a=n;return n-=t.length,n>=0&&e.slice(n,a)==t}function b_(e){return e=X(e),e&&_l.test(e)?e.replace(Vs,Th):e}function B_(e){return e=X(e),e&&xl.test(e)?e.replace(fr,"\\$&"):e}var U_=Jt(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),k_=Jt(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),N_=va("toLowerCase");function W_(e,t,n){e=X(e),t=N(t);var s=t?Ht(e):0;if(!t||s>=t)return e;var a=(t-s)/2;return Ci(ai(a),n)+e+Ci(oi(a),n)}function K_(e,t,n){e=X(e),t=N(t);var s=t?Ht(e):0;return t&&s<t?e+Ci(t-s,n):e}function q_(e,t,n){e=X(e),t=N(t);var s=t?Ht(e):0;return t&&s<t?Ci(t-s,n)+e:e}function H_(e,t,n){return n||t==null?t=0:t&&(t=+t),Zh(X(e).replace(cr,""),t||0)}function V_(e,t,n){return(n?ve(e,t,n):t===r)?t=1:t=N(t),Hr(X(e),t)}function $_(){var e=arguments,t=X(e[0]);return e.length<3?t:t.replace(e[1],e[2])}var Y_=Jt(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});function X_(e,t,n){return n&&typeof n!="number"&&ve(e,t,n)&&(t=n=r),n=n===r?Xe:n>>>0,n?(e=X(e),e&&(typeof t=="string"||t!=null&&!ds(t))&&(t=Ae(t),!t&&qt(e))?xt(Ke(e),0,n):e.split(t,n)):[]}var z_=Jt(function(e,t,n){return e+(n?" ":"")+ps(t)});function Z_(e,t,n){return e=X(e),n=n==null?0:Lt(N(n),0,e.length),t=Ae(t),e.slice(n,n+t.length)==t}function J_(e,t,n){var s=l.templateSettings;n&&ve(e,t,n)&&(t=r),e=X(e),t=Di({},t,s,Ea);var a=Di({},t.imports,s.imports,Ea),h=he(a),c=Pr(a,h),g,v,T=0,E=t.interpolate||Vn,A="__p += '",L=Ir((t.escape||Vn).source+"|"+E.source+"|"+(E===$s?Il:Vn).source+"|"+(t.evaluate||Vn).source+"|$","g"),D="//# sourceURL="+(z.call(t,"sourceURL")?(t.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++sh+"]")+`
`;e.replace(L,function(b,H,$,Fe,ye,Ie){return $||($=Fe),A+=e.slice(T,Ie).replace(bl,Eh),H&&(g=!0,A+=`' +
__e(`+H+`) +
'`),ye&&(v=!0,A+=`';
`+ye+`;
__p += '`),$&&(A+=`' +
((__t = (`+$+`)) == null ? '' : __t) +
'`),T=Ie+b.length,b}),A+=`';
`;var G=z.call(t,"variable")&&t.variable;if(!G)A=`with (obj) {
`+A+`
}
`;else if(Pl.test(G))throw new B(_);A=(v?A.replace(fl,""):A).replace(cl,"$1").replace(dl,"$1;"),A="function("+(G||"obj")+`) {
`+(G?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(g?", __e = _.escape":"")+(v?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+A+`return __p
}`;var W=mu(function(){return Y(h,D+"return "+A).apply(r,c)});if(W.source=A,cs(W))throw W;return W}function Q_(e){return X(e).toLowerCase()}function j_(e){return X(e).toUpperCase()}function ep(e,t,n){if(e=X(e),e&&(n||t===r))return Ao(e);if(!e||!(t=Ae(t)))return e;var s=Ke(e),a=Ke(t),h=Po(s,a),c=Fo(s,a)+1;return xt(s,h,c).join("")}function tp(e,t,n){if(e=X(e),e&&(n||t===r))return e.slice(0,Lo(e)+1);if(!e||!(t=Ae(t)))return e;var s=Ke(e),a=Fo(s,Ke(t))+1;return xt(s,0,a).join("")}function np(e,t,n){if(e=X(e),e&&(n||t===r))return e.replace(cr,"");if(!e||!(t=Ae(t)))return e;var s=Ke(e),a=Po(s,Ke(t));return xt(s,a).join("")}function ip(e,t){var n=zu,s=Zu;if(ne(t)){var a="separator"in t?t.separator:a;n="length"in t?N(t.length):n,s="omission"in t?Ae(t.omission):s}e=X(e);var h=e.length;if(qt(e)){var c=Ke(e);h=c.length}if(n>=h)return e;var g=n-Ht(s);if(g<1)return s;var v=c?xt(c,0,g).join(""):e.slice(0,g);if(a===r)return v+s;if(c&&(g+=v.length-g),ds(a)){if(e.slice(g).search(a)){var T,E=v;for(a.global||(a=Ir(a.source,X(Ys.exec(a))+"g")),a.lastIndex=0;T=a.exec(E);)var A=T.index;v=v.slice(0,A===r?g:A)}}else if(e.indexOf(Ae(a),g)!=g){var L=v.lastIndexOf(a);L>-1&&(v=v.slice(0,L))}return v+s}function rp(e){return e=X(e),e&&gl.test(e)?e.replace(Hs,Dh):e}var sp=Jt(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),ps=va("toUpperCase");function pu(e,t,n){return e=X(e),t=n?r:t,t===r?Ph(e)?Gh(e):vh(e):e.match(t)||[]}var mu=q(function(e,t){try{return Te(e,r,t)}catch(n){return cs(n)?n:new B(n)}}),op=st(function(e,t){return De(t,function(n){n=Je(n),it(e,n,hs(e[n],e))}),e});function ap(e){var t=e==null?0:e.length,n=O();return e=t?te(e,function(s){if(typeof s[1]!="function")throw new Me(d);return[n(s[0]),s[1]]}):[],q(function(s){for(var a=-1;++a<t;){var h=e[a];if(Te(h[0],this,s))return Te(h[1],this,s)}})}function up(e){return Mf(Ge(e,I))}function ms(e){return function(){return e}}function lp(e,t){return e==null||e!==e?t:e}var hp=Ca(),fp=Ca(!0);function Se(e){return e}function vs(e){return Zo(typeof e=="function"?e:Ge(e,I))}function cp(e){return Qo(Ge(e,I))}function dp(e,t){return jo(e,Ge(t,I))}var gp=q(function(e,t){return function(n){return Tn(n,e,t)}}),_p=q(function(e,t){return function(n){return Tn(e,n,t)}});function ys(e,t,n){var s=he(t),a=di(t,s);n==null&&!(ne(t)&&(a.length||!s.length))&&(n=t,t=e,e=this,a=di(t,he(t)));var h=!(ne(n)&&"chain"in n)||!!n.chain,c=at(e);return De(a,function(g){var v=t[g];e[g]=v,c&&(e.prototype[g]=function(){var T=this.__chain__;if(h||T){var E=e(this.__wrapped__),A=E.__actions__=Ce(this.__actions__);return A.push({func:v,args:arguments,thisArg:e}),E.__chain__=T,E}return v.apply(e,_t([this.value()],arguments))})}),e}function pp(){return ce._===this&&(ce._=Wh),this}function Cs(){}function mp(e){return e=N(e),q(function(t){return ea(t,e)})}var vp=Jr(te),yp=Jr(xo),Cp=Jr(wr);function vu(e){return rs(e)?Sr(Je(e)):Zf(e)}function xp(e){return function(t){return e==null?r:Rt(e,t)}}var wp=wa(),Sp=wa(!0);function xs(){return[]}function ws(){return!1}function Tp(){return{}}function Ep(){return""}function Ap(){return!0}function Pp(e,t){if(e=N(e),e<1||e>Ut)return[];var n=Xe,s=ge(e,Xe);t=O(t),e-=Xe;for(var a=Ar(s,t);++n<e;)t(n);return a}function Fp(e){return U(e)?te(e,Je):Pe(e)?[e]:Ce(Ua(X(e)))}function Ip(e){var t=++kh;return X(e)+t}var Lp=yi(function(e,t){return e+t},0),Rp=Qr("ceil"),Dp=yi(function(e,t){return e/t},1),Mp=Qr("floor");function Op(e){return e&&e.length?ci(e,Se,Br):r}function Gp(e,t){return e&&e.length?ci(e,O(t,2),Br):r}function bp(e){return To(e,Se)}function Bp(e,t){return To(e,O(t,2))}function Up(e){return e&&e.length?ci(e,Se,Wr):r}function kp(e,t){return e&&e.length?ci(e,O(t,2),Wr):r}var Np=yi(function(e,t){return e*t},1),Wp=Qr("round"),Kp=yi(function(e,t){return e-t},0);function qp(e){return e&&e.length?Er(e,Se):0}function Hp(e,t){return e&&e.length?Er(e,O(t,2)):0}return l.after=cg,l.ary=za,l.assign=jg,l.assignIn=lu,l.assignInWith=Di,l.assignWith=e_,l.at=t_,l.before=Za,l.bind=hs,l.bindAll=op,l.bindKey=Ja,l.castArray=Tg,l.chain=$a,l.chunk=Mc,l.compact=Oc,l.concat=Gc,l.cond=ap,l.conforms=up,l.constant=ms,l.countBy=qd,l.create=n_,l.curry=Qa,l.curryRight=ja,l.debounce=eu,l.defaults=i_,l.defaultsDeep=r_,l.defer=dg,l.delay=gg,l.difference=bc,l.differenceBy=Bc,l.differenceWith=Uc,l.drop=kc,l.dropRight=Nc,l.dropRightWhile=Wc,l.dropWhile=Kc,l.fill=qc,l.filter=Vd,l.flatMap=Xd,l.flatMapDeep=zd,l.flatMapDepth=Zd,l.flatten=Ka,l.flattenDeep=Hc,l.flattenDepth=Vc,l.flip=_g,l.flow=hp,l.flowRight=fp,l.fromPairs=$c,l.functions=f_,l.functionsIn=c_,l.groupBy=Jd,l.initial=Xc,l.intersection=zc,l.intersectionBy=Zc,l.intersectionWith=Jc,l.invert=g_,l.invertBy=__,l.invokeMap=jd,l.iteratee=vs,l.keyBy=eg,l.keys=he,l.keysIn=we,l.map=Ai,l.mapKeys=m_,l.mapValues=v_,l.matches=cp,l.matchesProperty=dp,l.memoize=Fi,l.merge=y_,l.mergeWith=hu,l.method=gp,l.methodOf=_p,l.mixin=ys,l.negate=Ii,l.nthArg=mp,l.omit=C_,l.omitBy=x_,l.once=pg,l.orderBy=tg,l.over=vp,l.overArgs=mg,l.overEvery=yp,l.overSome=Cp,l.partial=fs,l.partialRight=tu,l.partition=ng,l.pick=w_,l.pickBy=fu,l.property=vu,l.propertyOf=xp,l.pull=td,l.pullAll=Ha,l.pullAllBy=nd,l.pullAllWith=id,l.pullAt=rd,l.range=wp,l.rangeRight=Sp,l.rearg=vg,l.reject=sg,l.remove=sd,l.rest=yg,l.reverse=us,l.sampleSize=ag,l.set=T_,l.setWith=E_,l.shuffle=ug,l.slice=od,l.sortBy=fg,l.sortedUniq=dd,l.sortedUniqBy=gd,l.split=X_,l.spread=Cg,l.tail=_d,l.take=pd,l.takeRight=md,l.takeRightWhile=vd,l.takeWhile=yd,l.tap=Od,l.throttle=xg,l.thru=Ei,l.toArray=ou,l.toPairs=cu,l.toPairsIn=du,l.toPath=Fp,l.toPlainObject=uu,l.transform=A_,l.unary=wg,l.union=Cd,l.unionBy=xd,l.unionWith=wd,l.uniq=Sd,l.uniqBy=Td,l.uniqWith=Ed,l.unset=P_,l.unzip=ls,l.unzipWith=Va,l.update=F_,l.updateWith=I_,l.values=en,l.valuesIn=L_,l.without=Ad,l.words=pu,l.wrap=Sg,l.xor=Pd,l.xorBy=Fd,l.xorWith=Id,l.zip=Ld,l.zipObject=Rd,l.zipObjectDeep=Dd,l.zipWith=Md,l.entries=cu,l.entriesIn=du,l.extend=lu,l.extendWith=Di,ys(l,l),l.add=Lp,l.attempt=mu,l.camelCase=O_,l.capitalize=gu,l.ceil=Rp,l.clamp=R_,l.clone=Eg,l.cloneDeep=Pg,l.cloneDeepWith=Fg,l.cloneWith=Ag,l.conformsTo=Ig,l.deburr=_u,l.defaultTo=lp,l.divide=Dp,l.endsWith=G_,l.eq=He,l.escape=b_,l.escapeRegExp=B_,l.every=Hd,l.find=$d,l.findIndex=Na,l.findKey=s_,l.findLast=Yd,l.findLastIndex=Wa,l.findLastKey=o_,l.floor=Mp,l.forEach=Ya,l.forEachRight=Xa,l.forIn=a_,l.forInRight=u_,l.forOwn=l_,l.forOwnRight=h_,l.get=gs,l.gt=Lg,l.gte=Rg,l.has=d_,l.hasIn=_s,l.head=qa,l.identity=Se,l.includes=Qd,l.indexOf=Yc,l.inRange=D_,l.invoke=p_,l.isArguments=Ot,l.isArray=U,l.isArrayBuffer=Dg,l.isArrayLike=xe,l.isArrayLikeObject=re,l.isBoolean=Mg,l.isBuffer=wt,l.isDate=Og,l.isElement=Gg,l.isEmpty=bg,l.isEqual=Bg,l.isEqualWith=Ug,l.isError=cs,l.isFinite=kg,l.isFunction=at,l.isInteger=nu,l.isLength=Li,l.isMap=iu,l.isMatch=Ng,l.isMatchWith=Wg,l.isNaN=Kg,l.isNative=qg,l.isNil=Vg,l.isNull=Hg,l.isNumber=ru,l.isObject=ne,l.isObjectLike=ie,l.isPlainObject=Ln,l.isRegExp=ds,l.isSafeInteger=$g,l.isSet=su,l.isString=Ri,l.isSymbol=Pe,l.isTypedArray=jt,l.isUndefined=Yg,l.isWeakMap=Xg,l.isWeakSet=zg,l.join=Qc,l.kebabCase=U_,l.last=Be,l.lastIndexOf=jc,l.lowerCase=k_,l.lowerFirst=N_,l.lt=Zg,l.lte=Jg,l.max=Op,l.maxBy=Gp,l.mean=bp,l.meanBy=Bp,l.min=Up,l.minBy=kp,l.stubArray=xs,l.stubFalse=ws,l.stubObject=Tp,l.stubString=Ep,l.stubTrue=Ap,l.multiply=Np,l.nth=ed,l.noConflict=pp,l.noop=Cs,l.now=Pi,l.pad=W_,l.padEnd=K_,l.padStart=q_,l.parseInt=H_,l.random=M_,l.reduce=ig,l.reduceRight=rg,l.repeat=V_,l.replace=$_,l.result=S_,l.round=Wp,l.runInContext=p,l.sample=og,l.size=lg,l.snakeCase=Y_,l.some=hg,l.sortedIndex=ad,l.sortedIndexBy=ud,l.sortedIndexOf=ld,l.sortedLastIndex=hd,l.sortedLastIndexBy=fd,l.sortedLastIndexOf=cd,l.startCase=z_,l.startsWith=Z_,l.subtract=Kp,l.sum=qp,l.sumBy=Hp,l.template=J_,l.times=Pp,l.toFinite=ut,l.toInteger=N,l.toLength=au,l.toLower=Q_,l.toNumber=Ue,l.toSafeInteger=Qg,l.toString=X,l.toUpper=j_,l.trim=ep,l.trimEnd=tp,l.trimStart=np,l.truncate=ip,l.unescape=rp,l.uniqueId=Ip,l.upperCase=sp,l.upperFirst=ps,l.each=Ya,l.eachRight=Xa,l.first=qa,ys(l,function(){var e={};return ze(l,function(t,n){z.call(l.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),l.VERSION=o,De(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){l[e].placeholder=l}),De(["drop","take"],function(e,t){V.prototype[e]=function(n){n=n===r?1:le(N(n),0);var s=this.__filtered__&&!t?new V(this):this.clone();return s.__filtered__?s.__takeCount__=ge(n,s.__takeCount__):s.__views__.push({size:ge(n,Xe),type:e+(s.__dir__<0?"Right":"")}),s},V.prototype[e+"Right"]=function(n){return this.reverse()[e](n).reverse()}}),De(["filter","map","takeWhile"],function(e,t){var n=t+1,s=n==Ws||n==el;V.prototype[e]=function(a){var h=this.clone();return h.__iteratees__.push({iteratee:O(a,3),type:n}),h.__filtered__=h.__filtered__||s,h}}),De(["head","last"],function(e,t){var n="take"+(t?"Right":"");V.prototype[e]=function(){return this[n](1).value()[0]}}),De(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");V.prototype[e]=function(){return this.__filtered__?new V(this):this[n](1)}}),V.prototype.compact=function(){return this.filter(Se)},V.prototype.find=function(e){return this.filter(e).head()},V.prototype.findLast=function(e){return this.reverse().find(e)},V.prototype.invokeMap=q(function(e,t){return typeof e=="function"?new V(this):this.map(function(n){return Tn(n,e,t)})}),V.prototype.reject=function(e){return this.filter(Ii(O(e)))},V.prototype.slice=function(e,t){e=N(e);var n=this;return n.__filtered__&&(e>0||t<0)?new V(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==r&&(t=N(t),n=t<0?n.dropRight(-t):n.take(t-e)),n)},V.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},V.prototype.toArray=function(){return this.take(Xe)},ze(V.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),s=/^(?:head|last)$/.test(t),a=l[s?"take"+(t=="last"?"Right":""):t],h=s||/^find/.test(t);a&&(l.prototype[t]=function(){var c=this.__wrapped__,g=s?[1]:arguments,v=c instanceof V,T=g[0],E=v||U(c),A=function(H){var $=a.apply(l,_t([H],g));return s&&L?$[0]:$};E&&n&&typeof T=="function"&&T.length!=1&&(v=E=!1);var L=this.__chain__,D=!!this.__actions__.length,G=h&&!L,W=v&&!D;if(!h&&E){c=W?c:new V(this);var b=e.apply(c,g);return b.__actions__.push({func:Ei,args:[A],thisArg:r}),new Oe(b,L)}return G&&W?e.apply(this,g):(b=this.thru(A),G?s?b.value()[0]:b.value():b)})}),De(["pop","push","shift","sort","splice","unshift"],function(e){var t=Jn[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",s=/^(?:pop|shift)$/.test(e);l.prototype[e]=function(){var a=arguments;if(s&&!this.__chain__){var h=this.value();return t.apply(U(h)?h:[],a)}return this[n](function(c){return t.apply(U(c)?c:[],a)})}}),ze(V.prototype,function(e,t){var n=l[t];if(n){var s=n.name+"";z.call(Xt,s)||(Xt[s]=[]),Xt[s].push({name:t,func:n})}}),Xt[vi(r,J).name]=[{name:"wrapper",func:r}],V.prototype.clone=rf,V.prototype.reverse=sf,V.prototype.value=of,l.prototype.at=Gd,l.prototype.chain=bd,l.prototype.commit=Bd,l.prototype.next=Ud,l.prototype.plant=Nd,l.prototype.reverse=Wd,l.prototype.toJSON=l.prototype.valueOf=l.prototype.value=Kd,l.prototype.first=l.prototype.head,mn&&(l.prototype[mn]=kd),l},Vt=bh();At?((At.exports=Vt)._=Vt,vr._=Vt):ce._=Vt}).call(Q0)}(Rn,Rn.exports)),Rn.exports}var em=j0();class ji extends Bn{constructor(i,r,o){super(),o!==void 0&&r===void 0?this.setFlatCoordinates(o,i):(r=r||0,this.setCenterAndRadius(i,r,o))}clone(){const i=new ji(this.flatCoordinates.slice(),void 0,this.layout);return i.applyProperties(this),i}closestPointXY(i,r,o,u){const f=this.flatCoordinates,d=i-f[0],_=r-f[1],m=d*d+_*_;if(m<u){if(m===0)for(let x=0;x<this.stride;++x)o[x]=f[x];else{const x=this.getRadius()/Math.sqrt(m);o[0]=f[0]+x*d,o[1]=f[1]+x*_;for(let S=2;S<this.stride;++S)o[S]=f[S]}return o.length=this.stride,m}return u}containsXY(i,r){const o=this.flatCoordinates,u=i-o[0],f=r-o[1];return u*u+f*f<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(i){const r=this.flatCoordinates,o=r[this.stride]-r[0];return Yp(r[0]-o,r[1]-o,r[0]+o,r[1]+o,i)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const i=this.flatCoordinates[this.stride]-this.flatCoordinates[0],r=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return i*i+r*r}getType(){return"Circle"}intersectsExtent(i){const r=this.getExtent();if(Ou(i,r)){const o=this.getCenter();return i[0]<=o[0]&&i[2]>=o[0]||i[1]<=o[1]&&i[3]>=o[1]?!0:Xp(i,this.intersectsCoordinate.bind(this))}return!1}setCenter(i){const r=this.stride,o=this.flatCoordinates[r]-this.flatCoordinates[0],u=i.slice();u[r]=u[0]+o;for(let f=1;f<r;++f)u[r+f]=i[f];this.setFlatCoordinates(this.layout,u),this.changed()}setCenterAndRadius(i,r,o){this.setLayout(o,i,0),this.flatCoordinates||(this.flatCoordinates=[]);const u=this.flatCoordinates;let f=zp(u,0,i,this.stride);u[f++]=u[0]+r;for(let d=1,_=this.stride;d<_;++d)u[f++]=u[d];u.length=f,this.changed()}getCoordinates(){return null}setCoordinates(i,r){}setRadius(i){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+i,this.changed()}rotate(i,r){const o=this.getCenter(),u=this.getStride();this.setCenter(Zp(o,0,o.length,u,i,r,o)),this.changed()}}ji.prototype.transform;class Xi extends Jp{constructor(i){super(),this.geometries_=i,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Wi),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const i=this.geometries_;for(let r=0,o=i.length;r<o;++r)this.changeEventsKeys_.push(Tt(i[r],Mn.CHANGE,this.changed,this))}clone(){const i=new Xi(Ts(this.geometries_));return i.applyProperties(this),i}closestPointXY(i,r,o,u){if(u<Un(this.getExtent(),i,r))return u;const f=this.geometries_;for(let d=0,_=f.length;d<_;++d)u=f[d].closestPointXY(i,r,o,u);return u}containsXY(i,r){const o=this.geometries_;for(let u=0,f=o.length;u<f;++u)if(o[u].containsXY(i,r))return!0;return!1}computeExtent(i){Qp(i);const r=this.geometries_;for(let o=0,u=r.length;o<u;++o)jp(i,r[o].getExtent());return i}getGeometries(){return Ts(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let i=[];const r=this.geometries_;for(let o=0,u=r.length;o<u;++o)r[o].getType()===this.getType()?i=i.concat(r[o].getGeometriesArrayRecursive()):i.push(r[o]);return i}getSimplifiedGeometry(i){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),i<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&i<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const r=[],o=this.geometries_;let u=!1;for(let f=0,d=o.length;f<d;++f){const _=o[f],m=_.getSimplifiedGeometry(i);r.push(m),m!==_&&(u=!0)}return u?new Xi(r):(this.simplifiedGeometryMaxMinSquaredTolerance=i,this)}getType(){return"GeometryCollection"}intersectsExtent(i){const r=this.geometries_;for(let o=0,u=r.length;o<u;++o)if(r[o].intersectsExtent(i))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(i,r){const o=this.geometries_;for(let u=0,f=o.length;u<f;++u)o[u].rotate(i,r);this.changed()}scale(i,r,o){o||(o=e0(this.getExtent()));const u=this.geometries_;for(let f=0,d=u.length;f<d;++f)u[f].scale(i,r,o);this.changed()}setGeometries(i){this.setGeometriesArray(Ts(i))}setGeometriesArray(i){this.unlistenGeometriesChange_(),this.geometries_=i,this.listenGeometriesChange_(),this.changed()}applyTransform(i){const r=this.geometries_;for(let o=0,u=r.length;o<u;++o)r[o].applyTransform(i);this.changed()}translate(i,r){const o=this.geometries_;for(let u=0,f=o.length;u<f;++u)o[u].translate(i,r);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Ts(C){return C.map(i=>i.clone())}class dt extends Bn{constructor(i,r){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,r!==void 0&&!Array.isArray(i[0])?this.setFlatCoordinates(r,i):this.setCoordinates(i,r)}appendCoordinate(i){Gt(this.flatCoordinates,i),this.changed()}clone(){const i=new dt(this.flatCoordinates.slice(),this.layout);return i.applyProperties(this),i}closestPointXY(i,r,o,u){return u<Un(this.getExtent(),i,r)?u:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(t0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),n0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,i,r,o,u))}forEachSegment(i){return i0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,i)}getCoordinateAtM(i,r){return this.layout!="XYM"&&this.layout!="XYZM"?null:(r=r!==void 0?r:!1,X0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,i,r))}getCoordinates(){return Gu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(i,r){return qu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,i,r,this.stride)}getLength(){return Hu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(i){const r=[];return r.length=r0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,i,r,0),new dt(r,"XY")}getType(){return"LineString"}intersectsExtent(i){return s0(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,i,this.getExtent())}setCoordinates(i,r){this.setLayout(r,i,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=bu(this.flatCoordinates,0,i,this.stride),this.changed()}}class Gn extends Bn{constructor(i,r,o){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(i[0]))this.setCoordinates(i,r);else if(r!==void 0&&o)this.setFlatCoordinates(r,i),this.ends_=o;else{const u=i,f=[],d=[];for(let m=0,x=u.length;m<x;++m){const S=u[m];Gt(f,S.getFlatCoordinates()),d.push(f.length)}const _=u.length===0?this.getLayout():u[0].getLayout();this.setFlatCoordinates(_,f),this.ends_=d}}appendLineString(i){Gt(this.flatCoordinates,i.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const i=new Gn(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return i.applyProperties(this),i}closestPointXY(i,r,o,u){return u<Un(this.getExtent(),i,r)?u:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(o0(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),a0(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,i,r,o,u))}getCoordinateAtM(i,r,o){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(r=r!==void 0?r:!1,o=o!==void 0?o:!1,z0(this.flatCoordinates,0,this.ends_,this.stride,i,r,o))}getCoordinates(){return u0(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(i){return i<0||this.ends_.length<=i?null:new dt(this.flatCoordinates.slice(i===0?0:this.ends_[i-1],this.ends_[i]),this.layout)}getLineStrings(){const i=this.flatCoordinates,r=this.ends_,o=this.layout,u=[];let f=0;for(let d=0,_=r.length;d<_;++d){const m=r[d],x=new dt(i.slice(f,m),o);u.push(x),f=m}return u}getLength(){const i=this.ends_;let r=0,o=0;for(let u=0,f=i.length;u<f;++u)o+=Hu(this.flatCoordinates,r,i[u],this.stride),r=i[u];return o}getFlatMidpoints(){const i=[],r=this.flatCoordinates;let o=0;const u=this.ends_,f=this.stride;for(let d=0,_=u.length;d<_;++d){const m=u[d],x=qu(r,o,m,f,.5);Gt(i,x),o=m}return i}getSimplifiedGeometryInternal(i){const r=[],o=[];return r.length=l0(this.flatCoordinates,0,this.ends_,this.stride,i,r,0,o),new Gn(r,"XY",o)}getType(){return"MultiLineString"}intersectsExtent(i){return h0(this.flatCoordinates,0,this.ends_,this.stride,i)}setCoordinates(i,r){this.setLayout(r,i,2),this.flatCoordinates||(this.flatCoordinates=[]);const o=f0(this.flatCoordinates,0,i,this.stride,this.ends_);this.flatCoordinates.length=o.length===0?0:o[o.length-1],this.changed()}}class er extends Bn{constructor(i,r){super(),r&&!Array.isArray(i[0])?this.setFlatCoordinates(r,i):this.setCoordinates(i,r)}appendPoint(i){Gt(this.flatCoordinates,i.getFlatCoordinates()),this.changed()}clone(){const i=new er(this.flatCoordinates.slice(),this.layout);return i.applyProperties(this),i}closestPointXY(i,r,o,u){if(u<Un(this.getExtent(),i,r))return u;const f=this.flatCoordinates,d=this.stride;for(let _=0,m=f.length;_<m;_+=d){const x=Us(i,r,f[_],f[_+1]);if(x<u){u=x;for(let S=0;S<d;++S)o[S]=f[_+S];o.length=d}}return u}getCoordinates(){return Gu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(i){const r=this.flatCoordinates.length/this.stride;return i<0||r<=i?null:new bt(this.flatCoordinates.slice(i*this.stride,(i+1)*this.stride),this.layout)}getPoints(){const i=this.flatCoordinates,r=this.layout,o=this.stride,u=[];for(let f=0,d=i.length;f<d;f+=o){const _=new bt(i.slice(f,f+o),r);u.push(_)}return u}getType(){return"MultiPoint"}intersectsExtent(i){const r=this.flatCoordinates,o=this.stride;for(let u=0,f=r.length;u<f;u+=o){const d=r[u],_=r[u+1];if(c0(i,d,_))return!0}return!1}setCoordinates(i,r){this.setLayout(r,i,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=bu(this.flatCoordinates,0,i,this.stride),this.changed()}}class bn extends Bn{constructor(i,r,o){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!o&&!Array.isArray(i[0])){const u=i,f=[],d=[];for(let _=0,m=u.length;_<m;++_){const x=u[_],S=f.length,I=x.getEnds();for(let P=0,F=I.length;P<F;++P)I[P]+=S;Gt(f,x.getFlatCoordinates()),d.push(I)}r=u.length===0?this.getLayout():u[0].getLayout(),i=f,o=d}r!==void 0&&o?(this.setFlatCoordinates(r,i),this.endss_=o):this.setCoordinates(i,r)}appendPolygon(i){let r;if(!this.flatCoordinates)this.flatCoordinates=i.getFlatCoordinates().slice(),r=i.getEnds().slice(),this.endss_.push();else{const o=this.flatCoordinates.length;Gt(this.flatCoordinates,i.getFlatCoordinates()),r=i.getEnds().slice();for(let u=0,f=r.length;u<f;++u)r[u]+=o}this.endss_.push(r),this.changed()}clone(){const i=this.endss_.length,r=new Array(i);for(let u=0;u<i;++u)r[u]=this.endss_[u].slice();const o=new bn(this.flatCoordinates.slice(),this.layout,r);return o.applyProperties(this),o}closestPointXY(i,r,o,u){return u<Un(this.getExtent(),i,r)?u:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(d0(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),g0(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,i,r,o,u))}containsXY(i,r){return _0(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,i,r)}getArea(){return p0(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(i){let r;return i!==void 0?(r=this.getOrientedFlatCoordinates().slice(),Cu(r,0,this.endss_,this.stride,i)):r=this.flatCoordinates,m0(r,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const i=Z0(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=v0(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,i),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new er(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const i=this.flatCoordinates;y0(i,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=i:(this.orientedFlatCoordinates_=i.slice(),this.orientedFlatCoordinates_.length=Cu(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(i){const r=[],o=[];return r.length=C0(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(i),r,0,o),new bn(r,"XY",o)}getPolygon(i){if(i<0||this.endss_.length<=i)return null;let r;if(i===0)r=0;else{const f=this.endss_[i-1];r=f[f.length-1]}const o=this.endss_[i].slice(),u=o[o.length-1];if(r!==0)for(let f=0,d=o.length;f<d;++f)o[f]-=r;return new Ki(this.flatCoordinates.slice(r,u),this.layout,o)}getPolygons(){const i=this.layout,r=this.flatCoordinates,o=this.endss_,u=[];let f=0;for(let d=0,_=o.length;d<_;++d){const m=o[d].slice(),x=m[m.length-1];if(f!==0)for(let I=0,P=m.length;I<P;++I)m[I]-=f;const S=new Ki(r.slice(f,x),i,m);u.push(S),f=x}return u}getType(){return"MultiPolygon"}intersectsExtent(i){return x0(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,i)}setCoordinates(i,r){this.setLayout(r,i,3),this.flatCoordinates||(this.flatCoordinates=[]);const o=w0(this.flatCoordinates,0,i,this.stride,this.endss_);if(o.length===0)this.flatCoordinates.length=0;else{const u=o[o.length-1];this.flatCoordinates.length=u.length===0?0:u[u.length-1]}this.changed()}}const tm=C=>i=>C(),nm=(C,i)=>r=>C(r)?(i(r),!0):!1,im=C=>{C.forEach(i=>S0(i))};class rm{constructor(i){ht(this,"eventKeys",[]);ht(this,"keyDown",!1);ht(this,"keyDownCallback");ht(this,"keyUpCallback");this.listenedKey=i,this.eventKeys.push(Tt(document,"keydown",this.handleKeyDown.bind(this))),this.eventKeys.push(Tt(document,"keyup",this.handleKeyUp.bind(this)))}destroy(){im(this.eventKeys)}isKeyDown(){return this.keyDown}setOnKeyDown(i){this.keyDownCallback=i}setOnKeyUp(i){this.keyUpCallback=i}handleKeyDown(i){i instanceof KeyboardEvent&&i.key===this.listenedKey&&(this.keyDown=!0,this.keyDownCallback&&this.keyDownCallback())}handleKeyUp(i){i instanceof KeyboardEvent&&i.key===this.listenedKey&&(this.keyDown=!1,this.keyUpCallback&&this.keyUpCallback())}}const sm=(C,i)=>{C.get("draw-style-set")||(C.setStyle(i),C.set("draw-style-set",!0))},Oi={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class Gi extends Qi{constructor(i,r){super(i),this.feature=r}}function om(C,i){const r=[];for(let o=0;o<i.length;++o){const f=i[o].getGeometry();Yu(C,f,r)}return r}function bi(C,i){return Us(C[0],C[1],i[0],i[1])}function nn(C,i){const r=C.length;return i<0?C[i+r]:i>=r?C[i-r]:C[i]}function Bi(C,i,r){let o,u;i<r?(o=i,u=r):(o=r,u=i);const f=Math.ceil(o),d=Math.floor(u);if(f>d){const m=rn(C,o),x=rn(C,u);return bi(m,x)}let _=0;if(o<f){const m=rn(C,o),x=nn(C,f);_+=bi(m,x)}if(d<u){const m=nn(C,d),x=rn(C,u);_+=bi(m,x)}for(let m=f;m<d-1;++m){const x=nn(C,m),S=nn(C,m+1);_+=bi(x,S)}return _}function Yu(C,i,r){if(i instanceof dt){Ui(C,i.getCoordinates(),!1,r);return}if(i instanceof Gn){const o=i.getCoordinates();for(let u=0,f=o.length;u<f;++u)Ui(C,o[u],!1,r);return}if(i instanceof Ki){const o=i.getCoordinates();for(let u=0,f=o.length;u<f;++u)Ui(C,o[u],!0,r);return}if(i instanceof bn){const o=i.getCoordinates();for(let u=0,f=o.length;u<f;++u){const d=o[u];for(let _=0,m=d.length;_<m;++_)Ui(C,d[_],!0,r)}return}if(i instanceof Xi){const o=i.getGeometries();for(let u=0;u<o.length;++u)Yu(C,o[u],r);return}}const Es={index:-1,endIndex:NaN};function am(C,i,r,o){const u=C[0],f=C[1];let d=1/0,_=-1,m=NaN;for(let I=0;I<i.targets.length;++I){const P=i.targets[I],F=P.coordinates;let M=1/0,k;for(let K=0;K<F.length-1;++K){const J=F[K],ae=F[K+1],ee=Xu(u,f,J,ae);ee.squaredDistance<M&&(M=ee.squaredDistance,k=K+ee.along)}M<d&&(d=M,P.ring&&i.targetIndex===I&&(P.endIndex>P.startIndex?k<P.startIndex&&(k+=F.length):P.endIndex<P.startIndex&&k>P.startIndex&&(k-=F.length)),m=k,_=I)}const x=i.targets[_];let S=x.ring;if(i.targetIndex===_&&S){const I=rn(x.coordinates,m),P=r.getPixelFromCoordinate(I);Vi(P,i.startPx)>o&&(S=!1)}if(S){const I=x.coordinates,P=I.length,F=x.startIndex,M=m;if(F<M){const k=Bi(I,F,M);Bi(I,F,M-P)<k&&(m-=P)}else{const k=Bi(I,F,M);Bi(I,F,M+P)<k&&(m+=P)}}return Es.index=_,Es.endIndex=m,Es}function Ui(C,i,r,o){const u=C[0],f=C[1];for(let d=0,_=i.length-1;d<_;++d){const m=i[d],x=i[d+1],S=Xu(u,f,m,x);if(S.squaredDistance===0){const I=d+S.along;o.push({coordinates:i,ring:r,startIndex:I,endIndex:I});return}}}const As={along:0,squaredDistance:0};function Xu(C,i,r,o){const u=r[0],f=r[1],d=o[0],_=o[1],m=d-u,x=_-f;let S=0,I=u,P=f;return(m!==0||x!==0)&&(S=F0(((C-u)*m+(i-f)*x)/(m*m+x*x),0,1),I+=m*S,P+=x*S),As.along=S,As.squaredDistance=P0(Us(C,i,I,P),10),As}function rn(C,i){const r=C.length;let o=Math.floor(i);const u=i-o;o>=r?o-=r:o<0&&(o+=r);let f=o+1;f>=r&&(f-=r);const d=C[o],_=d[0],m=d[1],x=C[f],S=x[0]-_,I=x[1]-m;return[_+S*u,m+I*u]}let um=class extends Ji{constructor(i){const r=i;r.stopDown||(r.stopDown=Bu),super(r),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=i.source?i.source:null,this.features_=i.features?i.features:null,this.snapTolerance_=i.snapTolerance?i.snapTolerance:12,this.type_=i.type,this.mode_=hm(this.type_),this.stopClick_=!!i.stopClick,this.minPoints_=i.minPoints?i.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:i.maxPoints?i.maxPoints:1/0,this.finishCondition_=i.finishCondition?i.finishCondition:qi,this.geometryLayout_=i.geometryLayout?i.geometryLayout:"XY";let o=i.geometryFunction;if(!o){const u=this.mode_;if(u==="Circle")o=(f,d,_)=>{const m=d||new ji([NaN,NaN]),x=oe(f[0]),S=Bt(x,oe(f[f.length-1]));return m.setCenterAndRadius(x,Math.sqrt(S),this.geometryLayout_),m};else{let f;u==="Point"?f=bt:u==="LineString"?f=dt:u==="Polygon"&&(f=Ki),o=(d,_,m)=>(_?u==="Polygon"?d[0].length?_.setCoordinates([d[0].concat([d[0][0]])],this.geometryLayout_):_.setCoordinates([],this.geometryLayout_):_.setCoordinates(d,this.geometryLayout_):_=new f(d,this.geometryLayout_),_)}}this.geometryFunction_=o,this.dragVertexDelay_=i.dragVertexDelay!==void 0?i.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=i.clickTolerance?i.clickTolerance*i.clickTolerance:36,this.overlay_=new ks({source:new Ns({useSpatialIndex:!1,wrapX:i.wrapX?i.wrapX:!1}),style:i.style?i.style:lm(),updateWhileInteracting:!0}),this.geometryName_=i.geometryName,this.condition_=i.condition?i.condition:T0,this.freehandCondition_,i.freehand?this.freehandCondition_=Hi:this.freehandCondition_=i.freehandCondition?i.freehandCondition:E0,this.traceCondition_,this.setTrace(i.trace||!1),this.traceState_={active:!1},this.traceSource_=i.traceSource||i.source||null,this.addChangeListener(Uu.ACTIVE,this.updateState_)}setTrace(i){let r;i?i===!0?r=Hi:r=i:r=Os,this.traceCondition_=r}setMap(i){super.setMap(i),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(i){i.originalEvent.type===Mn.CONTEXTMENU&&i.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(i);let r=i.type===ke.POINTERMOVE,o=!0;return!this.freehand_&&this.lastDragTime_&&i.type===ke.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=i.pixel,this.shouldHandle_=!this.freehand_,r=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&i.type===ke.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(i.coordinate),o=!1):this.freehand_&&i.type===ke.POINTERDOWN?o=!1:r&&this.getPointerCount()<2?(o=i.type===ke.POINTERMOVE,o&&this.freehand_?(this.handlePointerMove_(i),this.shouldHandle_&&i.originalEvent.preventDefault()):(i.originalEvent.pointerType==="mouse"||i.type===ke.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(i)):i.type===ke.DBLCLICK&&(o=!1),super.handleEvent(i)&&o}handleDownEvent(i){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=i.pixel,this.finishCoordinate_||this.startDrawing_(i.coordinate),!0):this.condition_(i)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new A0(ke.POINTERMOVE,i.map,i.originalEvent,!1,i.frameState))},this.dragVertexDelay_),this.downPx_=i.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(i){if(!this.traceSource_||!this.traceCondition_(i))return;if(this.traceState_.active){this.deactivateTrace_();return}const r=this.getMap(),o=r.getCoordinateFromPixel([i.pixel[0]-this.snapTolerance_,i.pixel[1]+this.snapTolerance_]),u=r.getCoordinateFromPixel([i.pixel[0]+this.snapTolerance_,i.pixel[1]-this.snapTolerance_]),f=pe([o,u]),d=this.traceSource_.getFeaturesInExtent(f);if(d.length===0)return;const _=om(i.coordinate,d);_.length&&(this.traceState_={active:!0,startPx:i.pixel.slice(),targets:_,targetIndex:-1})}addOrRemoveTracedCoordinates_(i,r){const o=i.startIndex<=i.endIndex,u=i.startIndex<=r;o===u?o&&r>i.endIndex||!o&&r<i.endIndex?this.addTracedCoordinates_(i,i.endIndex,r):(o&&r<i.endIndex||!o&&r>i.endIndex)&&this.removeTracedCoordinates_(r,i.endIndex):(this.removeTracedCoordinates_(i.startIndex,i.endIndex),this.addTracedCoordinates_(i,i.startIndex,r))}removeTracedCoordinates_(i,r){if(i===r)return;let o=0;if(i<r){const u=Math.ceil(i);let f=Math.floor(r);f===r&&(f-=1),o=f-u+1}else{const u=Math.floor(i);let f=Math.ceil(r);f===r&&(f+=1),o=u-f+1}o>0&&this.removeLastPoints_(o)}addTracedCoordinates_(i,r,o){if(r===o)return;const u=[];if(r<o){const f=Math.ceil(r);let d=Math.floor(o);d===o&&(d-=1);for(let _=f;_<=d;++_)u.push(nn(i.coordinates,_))}else{const f=Math.floor(r);let d=Math.ceil(o);d===o&&(d+=1);for(let _=f;_>=d;--_)u.push(nn(i.coordinates,_))}u.length&&this.appendCoordinates(u)}updateTrace_(i){const r=this.traceState_;if(!r.active||r.targetIndex===-1&&Vi(r.startPx,i.pixel)<this.snapTolerance_)return;const o=am(i.coordinate,r,this.getMap(),this.snapTolerance_);if(r.targetIndex!==o.index){if(r.targetIndex!==-1){const m=r.targets[r.targetIndex];this.removeTracedCoordinates_(m.startIndex,m.endIndex)}const _=r.targets[o.index];this.addTracedCoordinates_(_,_.startIndex,o.endIndex)}else{const _=r.targets[r.targetIndex];this.addOrRemoveTracedCoordinates_(_,o.endIndex)}r.targetIndex=o.index;const u=r.targets[r.targetIndex];u.endIndex=o.endIndex;const f=rn(u.coordinates,u.endIndex),d=this.getMap().getPixelFromCoordinate(f);i.coordinate=f,i.pixel=[Math.round(d[0]),Math.round(d[1])]}handleUpEvent(i){let r=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(i);const o=this.traceState_.active;if(this.toggleTraceState_(i),this.shouldHandle_){const u=!this.finishCoordinate_;u&&this.startDrawing_(i.coordinate),!u&&this.freehand_?this.finishDrawing():!this.freehand_&&(!u||this.mode_==="Point")&&(this.atFinish_(i.pixel,o)?this.finishCondition_(i)&&this.finishDrawing():this.addToDrawing_(i.coordinate)),r=!1}else this.freehand_&&this.abortDrawing()}return!r&&this.stopClick_&&i.preventDefault(),r}handlePointerMove_(i){if(this.pointerType_=i.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const r=this.downPx_,o=i.pixel,u=r[0]-o[0],f=r[1]-o[1],d=u*u+f*f;if(this.shouldHandle_=this.freehand_?d>this.squaredClickTolerance_:d<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(i.coordinate.slice());return}this.updateTrace_(i),this.modifyDrawing_(i.coordinate)}atFinish_(i,r){let o=!1;if(this.sketchFeature_){let u=!1,f=[this.finishCoordinate_];const d=this.mode_;if(d==="Point")o=!0;else if(d==="Circle")o=this.sketchCoords_.length===2;else if(d==="LineString")u=!r&&this.sketchCoords_.length>this.minPoints_;else if(d==="Polygon"){const _=this.sketchCoords_;u=_[0].length>this.minPoints_,f=[_[0][0],_[0][_[0].length-2]],r?f=[_[0][0]]:f=[_[0][0],_[0][_[0].length-2]]}if(u){const _=this.getMap();for(let m=0,x=f.length;m<x;m++){const S=f[m],I=_.getPixelFromCoordinate(S),P=i[0]-I[0],F=i[1]-I[1],M=this.freehand_?1:this.snapTolerance_;if(o=Math.sqrt(P*P+F*F)<=M,o){this.finishCoordinate_=S;break}}}}return o}createOrUpdateSketchPoint_(i){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(i):(this.sketchPoint_=new ct(new bt(i)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(i){this.sketchLine_||(this.sketchLine_=new ct);const r=i.getLinearRing(0);let o=this.sketchLine_.getGeometry();o?(o.setFlatCoordinates(r.getLayout(),r.getFlatCoordinates()),o.changed()):(o=new dt(r.getFlatCoordinates(),r.getLayout()),this.sketchLine_.setGeometry(o))}startDrawing_(i){const r=this.getMap().getView().getProjection(),o=xu(this.geometryLayout_);for(;i.length<o;)i.push(0);this.finishCoordinate_=i,this.mode_==="Point"?this.sketchCoords_=i.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[i.slice(),i.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[i.slice(),i.slice()],this.sketchLineCoords_&&(this.sketchLine_=new ct(new dt(this.sketchLineCoords_)));const u=this.geometryFunction_(this.sketchCoords_,void 0,r);this.sketchFeature_=new ct,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(u),this.updateSketchFeatures_(),this.dispatchEvent(new Gi(Oi.DRAWSTART,this.sketchFeature_))}modifyDrawing_(i){const r=this.getMap(),o=this.sketchFeature_.getGeometry(),u=r.getView().getProjection(),f=xu(this.geometryLayout_);let d,_;for(;i.length<f;)i.push(0);this.mode_==="Point"?_=this.sketchCoords_:this.mode_==="Polygon"?(d=this.sketchCoords_[0],_=d[d.length-1],this.atFinish_(r.getPixelFromCoordinate(i))&&(i=this.finishCoordinate_.slice())):(d=this.sketchCoords_,_=d[d.length-1]),_[0]=i[0],_[1]=i[1],this.geometryFunction_(this.sketchCoords_,o,u),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(i),o.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(o):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(i){const r=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection();let u,f;const d=this.mode_;return d==="LineString"||d==="Circle"?(this.finishCoordinate_=i.slice(),f=this.sketchCoords_,f.length>=this.maxPoints_&&(this.freehand_?f.pop():u=!0),f.push(i.slice()),this.geometryFunction_(f,r,o)):d==="Polygon"&&(f=this.sketchCoords_[0],f.length>=this.maxPoints_&&(this.freehand_?f.pop():u=!0),f.push(i.slice()),u&&(this.finishCoordinate_=f[0]),this.geometryFunction_(this.sketchCoords_,r,o)),this.createOrUpdateSketchPoint_(i.slice()),this.updateSketchFeatures_(),u?this.finishDrawing():this.sketchFeature_}removeLastPoints_(i){if(!this.sketchFeature_)return;const r=this.sketchFeature_.getGeometry(),o=this.getMap().getView().getProjection(),u=this.mode_;for(let f=0;f<i;++f){let d;if(u==="LineString"||u==="Circle"){if(d=this.sketchCoords_,d.splice(-2,1),d.length>=2){this.finishCoordinate_=d[d.length-2].slice();const _=this.finishCoordinate_.slice();d[d.length-1]=_,this.createOrUpdateSketchPoint_(_)}this.geometryFunction_(d,r,o),r.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(r)}else if(u==="Polygon"){d=this.sketchCoords_[0],d.splice(-2,1);const _=this.sketchLine_.getGeometry();if(d.length>=2){const m=d[d.length-2].slice();d[d.length-1]=m,this.createOrUpdateSketchPoint_(m)}_.setCoordinates(d),this.geometryFunction_(this.sketchCoords_,r,o)}if(d.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const i=this.abortDrawing_();if(!i)return null;let r=this.sketchCoords_;const o=i.getGeometry(),u=this.getMap().getView().getProjection();return this.mode_==="LineString"?(r.pop(),this.geometryFunction_(r,o,u)):this.mode_==="Polygon"&&(r[0].pop(),this.geometryFunction_(r,o,u),r=o.getCoordinates()),this.type_==="MultiPoint"?i.setGeometry(new er([r])):this.type_==="MultiLineString"?i.setGeometry(new Gn([r])):this.type_==="MultiPolygon"&&i.setGeometry(new bn([r])),this.dispatchEvent(new Gi(Oi.DRAWEND,i)),this.features_&&this.features_.push(i),this.source_&&this.source_.addFeature(i),i}abortDrawing_(){this.finishCoordinate_=null;const i=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),i}abortDrawing(){const i=this.abortDrawing_();i&&this.dispatchEvent(new Gi(Oi.DRAWABORT,i))}appendCoordinates(i){const r=this.mode_,o=!this.sketchFeature_;o&&this.startDrawing_(i[0]);let u;if(r==="LineString"||r==="Circle")u=this.sketchCoords_;else if(r==="Polygon")u=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;o&&u.shift(),u.pop();for(let d=0;d<i.length;d++)this.addToDrawing_(i[d]);const f=i[i.length-1];this.sketchFeature_=this.addToDrawing_(f),this.modifyDrawing_(f)}extend(i){const o=i.getGeometry();this.sketchFeature_=i,this.sketchCoords_=o.getCoordinates();const u=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=u.slice(),this.sketchCoords_.push(u.slice()),this.sketchPoint_=new ct(new bt(u)),this.updateSketchFeatures_(),this.dispatchEvent(new Gi(Oi.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const i=[];this.sketchFeature_&&i.push(this.sketchFeature_),this.sketchLine_&&i.push(this.sketchLine_),this.sketchPoint_&&i.push(this.sketchPoint_);const r=this.overlay_.getSource();r.clear(!0),r.addFeatures(i)}updateState_(){const i=this.getMap(),r=this.getActive();(!i||!r)&&this.abortDrawing(),this.overlay_.setMap(r?i:null)}};function lm(){const C=ku();return function(i,r){return C[i.getGeometry().getType()]}}function hm(C){switch(C){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+C)}}const Au="olcInteractionDrawUid",fm="olcInteractionDrawUid",Pu="olcInteractionDrawGroup",cm="olcStandardDraw";class dm{constructor(i,r){ht(this,"interaction");this.map=i;const o=this.getDrawInteraction(r);o&&(this.interaction=o)}destroy(){this.map.removeInteraction(this.interaction)}getFullUid(i){return`${fm}-${i}`}getInteraction(){return this.interaction}setActive(i){i?this.use(this.interaction):this.interaction.setActive(!1)}registerInteraction(i,r){i.set(Pu,cm),i.set(Au,this.getFullUid(r)),i.setActive(!1),this.map.addInteraction(i)}use(i){this.deactivateAll(),i.setActive(!0)}deactivateAll(){this.getDrawInteractions().forEach(i=>i.setActive(!1))}getDrawInteraction(i){return this.map.getInteractions().getArray().find(r=>r.get(Au)===this.getFullUid(i))}getDrawInteractions(){return this.map.getInteractions().getArray().filter(i=>!!i.get(Pu))}}class ki extends dm{constructor(i,r,o){super(i,o),this.interaction||this.createInteraction(o,r)}createInteraction(i,r){this.interaction=new um(r),this.registerInteraction(this.interaction,i)}static getDefaultPolygonOptions(i){return{freehandCondition:Os,source:i,type:"Polygon"}}static getDefaultCircleOptions(i){return{source:i,type:"Circle"}}static getDefaultLineOptions(i){return{freehandCondition:Os,source:i,type:"LineString"}}static getDefaultPointOptions(i){return{source:i,type:"Point"}}}const Fu=0,Dn=1,Iu=[0,0,0,0],on=[],Ps={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class Fs extends Qi{constructor(i,r,o){super(i),this.features=r,this.mapBrowserEvent=o}}let gm=class extends Ji{constructor(i){super(i),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=i.condition?i.condition:I0,this.defaultDeleteCondition_=function(o){return L0(o)&&R0(o)},this.deleteCondition_=i.deleteCondition?i.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=i.insertVertexCondition?i.insertVertexCondition:Hi,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new Vu,this.pixelTolerance_=i.pixelTolerance!==void 0?i.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new ks({source:new Ns({useSpatialIndex:!1,wrapX:!!i.wrapX}),style:i.style?i.style:pm(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let r;if(i.features?r=i.features:i.source&&(this.source_=i.source,r=new sn(this.source_.getFeatures()),this.source_.addEventListener(Yi.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(Yi.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!r)throw new Error("The modify interaction requires features, a source or a layer");i.hitDetection&&(this.hitDetection_=i.hitDetection),this.features_=r,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener($i.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener($i.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=i.snapToPointer===void 0?!this.hitDetection_:i.snapToPointer}addFeature_(i){const r=i.getGeometry();if(r){const u=this.SEGMENT_WRITERS_[r.getType()];u&&u(i,r)}const o=this.getMap();o&&o.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(o.getCoordinateFromPixel(this.lastPixel_)),i.addEventListener(Mn.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(i,r){if(!this.featuresBeingModified_){this.featuresBeingModified_=new sn;const o=this.featuresBeingModified_.getArray();for(let u=0,f=r.length;u<f;++u){const d=r[u].feature;d&&!o.includes(d)&&this.featuresBeingModified_.push(d)}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new Fs(Ps.MODIFYSTART,this.featuresBeingModified_,i))}}removeFeature_(i){this.removeFeatureSegmentData_(i),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),i.removeEventListener(Mn.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(i){const r=this.rBush_,o=[];r.forEach(function(u){i===u.feature&&o.push(u)});for(let u=o.length-1;u>=0;--u){const f=o[u];for(let d=this.dragSegments_.length-1;d>=0;--d)this.dragSegments_[d][0]===f&&this.dragSegments_.splice(d,1);r.remove(f)}}setActive(i){this.vertexFeature_&&!i&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(i)}setMap(i){this.overlay_.setMap(i),super.setMap(i)}getOverlay(){return this.overlay_}handleSourceAdd_(i){i.feature&&this.features_.push(i.feature)}handleSourceRemove_(i){i.feature&&this.features_.remove(i.feature)}handleFeatureAdd_(i){this.addFeature_(i.element)}handleFeatureChange_(i){if(!this.changingFeature_){const r=i.target;this.removeFeature_(r),this.addFeature_(r)}}handleFeatureRemove_(i){this.removeFeature_(i.element)}writePointGeometry_(i,r){const o=r.getCoordinates(),u={feature:i,geometry:r,segment:[o,o]};this.rBush_.insert(r.getExtent(),u)}writeMultiPointGeometry_(i,r){const o=r.getCoordinates();for(let u=0,f=o.length;u<f;++u){const d=o[u],_={feature:i,geometry:r,depth:[u],index:u,segment:[d,d]};this.rBush_.insert(r.getExtent(),_)}}writeLineStringGeometry_(i,r){const o=r.getCoordinates();for(let u=0,f=o.length-1;u<f;++u){const d=o.slice(u,u+2),_={feature:i,geometry:r,index:u,segment:d};this.rBush_.insert(pe(d),_)}}writeMultiLineStringGeometry_(i,r){const o=r.getCoordinates();for(let u=0,f=o.length;u<f;++u){const d=o[u];for(let _=0,m=d.length-1;_<m;++_){const x=d.slice(_,_+2),S={feature:i,geometry:r,depth:[u],index:_,segment:x};this.rBush_.insert(pe(x),S)}}}writePolygonGeometry_(i,r){const o=r.getCoordinates();for(let u=0,f=o.length;u<f;++u){const d=o[u];for(let _=0,m=d.length-1;_<m;++_){const x=d.slice(_,_+2),S={feature:i,geometry:r,depth:[u],index:_,segment:x};this.rBush_.insert(pe(x),S)}}}writeMultiPolygonGeometry_(i,r){const o=r.getCoordinates();for(let u=0,f=o.length;u<f;++u){const d=o[u];for(let _=0,m=d.length;_<m;++_){const x=d[_];for(let S=0,I=x.length-1;S<I;++S){const P=x.slice(S,S+2),F={feature:i,geometry:r,depth:[_,u],index:S,segment:P};this.rBush_.insert(pe(P),F)}}}}writeCircleGeometry_(i,r){const o=r.getCenter(),u={feature:i,geometry:r,index:Fu,segment:[o,o]},f={feature:i,geometry:r,index:Dn,segment:[o,o]},d=[u,f];u.featureSegments=d,f.featureSegments=d,this.rBush_.insert(Ss(o),u);let _=r;this.rBush_.insert(_.getExtent(),f)}writeGeometryCollectionGeometry_(i,r){const o=r.getGeometriesArray();for(let u=0;u<o.length;++u){const f=o[u],d=this.SEGMENT_WRITERS_[f.getType()];d(i,f)}}createOrUpdateVertexFeature_(i,r,o,u){let f=this.vertexFeature_;return f?f.getGeometry().setCoordinates(i):(f=new ct(new bt(i)),this.vertexFeature_=f,this.overlay_.getSource().addFeature(f)),f.set("features",r),f.set("geometries",o),f.set("existing",u),f}handleEvent(i){if(!i.originalEvent)return!0;this.lastPointerEvent_=i;let r;return!i.map.getView().getInteracting()&&i.type==ke.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(i),this.vertexFeature_&&this.deleteCondition_(i)&&(i.type!=ke.SINGLECLICK||!this.ignoreNextSingleClick_?r=this.removePoint():r=!0),i.type==ke.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(i)&&!r}findInsertVerticesAndUpdateDragSegments_(i){this.handlePointerAtPixel_(i),this.dragSegments_.length=0,this.featuresBeingModified_=null;const r=this.vertexFeature_;if(!r)return;this.getMap().getView().getProjection();const o=[],u=r.getGeometry().getCoordinates(),f=pe([u]),d=this.rBush_.getInExtent(f),_={};d.sort(_m);for(let m=0,x=d.length;m<x;++m){const S=d[m],I=S.segment;let P=Qe(S.geometry);const F=S.depth;if(F&&(P+="-"+F.join("-")),_[P]||(_[P]=new Array(2)),S.geometry.getType()==="Circle"&&S.index===Dn){const M=Ru(i,S);$e(M,u)&&!_[P][0]&&(this.dragSegments_.push([S,0]),_[P][0]=S);continue}if($e(I[0],u)&&!_[P][0]){this.dragSegments_.push([S,0]),_[P][0]=S;continue}if($e(I[1],u)&&!_[P][1]){if(_[P][0]&&_[P][0].index===0){let M=S.geometry.getCoordinates();switch(S.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":M=M[F[1]];case"Polygon":if(S.index!==M[F[0]].length-2)continue;break}}this.dragSegments_.push([S,1]),_[P][1]=S;continue}Qe(I)in this.vertexSegments_&&!_[P][0]&&!_[P][1]&&o.push(S)}return o}handleDragEvent(i){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(i,this.dragSegments_.map(([f])=>f));const r=[i.coordinate[0]+this.delta_[0],i.coordinate[1]+this.delta_[1]],o=[],u=[];for(let f=0,d=this.dragSegments_.length;f<d;++f){const _=this.dragSegments_[f],m=_[0],x=m.feature;o.includes(x)||o.push(x);const S=m.geometry;u.includes(S)||u.push(S);const I=m.depth;let P;const F=m.segment,M=_[1];for(;r.length<S.getStride();)r.push(F[M][r.length]);switch(S.getType()){case"Point":P=r,F[0]=r,F[1]=r;break;case"MultiPoint":P=S.getCoordinates(),P[m.index]=r,F[0]=r,F[1]=r;break;case"LineString":P=S.getCoordinates(),P[m.index+M]=r,F[M]=r;break;case"MultiLineString":P=S.getCoordinates(),P[I[0]][m.index+M]=r,F[M]=r;break;case"Polygon":P=S.getCoordinates(),P[I[0]][m.index+M]=r,F[M]=r;break;case"MultiPolygon":P=S.getCoordinates(),P[I[1]][I[0]][m.index+M]=r,F[M]=r;break;case"Circle":const k=S;if(F[0]=r,F[1]=r,m.index===Fu)this.changingFeature_=!0,k.setCenter(r),this.changingFeature_=!1;else{this.changingFeature_=!0,i.map.getView().getProjection();let K=Vi(oe(k.getCenter()),oe(r));k.setRadius(K),this.changingFeature_=!1}break}P&&this.setGeometryCoordinates_(S,P)}this.createOrUpdateVertexFeature_(r,o,u,!0)}handleDownEvent(i){if(!this.condition_(i))return!1;const r=i.coordinate,o=this.findInsertVerticesAndUpdateDragSegments_(r);if(o!=null&&o.length&&this.insertVertexCondition_(i)&&(this.willModifyFeatures_(i,o),this.vertexFeature_)){const u=this.vertexFeature_.getGeometry().getCoordinates();for(let f=o.length-1;f>=0;--f)this.insertVertex_(o[f],u);this.ignoreNextSingleClick_=!0}return!!this.vertexFeature_}handleUpEvent(i){for(let r=this.dragSegments_.length-1;r>=0;--r){const o=this.dragSegments_[r][0],u=o.geometry;if(u.getType()==="Circle"){const f=u,d=f.getCenter(),_=o.featureSegments[0],m=o.featureSegments[1];_.segment[0]=d,_.segment[1]=d,m.segment[0]=d,m.segment[1]=d,this.rBush_.update(Ss(d),_);let x=f;this.rBush_.update(x.getExtent(),m)}else this.rBush_.update(pe(o.segment),o)}return this.featuresBeingModified_&&(this.dispatchEvent(new Fs(Ps.MODIFYEND,this.featuresBeingModified_,i)),this.featuresBeingModified_=null),!1}handlePointerMove_(i){this.lastPixel_=i.pixel,this.handlePointerAtPixel_(i.coordinate)}handlePointerAtPixel_(i){const r=this.getMap(),o=r.getPixelFromCoordinate(i);r.getView().getProjection();const u=function(_,m){return Lu(i,_)-Lu(i,m)};let f,d;if(this.hitDetection_){const _=typeof this.hitDetection_=="object"?m=>m===this.hitDetection_:void 0;r.forEachFeatureAtPixel(o,(m,x,S)=>{S&&S.getType()==="Point"&&(S=new bt(On(S.getCoordinates())));const I=S||m.getGeometry();if(I&&I.getType()==="Point"&&m instanceof ct&&this.features_.getArray().includes(m)){d=I;const P=m.getGeometry().getFlatCoordinates().slice(0,2);f=[{feature:m,geometry:d,segment:[P,P]}]}return!0},{layerFilter:_})}if(!f){const _=D0(Ss(i,Iu)),m=r.getView().getResolution()*this.pixelTolerance_,x=Nu(Wu(_,m,Iu));f=this.rBush_.getInExtent(x)}if(f&&f.length>0){const _=f.sort(u)[0],m=_.segment;let x=Ru(i,_);const S=r.getPixelFromCoordinate(x);let I=Vi(o,S);if(d||I<=this.pixelTolerance_){const P={};if(P[Qe(m)]=!0,this.snapToPointer_||(this.delta_[0]=x[0]-i[0],this.delta_[1]=x[1]-i[1]),_.geometry.getType()==="Circle"&&_.index===Dn)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(x,[_.feature],[_.geometry],this.snappedToVertex_);else{const F=r.getPixelFromCoordinate(m[0]),M=r.getPixelFromCoordinate(m[1]),k=Bt(S,F),K=Bt(S,M);if(I=Math.sqrt(Math.min(k,K)),this.snappedToVertex_=I<=this.pixelTolerance_,!this.snappedToVertex_&&!this.insertVertexCondition_(this.lastPointerEvent_)){this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null);return}this.snappedToVertex_&&(x=k>K?m[1]:m[0]),this.createOrUpdateVertexFeature_(x,[_.feature],[_.geometry],this.snappedToVertex_);const J={};J[Qe(_.geometry)]=!0;for(let ae=1,ee=f.length;ae<ee;++ae){const fe=f[ae].segment;if($e(m[0],fe[0])&&$e(m[1],fe[1])||$e(m[0],fe[1])&&$e(m[1],fe[0])){const Le=Qe(f[ae].geometry);Le in J||(J[Le]=!0,P[Qe(fe)]=!0)}else break}}this.vertexSegments_=P;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(i,r){const o=i.segment,u=i.feature,f=i.geometry,d=i.depth,_=i.index;let m;for(;r.length<f.getStride();)r.push(0);switch(f.getType()){case"MultiLineString":m=f.getCoordinates(),m[d[0]].splice(_+1,0,r);break;case"Polygon":m=f.getCoordinates(),m[d[0]].splice(_+1,0,r);break;case"MultiPolygon":m=f.getCoordinates(),m[d[1]][d[0]].splice(_+1,0,r);break;case"LineString":m=f.getCoordinates(),m.splice(_+1,0,r);break;default:return!1}this.setGeometryCoordinates_(f,m);const x=this.rBush_;x.remove(i),this.updateSegmentIndices_(f,_,d,1);const S={segment:[o[0],r],feature:u,geometry:f,depth:d,index:_};x.insert(pe(S.segment),S),this.dragSegments_.push([S,1]);const I={segment:[r,o[1]],feature:u,geometry:f,depth:d,index:_+1};return x.insert(pe(I.segment),I),this.dragSegments_.push([I,0]),!0}updatePointer_(i){var r;return i&&this.findInsertVerticesAndUpdateDragSegments_(i),(r=this.vertexFeature_)==null?void 0:r.getGeometry().getCoordinates()}getPoint(){var r;const i=(r=this.vertexFeature_)==null?void 0:r.getGeometry().getCoordinates();return i?On(i,this.getMap().getView().getProjection()):null}canRemovePoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(o=>o.getType()==="Circle"||o.getType().endsWith("Point")))return!1;const i=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(pe([i])).some(({segment:o})=>$e(o[0],i)||$e(o[1],i))}removePoint(i){if(i&&(i=oe(i,this.getMap().getView().getProjection()),this.updatePointer_(i)),!this.lastPointerEvent_||this.lastPointerEvent_&&this.lastPointerEvent_.type!=ke.POINTERDRAG){const r=this.lastPointerEvent_;this.willModifyFeatures_(r,this.dragSegments_.map(([u])=>u));const o=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new Fs(Ps.MODIFYEND,this.featuresBeingModified_,r)),this.featuresBeingModified_=null,o}return!1}removeVertex_(){const i=this.dragSegments_,r={};let o=!1,u,f,d,_,m,x,S,I,P,F,M;for(m=i.length-1;m>=0;--m)d=i[m],F=d[0],M=Qe(F.feature),F.depth&&(M+="-"+F.depth.join("-")),M in r||(r[M]={}),d[1]===0?(r[M].right=F,r[M].index=F.index):d[1]==1&&(r[M].left=F,r[M].index=F.index+1);for(M in r){switch(P=r[M].right,S=r[M].left,x=r[M].index,I=x-1,S!==void 0?F=S:F=P,I<0&&(I=0),_=F.geometry,f=_.getCoordinates(),u=f,o=!1,_.getType()){case"MultiLineString":f[F.depth[0]].length>2&&(f[F.depth[0]].splice(x,1),o=!0);break;case"LineString":f.length>2&&(f.splice(x,1),o=!0);break;case"MultiPolygon":u=u[F.depth[1]];case"Polygon":u=u[F.depth[0]],u.length>4&&(x==u.length-1&&(x=0),u.splice(x,1),o=!0,x===0&&(u.pop(),u.push(u[0]),I=u.length-1));break}if(o){this.setGeometryCoordinates_(_,f);const k=[];if(S!==void 0&&(this.rBush_.remove(S),k.push(S.segment[0])),P!==void 0&&(this.rBush_.remove(P),k.push(P.segment[1])),S!==void 0&&P!==void 0){const K={depth:F.depth,feature:F.feature,geometry:F.geometry,index:I,segment:k};this.rBush_.insert(pe(K.segment),K)}this.updateSegmentIndices_(_,x,F.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),i.length=0}}return o}canInsertPoint(){if(!this.vertexFeature_||this.vertexFeature_.get("geometries").every(o=>o.getType()==="Circle"||o.getType().endsWith("Point")))return!1;const i=this.vertexFeature_.getGeometry().getCoordinates();return this.rBush_.getInExtent(pe([i])).some(({segment:o})=>!($e(o[0],i)||$e(o[1],i)))}insertPoint(i){var u;const r=i?oe(i,this.getMap().getView().getProjection()):(u=this.vertexFeature_)==null?void 0:u.getGeometry().getCoordinates();return r?this.findInsertVerticesAndUpdateDragSegments_(r).reduce((f,d)=>f||this.insertVertex_(d,r),!1):!1}setGeometryCoordinates_(i,r){this.changingFeature_=!0,i.setCoordinates(r),this.changingFeature_=!1}updateSegmentIndices_(i,r,o,u){this.rBush_.forEachInExtent(i.getExtent(),function(f){f.geometry===i&&(o===void 0||f.depth===void 0||M0(f.depth,o))&&f.index>r&&(f.index+=u)})}};function _m(C,i){return C.index-i.index}function Lu(C,i,r){const o=i.geometry;if(o.getType()==="Circle"){let f=o;if(i.index===Dn){const d=Bt(f.getCenter(),oe(C)),_=Math.sqrt(d)-f.getRadius();return _*_}}const u=oe(C);return on[0]=oe(i.segment[0]),on[1]=oe(i.segment[1]),O0(u,on)}function Ru(C,i,r){const o=i.geometry;if(o.getType()==="Circle"&&i.index===Dn)return On(o.getClosestPoint(oe(C)));const u=oe(C);return on[0]=oe(i.segment[0]),on[1]=oe(i.segment[1]),On(Ku(u,on))}function pm(){const C=ku();return function(i,r){return C.Point}}class mm{constructor(i,r){ht(this,"modifyInteraction");this.map=i,this.modifyInteraction=new gm(r),this.map.addInteraction(this.modifyInteraction)}destroy(){this.map.removeInteraction(this.modifyInteraction)}getInteraction(){return this.modifyInteraction}}const Is={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};class Ls extends Qi{constructor(i,r,o,u,f){super(i),this.features=r,this.coordinate=o,this.startCoordinate=u,this.mapBrowserEvent=f}}let vm=class extends Ji{constructor(i){i=i||{},super(i),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=i.features!==void 0?i.features:null;let r;if(i.layers&&!this.features_)if(typeof i.layers=="function")r=i.layers;else{const o=i.layers;r=function(u){return o.includes(u)}}else r=qi;this.layerFilter_=r,this.filter_=i.filter&&!this.features_?i.filter:qi,this.hitTolerance_=i.hitTolerance?i.hitTolerance:0,this.condition_=i.condition?i.condition:Hi,this.lastFeature_=null,this.addChangeListener(Uu.ACTIVE,this.handleActiveChanged_)}handleDownEvent(i){if(!i.originalEvent||!this.condition_(i))return!1;if(this.lastFeature_=this.featuresAtPixel_(i.pixel,i.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=i.coordinate,this.lastCoordinate_=i.coordinate,this.handleMoveEvent(i);const r=this.features_||new sn([this.lastFeature_]);return this.dispatchEvent(new Ls(Is.TRANSLATESTART,r,i.coordinate,this.startCoordinate_,i)),!0}return!1}handleUpEvent(i){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(i);const r=this.features_||new sn([this.lastFeature_]);return this.dispatchEvent(new Ls(Is.TRANSLATEEND,r,i.coordinate,this.startCoordinate_,i)),this.startCoordinate_=null,!0}return!1}handleDragEvent(i){if(this.lastCoordinate_){const r=i.coordinate;i.map.getView().getProjection();const o=oe(r),u=oe(this.lastCoordinate_),f=o[0]-u[0],d=o[1]-u[1],_=this.features_||new sn([this.lastFeature_]);_.forEach(function(m){const x=m.getGeometry();x.translate(f,d),m.setGeometry(x)}),this.lastCoordinate_=r,this.dispatchEvent(new Ls(Is.TRANSLATING,_,r,this.startCoordinate_,i))}}handleMoveEvent(i){const r=i.map.getViewport();this.featuresAtPixel_(i.pixel,i.map)?(r.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),r.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):r.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(i,r){return r.forEachFeatureAtPixel(i,(o,u)=>{if(!(!(o instanceof ct)||!this.filter_(o,u))&&!(this.features_&&!this.features_.getArray().includes(o)))return o},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(i){this.hitTolerance_=i}setMap(i){const r=this.getMap();super.setMap(i),this.updateState_(r)}handleActiveChanged_(){this.updateState_(null)}updateState_(i){let r=this.getMap();const o=this.getActive();(!r||!o)&&(r=r||i,r&&r.getViewport().classList.remove("ol-grab","ol-grabbing"))}};class ym{constructor(i,r){ht(this,"translateInteraction");this.map=i,this.translateInteraction=new vm(r),this.map.addInteraction(this.translateInteraction)}destroy(){this.map.removeInteraction(this.translateInteraction)}getInteraction(){return this.translateInteraction}}const Rs={SNAP:"snap",UNSNAP:"unsnap"};class Ds extends Qi{constructor(i,r){super(i),this.vertex=r.vertex,this.vertexPixel=r.vertexPixel,this.feature=r.feature,this.segment=r.segment}}const Gs={Circle(C,i){const o=B0(C);return Gs.Polygon(o)},GeometryCollection(C,i){const r=[],o=C.getGeometriesArray();for(let u=0;u<o.length;++u){const f=Gs[o[u].getType()];f&&r.push(f(o[u],i))}return r.flat()},LineString(C){const i=[],r=C.getFlatCoordinates(),o=C.getStride();for(let u=0,f=r.length-o;u<f;u+=o)i.push([r.slice(u,u+2),r.slice(u+o,u+o+2)]);return i},MultiLineString(C){const i=[],r=C.getFlatCoordinates(),o=C.getStride(),u=C.getEnds();let f=0;for(let d=0,_=u.length;d<_;++d){const m=u[d];for(let x=f,S=m-o;x<S;x+=o)i.push([r.slice(x,x+2),r.slice(x+o,x+o+2)]);f=m}return i},MultiPoint(C){const i=[],r=C.getFlatCoordinates(),o=C.getStride();for(let u=0,f=r.length-o;u<f;u+=o)i.push([r.slice(u,u+2)]);return i},MultiPolygon(C){const i=[],r=C.getFlatCoordinates(),o=C.getStride(),u=C.getEndss();let f=0;for(let d=0,_=u.length;d<_;++d){const m=u[d];for(let x=0,S=m.length;x<S;++x){const I=m[x];for(let P=f,F=I-o;P<F;P+=o)i.push([r.slice(P,P+2),r.slice(P+o,P+o+2)]);f=I}}return i},Point(C){return[[C.getFlatCoordinates().slice(0,2)]]},Polygon(C){const i=[],r=C.getFlatCoordinates(),o=C.getStride(),u=C.getEnds();let f=0;for(let d=0,_=u.length;d<_;++d){const m=u[d];for(let x=f,S=m-o;x<S;x+=o)i.push([r.slice(x,x+2),r.slice(x+o,x+o+2)]);f=m}return i}};function Du(C){return C.feature?C.feature:C.element?C.element:null}const Ms=[],ft=[],tn=[];let Cm=class extends Ji{constructor(i){i=i||{};const r=i;r.handleDownEvent||(r.handleDownEvent=qi),r.stopDown||(r.stopDown=Bu),super(r),this.on,this.once,this.un,this.source_=i.source?i.source:null,this.vertex_=i.vertex!==void 0?i.vertex:!0,this.edge_=i.edge!==void 0?i.edge:!0,this.intersection_=i.intersection!==void 0?i.intersection:!1,this.features_=i.features?i.features:null,this.featuresListenerKeys_=[],this.featureChangeListenerKeys_={},this.indexedFeaturesExtents_={},this.pendingFeatures_={},this.pixelTolerance_=i.pixelTolerance!==void 0?i.pixelTolerance:10,this.rBush_=new Vu,this.snapped_=null,this.segmenters_=Object.assign({},Gs,i.segmenters)}addFeature(i,r){r=r!==void 0?r:!0;const o=Qe(i),u=i.getGeometry();if(u){const f=this.segmenters_[u.getType()];if(f){this.indexedFeaturesExtents_[o]=u.getExtent(G0());const d=f(u,this.getMap().getView().getProjection());let _=d.length;for(let m=0;m<_;++m){const x=d[m];ft[m]=pe(x),tn[m]={feature:i,segment:x}}if(ft.length=_,tn.length=_,this.intersection_)for(let m=0,x=d.length;m<x;++m){const S=d[m];if(S.length===1)continue;const I=ft[m];for(let F=0,M=d.length;F<M;++F){if(m===F||m-1===F||m+1===F)continue;const k=d[F];if(!Ou(I,ft[F]))continue;const K=wu(S,k);if(!K)continue;const J=[K];ft[_]=pe(J),tn[_++]={feature:i,segment:J,isIntersection:!0}}const P=this.rBush_.getInExtent(ft[m]);for(const{segment:F}of P){if(F.length===1)continue;const M=wu(S,F);if(!M)continue;const k=[M];ft[_]=pe(k),tn[_++]={feature:i,segment:k,isIntersection:!0}}}_===1?this.rBush_.insert(ft[0],tn[0]):this.rBush_.load(ft,tn)}}r&&(this.featureChangeListenerKeys_[o]=Tt(i,Mn.CHANGE,this.handleFeatureChange_,this))}getFeatures_(){let i;return this.features_?i=this.features_:this.source_&&(i=this.source_.getFeatures()),i}areSnapDataEqual_(i,r){return i.segment===r.segment&&i.feature===r.feature}handleEvent(i){const r=this.snapTo(i.pixel,i.coordinate,i.map);return r?(i.coordinate=r.vertex.slice(0,2),i.pixel=r.vertexPixel,this.snapped_&&!this.areSnapDataEqual_(this.snapped_,r)&&this.dispatchEvent(new Ds(Rs.UNSNAP,this.snapped_)),this.snapped_={vertex:i.coordinate,vertexPixel:i.pixel,feature:r.feature,segment:r.segment},this.dispatchEvent(new Ds(Rs.SNAP,this.snapped_))):this.snapped_&&(this.dispatchEvent(new Ds(Rs.UNSNAP,this.snapped_)),this.snapped_=null),super.handleEvent(i)}handleFeatureAdd_(i){const r=Du(i);r&&this.addFeature(r)}handleFeatureRemove_(i){const r=Du(i);r&&this.removeFeature(r)}handleFeatureChange_(i){const r=i.target;if(this.handlingDownUpSequence){const o=Qe(r);o in this.pendingFeatures_||(this.pendingFeatures_[o]=r)}else this.updateFeature_(r)}handleUpEvent(i){const r=Object.values(this.pendingFeatures_);if(r.length)for(const o of r)this.updateFeature_(o);return!1}removeFeature(i,r){const o=r!==void 0?r:!0,u=Qe(i),f=this.indexedFeaturesExtents_[u];if(f){const d=this.rBush_,_=[];d.forEachInExtent(f,function(m){i===m.feature&&_.push(m)});for(let m=_.length-1;m>=0;--m)d.remove(_[m])}o&&(Wi(this.featureChangeListenerKeys_[u]),delete this.featureChangeListenerKeys_[u])}setMap(i){const r=this.getMap(),o=this.featuresListenerKeys_;let u=this.getFeatures_();if(Array.isArray(u)||(u=u.getArray()),r&&(o.forEach(Wi),o.length=0,this.rBush_.clear(),Object.values(this.featureChangeListenerKeys_).forEach(Wi),this.featureChangeListenerKeys_={}),super.setMap(i),i){this.features_?o.push(Tt(this.features_,$i.ADD,this.handleFeatureAdd_,this),Tt(this.features_,$i.REMOVE,this.handleFeatureRemove_,this)):this.source_&&o.push(Tt(this.source_,Yi.ADDFEATURE,this.handleFeatureAdd_,this),Tt(this.source_,Yi.REMOVEFEATURE,this.handleFeatureRemove_,this));for(const f of u)this.addFeature(f)}}snapTo(i,r,o){o.getView().getProjection();const u=oe(r),f=Nu(Wu(pe([u]),o.getView().getResolution()*this.pixelTolerance_)),d=this.rBush_.getInExtent(f),_=d.length;if(_===0)return null;let m,x=1/0,S,I=null,P;const F=this.pixelTolerance_*this.pixelTolerance_,M=()=>{if(m){const k=o.getPixelFromCoordinate(m);if(Bt(i,k)<=F&&(P&&this.intersection_||!P&&(this.vertex_||this.edge_)))return{vertex:m,vertexPixel:[Math.round(k[0]),Math.round(k[1])],feature:S,segment:I}}return null};if(this.vertex_||this.intersection_){for(let K=0;K<_;++K){const J=d[K];if(J.feature.getGeometry().getType()!=="Circle")for(const ae of J.segment){const ee=oe(ae),fe=Bt(u,ee);fe<x&&(m=ae,x=fe,S=J.feature,P=J.isIntersection)}}const k=M();if(k)return k}if(this.edge_){for(let K=0;K<_;++K){let J=null;const ae=d[K];if(ae.feature.getGeometry().getType()==="Circle"){let ee=ae.feature.getGeometry();J=b0(u,ee)}else{const[ee,fe]=ae.segment;fe&&(Ms[0]=oe(ee),Ms[1]=oe(fe),J=Ku(u,Ms))}if(J){const ee=Bt(u,J);ee<x&&(m=On(J),I=ae.feature.getGeometry().getType()==="Circle"?null:ae.segment,x=ee,S=ae.feature)}}const k=M();if(k)return k}return null}updateFeature_(i){this.removeFeature(i,!1),this.addFeature(i,!1)}};class xm{constructor(i,r){ht(this,"snapInteraction");this.map=i,this.snapInteraction=new Cm(r),this.map.addInteraction(this.snapInteraction)}destroy(){this.map.removeInteraction(this.snapInteraction)}getInteraction(){return this.snapInteraction}}const Ye=U0.createEmptyMap(),zi="layer1-id",wm="background1-id",Sm="point-interaction-uid",Tm="line-interaction-uid",Em=new ks({source:new Ns({features:new sn([new ct])})}),Am=new k0({source:new N0}),Mu=C=>{document.querySelector("#console .text").textContent=C};Ye.setView(new W0({center:[0,0],zoom:2}));Ye.setTarget("map");let Et=new $u(Ye);Et.addLayer(Em,zi);const Pm=new K0(Ye);Pm.addLayer(Am,wm);let Zi,bs,Bs,St;const Fm=[],Im=()=>{Et=new $u(Ye);const C=Et==null?void 0:Et.getLayer(zi),i=C==null?void 0:C.getSource();if(!C||!i||!Ye){console.error("No layer source or no map to draw in.");return}sm(C,Ni),St=new rm("Delete");const r=ki.getDefaultPointOptions(i);r.style=Ni,r.condition=()=>!(St!=null&&St.isKeyDown()),Zi=new ki(Ye,r,Sm);const o=ki.getDefaultLineOptions(i);o.style=Ni,o.condition=()=>!(St!=null&&St.isKeyDown()),bs=new ki(Ye,o,Tm),Bs=new mm(Ye,{deleteCondition:nm(em.overEvery(q0,tm(()=>St.isKeyDown())),Lm.bind(void 0)),source:i,style:Ni}),new ym(Ye,{layers:[C],condition:H0}),new xm(Ye,{source:i}),Fm.push(Zi.getInteraction().on("drawend",u=>{Mu(`Point ${u.feature.get("ol_uid")} added.`)}),bs.getInteraction().on("drawend",u=>{Mu(`Line ${u.feature.get("ol_uid")} added.`)}))},Ni=C=>{const i=C==null?void 0:C.getGeometry(),r=i==null?void 0:i.getType();if(["MultiPoint","Point"].includes(`${r}`)&&i){const o=i.getCoordinates()[0]||0,u=Math.round(Math.abs(o)/(20037508/2)*255);return new Su({image:new V0({radius:8,fill:new $0({color:`rgba(${u}, 0, 0, 0.7)`}),stroke:new Tu({color:`rgba(${u}, 0, 0, 0.7)`})})})}else return["LineString","MultiLineString"].includes(`${r}`)&&i?new Su({stroke:new Tu({color:"rgba(200, 150, 0, 0.8)",width:4})}):Y0},Lm=C=>{setTimeout(()=>Rm(C),20)},Rm=C=>{C.map.forEachFeatureAtPixel(C.pixel,i=>{var u;if(!Et||i instanceof J0)return;const r=i.getGeometry();if(!r||r.getType()==="LineString"&&r.getCoordinates().length>2)return;(((u=Et.getFeaturesCollection(zi))==null?void 0:u.getArray())||[]).includes(i)&&(Et.removeFeatures(zi,[i]),Bs.getInteraction().setActive(!1),Bs.getInteraction().setActive(!0))})};Im();Zi.setActive(!0);const Dm=document.getElementById("type");Dm.addEventListener("change",C=>{C.target.value==="point"?Zi.setActive(!0):bs.setActive(!0)});
