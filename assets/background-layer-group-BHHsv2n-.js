var iE=Object.defineProperty;var rE=(i,t,e)=>t in i?iE(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var pr=(i,t,e)=>rE(i,typeof t!="symbol"?t+"":t,e);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function e(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=e(s);fetch(s.href,a)}})();var Fs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},wr={exports:{}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */var sE=wr.exports,rf;function oE(){return rf||(rf=1,function(i,t){(function(){var e,r="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",u="Expected a function",h="Invalid `variable` option passed into `_.template`",c="__lodash_hash_undefined__",d=500,g="__lodash_placeholder__",y=1,v=2,C=4,T=1,A=2,b=1,F=2,z=4,U=8,N=16,D=32,Z=64,K=128,X=256,$=512,j=30,Lt="...",St=800,ht=16,Ut=1,Ft=2,Ye=3,pe=1/0,yt=9007199254740991,At=17976931348623157e292,Xt=NaN,Wt=4294967295,be=Wt-1,Le=Wt>>>1,Ze=[["ary",K],["bind",b],["bindKey",F],["curry",U],["curryRight",N],["flip",$],["partial",D],["partialRight",Z],["rearg",X]],Kt="[object Arguments]",me="[object Array]",$t="[object AsyncFunction]",ye="[object Boolean]",oe="[object Date]",Se="[object DOMException]",Wn="[object Error]",di="[object Function]",Ji="[object GeneratorFunction]",ve="[object Map]",ae="[object Number]",tn="[object Null]",le="[object Object]",kn="[object Promise]",Zr="[object Proxy]",an="[object RegExp]",qt="[object Set]",Xn="[object String]",Bt="[object Symbol]",Rg="[object Undefined]",Qi="[object WeakMap]",Cg="[object WeakSet]",tr="[object ArrayBuffer]",gi="[object DataView]",bo="[object Float32Array]",Lo="[object Float64Array]",So="[object Int8Array]",Mo="[object Int16Array]",Oo="[object Int32Array]",Po="[object Uint8Array]",Do="[object Uint8ClampedArray]",Fo="[object Uint16Array]",No="[object Uint32Array]",xg=/\b__p \+= '';/g,Tg=/\b(__p \+=) '' \+/g,Ig=/(__e\(.*?\)|\b__t\)) \+\n'';/g,bu=/&(?:amp|lt|gt|quot|#39);/g,Lu=/[&<>"']/g,Ag=RegExp(bu.source),bg=RegExp(Lu.source),Lg=/<%-([\s\S]+?)%>/g,Sg=/<%([\s\S]+?)%>/g,Su=/<%=([\s\S]+?)%>/g,Mg=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Og=/^\w*$/,Pg=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,zo=/[\\^$.*+?()[\]{}|]/g,Dg=RegExp(zo.source),Go=/^\s+/,Fg=/\s/,Ng=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,zg=/\{\n\/\* \[wrapped with (.+)\] \*/,Gg=/,? & /,Ug=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Wg=/[()=,{}\[\]\/\s]/,kg=/\\(\\)?/g,Xg=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Mu=/\w*$/,Kg=/^[-+]0x[0-9a-f]+$/i,Bg=/^0b[01]+$/i,Yg=/^\[object .+?Constructor\]$/,Zg=/^0o[0-7]+$/i,Vg=/^(?:0|[1-9]\d*)$/,Hg=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Vr=/($^)/,$g=/['\n\r\u2028\u2029\\]/g,Hr="\\ud800-\\udfff",qg="\\u0300-\\u036f",jg="\\ufe20-\\ufe2f",Jg="\\u20d0-\\u20ff",Ou=qg+jg+Jg,Pu="\\u2700-\\u27bf",Du="a-z\\xdf-\\xf6\\xf8-\\xff",Qg="\\xac\\xb1\\xd7\\xf7",t_="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",e_="\\u2000-\\u206f",n_=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Fu="A-Z\\xc0-\\xd6\\xd8-\\xde",Nu="\\ufe0e\\ufe0f",zu=Qg+t_+e_+n_,Uo="['’]",i_="["+Hr+"]",Gu="["+zu+"]",$r="["+Ou+"]",Uu="\\d+",r_="["+Pu+"]",Wu="["+Du+"]",ku="[^"+Hr+zu+Uu+Pu+Du+Fu+"]",Wo="\\ud83c[\\udffb-\\udfff]",s_="(?:"+$r+"|"+Wo+")",Xu="[^"+Hr+"]",ko="(?:\\ud83c[\\udde6-\\uddff]){2}",Xo="[\\ud800-\\udbff][\\udc00-\\udfff]",_i="["+Fu+"]",Ku="\\u200d",Bu="(?:"+Wu+"|"+ku+")",o_="(?:"+_i+"|"+ku+")",Yu="(?:"+Uo+"(?:d|ll|m|re|s|t|ve))?",Zu="(?:"+Uo+"(?:D|LL|M|RE|S|T|VE))?",Vu=s_+"?",Hu="["+Nu+"]?",a_="(?:"+Ku+"(?:"+[Xu,ko,Xo].join("|")+")"+Hu+Vu+")*",l_="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",u_="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",$u=Hu+Vu+a_,h_="(?:"+[r_,ko,Xo].join("|")+")"+$u,c_="(?:"+[Xu+$r+"?",$r,ko,Xo,i_].join("|")+")",f_=RegExp(Uo,"g"),d_=RegExp($r,"g"),Ko=RegExp(Wo+"(?="+Wo+")|"+c_+$u,"g"),g_=RegExp([_i+"?"+Wu+"+"+Yu+"(?="+[Gu,_i,"$"].join("|")+")",o_+"+"+Zu+"(?="+[Gu,_i+Bu,"$"].join("|")+")",_i+"?"+Bu+"+"+Yu,_i+"+"+Zu,u_,l_,Uu,h_].join("|"),"g"),__=RegExp("["+Ku+Hr+Ou+Nu+"]"),p_=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,m_=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],y_=-1,Rt={};Rt[bo]=Rt[Lo]=Rt[So]=Rt[Mo]=Rt[Oo]=Rt[Po]=Rt[Do]=Rt[Fo]=Rt[No]=!0,Rt[Kt]=Rt[me]=Rt[tr]=Rt[ye]=Rt[gi]=Rt[oe]=Rt[Wn]=Rt[di]=Rt[ve]=Rt[ae]=Rt[le]=Rt[an]=Rt[qt]=Rt[Xn]=Rt[Qi]=!1;var Et={};Et[Kt]=Et[me]=Et[tr]=Et[gi]=Et[ye]=Et[oe]=Et[bo]=Et[Lo]=Et[So]=Et[Mo]=Et[Oo]=Et[ve]=Et[ae]=Et[le]=Et[an]=Et[qt]=Et[Xn]=Et[Bt]=Et[Po]=Et[Do]=Et[Fo]=Et[No]=!0,Et[Wn]=Et[di]=Et[Qi]=!1;var v_={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},E_={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},w_={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},R_={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},C_=parseFloat,x_=parseInt,qu=typeof Fs=="object"&&Fs&&Fs.Object===Object&&Fs,T_=typeof self=="object"&&self&&self.Object===Object&&self,Yt=qu||T_||Function("return this")(),Bo=t&&!t.nodeType&&t,Kn=Bo&&!0&&i&&!i.nodeType&&i,ju=Kn&&Kn.exports===Bo,Yo=ju&&qu.process,Me=function(){try{var R=Kn&&Kn.require&&Kn.require("util").types;return R||Yo&&Yo.binding&&Yo.binding("util")}catch{}}(),Ju=Me&&Me.isArrayBuffer,Qu=Me&&Me.isDate,th=Me&&Me.isMap,eh=Me&&Me.isRegExp,nh=Me&&Me.isSet,ih=Me&&Me.isTypedArray;function Ee(R,L,I){switch(I.length){case 0:return R.call(L);case 1:return R.call(L,I[0]);case 2:return R.call(L,I[0],I[1]);case 3:return R.call(L,I[0],I[1],I[2])}return R.apply(L,I)}function I_(R,L,I,W){for(var J=-1,ft=R==null?0:R.length;++J<ft;){var Nt=R[J];L(W,Nt,I(Nt),R)}return W}function Oe(R,L){for(var I=-1,W=R==null?0:R.length;++I<W&&L(R[I],I,R)!==!1;);return R}function A_(R,L){for(var I=R==null?0:R.length;I--&&L(R[I],I,R)!==!1;);return R}function rh(R,L){for(var I=-1,W=R==null?0:R.length;++I<W;)if(!L(R[I],I,R))return!1;return!0}function xn(R,L){for(var I=-1,W=R==null?0:R.length,J=0,ft=[];++I<W;){var Nt=R[I];L(Nt,I,R)&&(ft[J++]=Nt)}return ft}function qr(R,L){var I=R==null?0:R.length;return!!I&&pi(R,L,0)>-1}function Zo(R,L,I){for(var W=-1,J=R==null?0:R.length;++W<J;)if(I(L,R[W]))return!0;return!1}function Ct(R,L){for(var I=-1,W=R==null?0:R.length,J=Array(W);++I<W;)J[I]=L(R[I],I,R);return J}function Tn(R,L){for(var I=-1,W=L.length,J=R.length;++I<W;)R[J+I]=L[I];return R}function Vo(R,L,I,W){var J=-1,ft=R==null?0:R.length;for(W&&ft&&(I=R[++J]);++J<ft;)I=L(I,R[J],J,R);return I}function b_(R,L,I,W){var J=R==null?0:R.length;for(W&&J&&(I=R[--J]);J--;)I=L(I,R[J],J,R);return I}function Ho(R,L){for(var I=-1,W=R==null?0:R.length;++I<W;)if(L(R[I],I,R))return!0;return!1}var L_=$o("length");function S_(R){return R.split("")}function M_(R){return R.match(Ug)||[]}function sh(R,L,I){var W;return I(R,function(J,ft,Nt){if(L(J,ft,Nt))return W=ft,!1}),W}function jr(R,L,I,W){for(var J=R.length,ft=I+(W?1:-1);W?ft--:++ft<J;)if(L(R[ft],ft,R))return ft;return-1}function pi(R,L,I){return L===L?K_(R,L,I):jr(R,oh,I)}function O_(R,L,I,W){for(var J=I-1,ft=R.length;++J<ft;)if(W(R[J],L))return J;return-1}function oh(R){return R!==R}function ah(R,L){var I=R==null?0:R.length;return I?jo(R,L)/I:Xt}function $o(R){return function(L){return L==null?e:L[R]}}function qo(R){return function(L){return R==null?e:R[L]}}function lh(R,L,I,W,J){return J(R,function(ft,Nt,vt){I=W?(W=!1,ft):L(I,ft,Nt,vt)}),I}function P_(R,L){var I=R.length;for(R.sort(L);I--;)R[I]=R[I].value;return R}function jo(R,L){for(var I,W=-1,J=R.length;++W<J;){var ft=L(R[W]);ft!==e&&(I=I===e?ft:I+ft)}return I}function Jo(R,L){for(var I=-1,W=Array(R);++I<R;)W[I]=L(I);return W}function D_(R,L){return Ct(L,function(I){return[I,R[I]]})}function uh(R){return R&&R.slice(0,dh(R)+1).replace(Go,"")}function we(R){return function(L){return R(L)}}function Qo(R,L){return Ct(L,function(I){return R[I]})}function er(R,L){return R.has(L)}function hh(R,L){for(var I=-1,W=R.length;++I<W&&pi(L,R[I],0)>-1;);return I}function ch(R,L){for(var I=R.length;I--&&pi(L,R[I],0)>-1;);return I}function F_(R,L){for(var I=R.length,W=0;I--;)R[I]===L&&++W;return W}var N_=qo(v_),z_=qo(E_);function G_(R){return"\\"+R_[R]}function U_(R,L){return R==null?e:R[L]}function mi(R){return __.test(R)}function W_(R){return p_.test(R)}function k_(R){for(var L,I=[];!(L=R.next()).done;)I.push(L.value);return I}function ta(R){var L=-1,I=Array(R.size);return R.forEach(function(W,J){I[++L]=[J,W]}),I}function fh(R,L){return function(I){return R(L(I))}}function In(R,L){for(var I=-1,W=R.length,J=0,ft=[];++I<W;){var Nt=R[I];(Nt===L||Nt===g)&&(R[I]=g,ft[J++]=I)}return ft}function Jr(R){var L=-1,I=Array(R.size);return R.forEach(function(W){I[++L]=W}),I}function X_(R){var L=-1,I=Array(R.size);return R.forEach(function(W){I[++L]=[W,W]}),I}function K_(R,L,I){for(var W=I-1,J=R.length;++W<J;)if(R[W]===L)return W;return-1}function B_(R,L,I){for(var W=I+1;W--;)if(R[W]===L)return W;return W}function yi(R){return mi(R)?Z_(R):L_(R)}function Ve(R){return mi(R)?V_(R):S_(R)}function dh(R){for(var L=R.length;L--&&Fg.test(R.charAt(L)););return L}var Y_=qo(w_);function Z_(R){for(var L=Ko.lastIndex=0;Ko.test(R);)++L;return L}function V_(R){return R.match(Ko)||[]}function H_(R){return R.match(g_)||[]}var $_=function R(L){L=L==null?Yt:vi.defaults(Yt.Object(),L,vi.pick(Yt,m_));var I=L.Array,W=L.Date,J=L.Error,ft=L.Function,Nt=L.Math,vt=L.Object,ea=L.RegExp,q_=L.String,Pe=L.TypeError,Qr=I.prototype,j_=ft.prototype,Ei=vt.prototype,ts=L["__core-js_shared__"],es=j_.toString,_t=Ei.hasOwnProperty,J_=0,gh=function(){var n=/[^.]+$/.exec(ts&&ts.keys&&ts.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}(),ns=Ei.toString,Q_=es.call(vt),tp=Yt._,ep=ea("^"+es.call(_t).replace(zo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),is=ju?L.Buffer:e,An=L.Symbol,rs=L.Uint8Array,_h=is?is.allocUnsafe:e,ss=fh(vt.getPrototypeOf,vt),ph=vt.create,mh=Ei.propertyIsEnumerable,os=Qr.splice,yh=An?An.isConcatSpreadable:e,nr=An?An.iterator:e,Bn=An?An.toStringTag:e,as=function(){try{var n=$n(vt,"defineProperty");return n({},"",{}),n}catch{}}(),np=L.clearTimeout!==Yt.clearTimeout&&L.clearTimeout,ip=W&&W.now!==Yt.Date.now&&W.now,rp=L.setTimeout!==Yt.setTimeout&&L.setTimeout,ls=Nt.ceil,us=Nt.floor,na=vt.getOwnPropertySymbols,sp=is?is.isBuffer:e,vh=L.isFinite,op=Qr.join,ap=fh(vt.keys,vt),zt=Nt.max,jt=Nt.min,lp=W.now,up=L.parseInt,Eh=Nt.random,hp=Qr.reverse,ia=$n(L,"DataView"),ir=$n(L,"Map"),ra=$n(L,"Promise"),wi=$n(L,"Set"),rr=$n(L,"WeakMap"),sr=$n(vt,"create"),hs=rr&&new rr,Ri={},cp=qn(ia),fp=qn(ir),dp=qn(ra),gp=qn(wi),_p=qn(rr),cs=An?An.prototype:e,or=cs?cs.valueOf:e,wh=cs?cs.toString:e;function p(n){if(bt(n)&&!Q(n)&&!(n instanceof ot)){if(n instanceof De)return n;if(_t.call(n,"__wrapped__"))return Rc(n)}return new De(n)}var Ci=function(){function n(){}return function(o){if(!It(o))return{};if(ph)return ph(o);n.prototype=o;var l=new n;return n.prototype=e,l}}();function fs(){}function De(n,o){this.__wrapped__=n,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}p.templateSettings={escape:Lg,evaluate:Sg,interpolate:Su,variable:"",imports:{_:p}},p.prototype=fs.prototype,p.prototype.constructor=p,De.prototype=Ci(fs.prototype),De.prototype.constructor=De;function ot(n){this.__wrapped__=n,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Wt,this.__views__=[]}function pp(){var n=new ot(this.__wrapped__);return n.__actions__=ue(this.__actions__),n.__dir__=this.__dir__,n.__filtered__=this.__filtered__,n.__iteratees__=ue(this.__iteratees__),n.__takeCount__=this.__takeCount__,n.__views__=ue(this.__views__),n}function mp(){if(this.__filtered__){var n=new ot(this);n.__dir__=-1,n.__filtered__=!0}else n=this.clone(),n.__dir__*=-1;return n}function yp(){var n=this.__wrapped__.value(),o=this.__dir__,l=Q(n),f=o<0,_=l?n.length:0,m=Sm(0,_,this.__views__),E=m.start,w=m.end,x=w-E,M=f?w:E-1,O=this.__iteratees__,P=O.length,G=0,k=jt(x,this.__takeCount__);if(!l||!f&&_==x&&k==x)return Yh(n,this.__actions__);var V=[];t:for(;x--&&G<k;){M+=o;for(var nt=-1,H=n[M];++nt<P;){var st=O[nt],at=st.iteratee,xe=st.type,ie=at(H);if(xe==Ft)H=ie;else if(!ie){if(xe==Ut)continue t;break t}}V[G++]=H}return V}ot.prototype=Ci(fs.prototype),ot.prototype.constructor=ot;function Yn(n){var o=-1,l=n==null?0:n.length;for(this.clear();++o<l;){var f=n[o];this.set(f[0],f[1])}}function vp(){this.__data__=sr?sr(null):{},this.size=0}function Ep(n){var o=this.has(n)&&delete this.__data__[n];return this.size-=o?1:0,o}function wp(n){var o=this.__data__;if(sr){var l=o[n];return l===c?e:l}return _t.call(o,n)?o[n]:e}function Rp(n){var o=this.__data__;return sr?o[n]!==e:_t.call(o,n)}function Cp(n,o){var l=this.__data__;return this.size+=this.has(n)?0:1,l[n]=sr&&o===e?c:o,this}Yn.prototype.clear=vp,Yn.prototype.delete=Ep,Yn.prototype.get=wp,Yn.prototype.has=Rp,Yn.prototype.set=Cp;function ln(n){var o=-1,l=n==null?0:n.length;for(this.clear();++o<l;){var f=n[o];this.set(f[0],f[1])}}function xp(){this.__data__=[],this.size=0}function Tp(n){var o=this.__data__,l=ds(o,n);if(l<0)return!1;var f=o.length-1;return l==f?o.pop():os.call(o,l,1),--this.size,!0}function Ip(n){var o=this.__data__,l=ds(o,n);return l<0?e:o[l][1]}function Ap(n){return ds(this.__data__,n)>-1}function bp(n,o){var l=this.__data__,f=ds(l,n);return f<0?(++this.size,l.push([n,o])):l[f][1]=o,this}ln.prototype.clear=xp,ln.prototype.delete=Tp,ln.prototype.get=Ip,ln.prototype.has=Ap,ln.prototype.set=bp;function un(n){var o=-1,l=n==null?0:n.length;for(this.clear();++o<l;){var f=n[o];this.set(f[0],f[1])}}function Lp(){this.size=0,this.__data__={hash:new Yn,map:new(ir||ln),string:new Yn}}function Sp(n){var o=Ts(this,n).delete(n);return this.size-=o?1:0,o}function Mp(n){return Ts(this,n).get(n)}function Op(n){return Ts(this,n).has(n)}function Pp(n,o){var l=Ts(this,n),f=l.size;return l.set(n,o),this.size+=l.size==f?0:1,this}un.prototype.clear=Lp,un.prototype.delete=Sp,un.prototype.get=Mp,un.prototype.has=Op,un.prototype.set=Pp;function Zn(n){var o=-1,l=n==null?0:n.length;for(this.__data__=new un;++o<l;)this.add(n[o])}function Dp(n){return this.__data__.set(n,c),this}function Fp(n){return this.__data__.has(n)}Zn.prototype.add=Zn.prototype.push=Dp,Zn.prototype.has=Fp;function He(n){var o=this.__data__=new ln(n);this.size=o.size}function Np(){this.__data__=new ln,this.size=0}function zp(n){var o=this.__data__,l=o.delete(n);return this.size=o.size,l}function Gp(n){return this.__data__.get(n)}function Up(n){return this.__data__.has(n)}function Wp(n,o){var l=this.__data__;if(l instanceof ln){var f=l.__data__;if(!ir||f.length<s-1)return f.push([n,o]),this.size=++l.size,this;l=this.__data__=new un(f)}return l.set(n,o),this.size=l.size,this}He.prototype.clear=Np,He.prototype.delete=zp,He.prototype.get=Gp,He.prototype.has=Up,He.prototype.set=Wp;function Rh(n,o){var l=Q(n),f=!l&&jn(n),_=!l&&!f&&On(n),m=!l&&!f&&!_&&Ai(n),E=l||f||_||m,w=E?Jo(n.length,q_):[],x=w.length;for(var M in n)(o||_t.call(n,M))&&!(E&&(M=="length"||_&&(M=="offset"||M=="parent")||m&&(M=="buffer"||M=="byteLength"||M=="byteOffset")||dn(M,x)))&&w.push(M);return w}function Ch(n){var o=n.length;return o?n[_a(0,o-1)]:e}function kp(n,o){return Is(ue(n),Vn(o,0,n.length))}function Xp(n){return Is(ue(n))}function sa(n,o,l){(l!==e&&!$e(n[o],l)||l===e&&!(o in n))&&hn(n,o,l)}function ar(n,o,l){var f=n[o];(!(_t.call(n,o)&&$e(f,l))||l===e&&!(o in n))&&hn(n,o,l)}function ds(n,o){for(var l=n.length;l--;)if($e(n[l][0],o))return l;return-1}function Kp(n,o,l,f){return bn(n,function(_,m,E){o(f,_,l(_),E)}),f}function xh(n,o){return n&&nn(o,kt(o),n)}function Bp(n,o){return n&&nn(o,ce(o),n)}function hn(n,o,l){o=="__proto__"&&as?as(n,o,{configurable:!0,enumerable:!0,value:l,writable:!0}):n[o]=l}function oa(n,o){for(var l=-1,f=o.length,_=I(f),m=n==null;++l<f;)_[l]=m?e:Wa(n,o[l]);return _}function Vn(n,o,l){return n===n&&(l!==e&&(n=n<=l?n:l),o!==e&&(n=n>=o?n:o)),n}function Fe(n,o,l,f,_,m){var E,w=o&y,x=o&v,M=o&C;if(l&&(E=_?l(n,f,_,m):l(n)),E!==e)return E;if(!It(n))return n;var O=Q(n);if(O){if(E=Om(n),!w)return ue(n,E)}else{var P=Jt(n),G=P==di||P==Ji;if(On(n))return Hh(n,w);if(P==le||P==Kt||G&&!_){if(E=x||G?{}:dc(n),!w)return x?wm(n,Bp(E,n)):Em(n,xh(E,n))}else{if(!Et[P])return _?n:{};E=Pm(n,P,w)}}m||(m=new He);var k=m.get(n);if(k)return k;m.set(n,E),Xc(n)?n.forEach(function(H){E.add(Fe(H,o,l,H,n,m))}):Wc(n)&&n.forEach(function(H,st){E.set(st,Fe(H,o,l,st,n,m))});var V=M?x?Ia:Ta:x?ce:kt,nt=O?e:V(n);return Oe(nt||n,function(H,st){nt&&(st=H,H=n[st]),ar(E,st,Fe(H,o,l,st,n,m))}),E}function Yp(n){var o=kt(n);return function(l){return Th(l,n,o)}}function Th(n,o,l){var f=l.length;if(n==null)return!f;for(n=vt(n);f--;){var _=l[f],m=o[_],E=n[_];if(E===e&&!(_ in n)||!m(E))return!1}return!0}function Ih(n,o,l){if(typeof n!="function")throw new Pe(u);return gr(function(){n.apply(e,l)},o)}function lr(n,o,l,f){var _=-1,m=qr,E=!0,w=n.length,x=[],M=o.length;if(!w)return x;l&&(o=Ct(o,we(l))),f?(m=Zo,E=!1):o.length>=s&&(m=er,E=!1,o=new Zn(o));t:for(;++_<w;){var O=n[_],P=l==null?O:l(O);if(O=f||O!==0?O:0,E&&P===P){for(var G=M;G--;)if(o[G]===P)continue t;x.push(O)}else m(o,P,f)||x.push(O)}return x}var bn=Qh(en),Ah=Qh(la,!0);function Zp(n,o){var l=!0;return bn(n,function(f,_,m){return l=!!o(f,_,m),l}),l}function gs(n,o,l){for(var f=-1,_=n.length;++f<_;){var m=n[f],E=o(m);if(E!=null&&(w===e?E===E&&!Ce(E):l(E,w)))var w=E,x=m}return x}function Vp(n,o,l,f){var _=n.length;for(l=tt(l),l<0&&(l=-l>_?0:_+l),f=f===e||f>_?_:tt(f),f<0&&(f+=_),f=l>f?0:Bc(f);l<f;)n[l++]=o;return n}function bh(n,o){var l=[];return bn(n,function(f,_,m){o(f,_,m)&&l.push(f)}),l}function Zt(n,o,l,f,_){var m=-1,E=n.length;for(l||(l=Fm),_||(_=[]);++m<E;){var w=n[m];o>0&&l(w)?o>1?Zt(w,o-1,l,f,_):Tn(_,w):f||(_[_.length]=w)}return _}var aa=tc(),Lh=tc(!0);function en(n,o){return n&&aa(n,o,kt)}function la(n,o){return n&&Lh(n,o,kt)}function _s(n,o){return xn(o,function(l){return gn(n[l])})}function Hn(n,o){o=Sn(o,n);for(var l=0,f=o.length;n!=null&&l<f;)n=n[rn(o[l++])];return l&&l==f?n:e}function Sh(n,o,l){var f=o(n);return Q(n)?f:Tn(f,l(n))}function ee(n){return n==null?n===e?Rg:tn:Bn&&Bn in vt(n)?Lm(n):Xm(n)}function ua(n,o){return n>o}function Hp(n,o){return n!=null&&_t.call(n,o)}function $p(n,o){return n!=null&&o in vt(n)}function qp(n,o,l){return n>=jt(o,l)&&n<zt(o,l)}function ha(n,o,l){for(var f=l?Zo:qr,_=n[0].length,m=n.length,E=m,w=I(m),x=1/0,M=[];E--;){var O=n[E];E&&o&&(O=Ct(O,we(o))),x=jt(O.length,x),w[E]=!l&&(o||_>=120&&O.length>=120)?new Zn(E&&O):e}O=n[0];var P=-1,G=w[0];t:for(;++P<_&&M.length<x;){var k=O[P],V=o?o(k):k;if(k=l||k!==0?k:0,!(G?er(G,V):f(M,V,l))){for(E=m;--E;){var nt=w[E];if(!(nt?er(nt,V):f(n[E],V,l)))continue t}G&&G.push(V),M.push(k)}}return M}function jp(n,o,l,f){return en(n,function(_,m,E){o(f,l(_),m,E)}),f}function ur(n,o,l){o=Sn(o,n),n=mc(n,o);var f=n==null?n:n[rn(ze(o))];return f==null?e:Ee(f,n,l)}function Mh(n){return bt(n)&&ee(n)==Kt}function Jp(n){return bt(n)&&ee(n)==tr}function Qp(n){return bt(n)&&ee(n)==oe}function hr(n,o,l,f,_){return n===o?!0:n==null||o==null||!bt(n)&&!bt(o)?n!==n&&o!==o:tm(n,o,l,f,hr,_)}function tm(n,o,l,f,_,m){var E=Q(n),w=Q(o),x=E?me:Jt(n),M=w?me:Jt(o);x=x==Kt?le:x,M=M==Kt?le:M;var O=x==le,P=M==le,G=x==M;if(G&&On(n)){if(!On(o))return!1;E=!0,O=!1}if(G&&!O)return m||(m=new He),E||Ai(n)?hc(n,o,l,f,_,m):Am(n,o,x,l,f,_,m);if(!(l&T)){var k=O&&_t.call(n,"__wrapped__"),V=P&&_t.call(o,"__wrapped__");if(k||V){var nt=k?n.value():n,H=V?o.value():o;return m||(m=new He),_(nt,H,l,f,m)}}return G?(m||(m=new He),bm(n,o,l,f,_,m)):!1}function em(n){return bt(n)&&Jt(n)==ve}function ca(n,o,l,f){var _=l.length,m=_,E=!f;if(n==null)return!m;for(n=vt(n);_--;){var w=l[_];if(E&&w[2]?w[1]!==n[w[0]]:!(w[0]in n))return!1}for(;++_<m;){w=l[_];var x=w[0],M=n[x],O=w[1];if(E&&w[2]){if(M===e&&!(x in n))return!1}else{var P=new He;if(f)var G=f(M,O,x,n,o,P);if(!(G===e?hr(O,M,T|A,f,P):G))return!1}}return!0}function Oh(n){if(!It(n)||zm(n))return!1;var o=gn(n)?ep:Yg;return o.test(qn(n))}function nm(n){return bt(n)&&ee(n)==an}function im(n){return bt(n)&&Jt(n)==qt}function rm(n){return bt(n)&&Os(n.length)&&!!Rt[ee(n)]}function Ph(n){return typeof n=="function"?n:n==null?fe:typeof n=="object"?Q(n)?Nh(n[0],n[1]):Fh(n):ef(n)}function fa(n){if(!dr(n))return ap(n);var o=[];for(var l in vt(n))_t.call(n,l)&&l!="constructor"&&o.push(l);return o}function sm(n){if(!It(n))return km(n);var o=dr(n),l=[];for(var f in n)f=="constructor"&&(o||!_t.call(n,f))||l.push(f);return l}function da(n,o){return n<o}function Dh(n,o){var l=-1,f=he(n)?I(n.length):[];return bn(n,function(_,m,E){f[++l]=o(_,m,E)}),f}function Fh(n){var o=ba(n);return o.length==1&&o[0][2]?_c(o[0][0],o[0][1]):function(l){return l===n||ca(l,n,o)}}function Nh(n,o){return Sa(n)&&gc(o)?_c(rn(n),o):function(l){var f=Wa(l,n);return f===e&&f===o?ka(l,n):hr(o,f,T|A)}}function ps(n,o,l,f,_){n!==o&&aa(o,function(m,E){if(_||(_=new He),It(m))om(n,o,E,l,ps,f,_);else{var w=f?f(Oa(n,E),m,E+"",n,o,_):e;w===e&&(w=m),sa(n,E,w)}},ce)}function om(n,o,l,f,_,m,E){var w=Oa(n,l),x=Oa(o,l),M=E.get(x);if(M){sa(n,l,M);return}var O=m?m(w,x,l+"",n,o,E):e,P=O===e;if(P){var G=Q(x),k=!G&&On(x),V=!G&&!k&&Ai(x);O=x,G||k||V?Q(w)?O=w:Mt(w)?O=ue(w):k?(P=!1,O=Hh(x,!0)):V?(P=!1,O=$h(x,!0)):O=[]:_r(x)||jn(x)?(O=w,jn(w)?O=Yc(w):(!It(w)||gn(w))&&(O=dc(x))):P=!1}P&&(E.set(x,O),_(O,x,f,m,E),E.delete(x)),sa(n,l,O)}function zh(n,o){var l=n.length;if(l)return o+=o<0?l:0,dn(o,l)?n[o]:e}function Gh(n,o,l){o.length?o=Ct(o,function(m){return Q(m)?function(E){return Hn(E,m.length===1?m[0]:m)}:m}):o=[fe];var f=-1;o=Ct(o,we(Y()));var _=Dh(n,function(m,E,w){var x=Ct(o,function(M){return M(m)});return{criteria:x,index:++f,value:m}});return P_(_,function(m,E){return vm(m,E,l)})}function am(n,o){return Uh(n,o,function(l,f){return ka(n,f)})}function Uh(n,o,l){for(var f=-1,_=o.length,m={};++f<_;){var E=o[f],w=Hn(n,E);l(w,E)&&cr(m,Sn(E,n),w)}return m}function lm(n){return function(o){return Hn(o,n)}}function ga(n,o,l,f){var _=f?O_:pi,m=-1,E=o.length,w=n;for(n===o&&(o=ue(o)),l&&(w=Ct(n,we(l)));++m<E;)for(var x=0,M=o[m],O=l?l(M):M;(x=_(w,O,x,f))>-1;)w!==n&&os.call(w,x,1),os.call(n,x,1);return n}function Wh(n,o){for(var l=n?o.length:0,f=l-1;l--;){var _=o[l];if(l==f||_!==m){var m=_;dn(_)?os.call(n,_,1):ya(n,_)}}return n}function _a(n,o){return n+us(Eh()*(o-n+1))}function um(n,o,l,f){for(var _=-1,m=zt(ls((o-n)/(l||1)),0),E=I(m);m--;)E[f?m:++_]=n,n+=l;return E}function pa(n,o){var l="";if(!n||o<1||o>yt)return l;do o%2&&(l+=n),o=us(o/2),o&&(n+=n);while(o);return l}function rt(n,o){return Pa(pc(n,o,fe),n+"")}function hm(n){return Ch(bi(n))}function cm(n,o){var l=bi(n);return Is(l,Vn(o,0,l.length))}function cr(n,o,l,f){if(!It(n))return n;o=Sn(o,n);for(var _=-1,m=o.length,E=m-1,w=n;w!=null&&++_<m;){var x=rn(o[_]),M=l;if(x==="__proto__"||x==="constructor"||x==="prototype")return n;if(_!=E){var O=w[x];M=f?f(O,x,w):e,M===e&&(M=It(O)?O:dn(o[_+1])?[]:{})}ar(w,x,M),w=w[x]}return n}var kh=hs?function(n,o){return hs.set(n,o),n}:fe,fm=as?function(n,o){return as(n,"toString",{configurable:!0,enumerable:!1,value:Ka(o),writable:!0})}:fe;function dm(n){return Is(bi(n))}function Ne(n,o,l){var f=-1,_=n.length;o<0&&(o=-o>_?0:_+o),l=l>_?_:l,l<0&&(l+=_),_=o>l?0:l-o>>>0,o>>>=0;for(var m=I(_);++f<_;)m[f]=n[f+o];return m}function gm(n,o){var l;return bn(n,function(f,_,m){return l=o(f,_,m),!l}),!!l}function ms(n,o,l){var f=0,_=n==null?f:n.length;if(typeof o=="number"&&o===o&&_<=Le){for(;f<_;){var m=f+_>>>1,E=n[m];E!==null&&!Ce(E)&&(l?E<=o:E<o)?f=m+1:_=m}return _}return ma(n,o,fe,l)}function ma(n,o,l,f){var _=0,m=n==null?0:n.length;if(m===0)return 0;o=l(o);for(var E=o!==o,w=o===null,x=Ce(o),M=o===e;_<m;){var O=us((_+m)/2),P=l(n[O]),G=P!==e,k=P===null,V=P===P,nt=Ce(P);if(E)var H=f||V;else M?H=V&&(f||G):w?H=V&&G&&(f||!k):x?H=V&&G&&!k&&(f||!nt):k||nt?H=!1:H=f?P<=o:P<o;H?_=O+1:m=O}return jt(m,be)}function Xh(n,o){for(var l=-1,f=n.length,_=0,m=[];++l<f;){var E=n[l],w=o?o(E):E;if(!l||!$e(w,x)){var x=w;m[_++]=E===0?0:E}}return m}function Kh(n){return typeof n=="number"?n:Ce(n)?Xt:+n}function Re(n){if(typeof n=="string")return n;if(Q(n))return Ct(n,Re)+"";if(Ce(n))return wh?wh.call(n):"";var o=n+"";return o=="0"&&1/n==-1/0?"-0":o}function Ln(n,o,l){var f=-1,_=qr,m=n.length,E=!0,w=[],x=w;if(l)E=!1,_=Zo;else if(m>=s){var M=o?null:Tm(n);if(M)return Jr(M);E=!1,_=er,x=new Zn}else x=o?[]:w;t:for(;++f<m;){var O=n[f],P=o?o(O):O;if(O=l||O!==0?O:0,E&&P===P){for(var G=x.length;G--;)if(x[G]===P)continue t;o&&x.push(P),w.push(O)}else _(x,P,l)||(x!==w&&x.push(P),w.push(O))}return w}function ya(n,o){return o=Sn(o,n),n=mc(n,o),n==null||delete n[rn(ze(o))]}function Bh(n,o,l,f){return cr(n,o,l(Hn(n,o)),f)}function ys(n,o,l,f){for(var _=n.length,m=f?_:-1;(f?m--:++m<_)&&o(n[m],m,n););return l?Ne(n,f?0:m,f?m+1:_):Ne(n,f?m+1:0,f?_:m)}function Yh(n,o){var l=n;return l instanceof ot&&(l=l.value()),Vo(o,function(f,_){return _.func.apply(_.thisArg,Tn([f],_.args))},l)}function va(n,o,l){var f=n.length;if(f<2)return f?Ln(n[0]):[];for(var _=-1,m=I(f);++_<f;)for(var E=n[_],w=-1;++w<f;)w!=_&&(m[_]=lr(m[_]||E,n[w],o,l));return Ln(Zt(m,1),o,l)}function Zh(n,o,l){for(var f=-1,_=n.length,m=o.length,E={};++f<_;){var w=f<m?o[f]:e;l(E,n[f],w)}return E}function Ea(n){return Mt(n)?n:[]}function wa(n){return typeof n=="function"?n:fe}function Sn(n,o){return Q(n)?n:Sa(n,o)?[n]:wc(gt(n))}var _m=rt;function Mn(n,o,l){var f=n.length;return l=l===e?f:l,!o&&l>=f?n:Ne(n,o,l)}var Vh=np||function(n){return Yt.clearTimeout(n)};function Hh(n,o){if(o)return n.slice();var l=n.length,f=_h?_h(l):new n.constructor(l);return n.copy(f),f}function Ra(n){var o=new n.constructor(n.byteLength);return new rs(o).set(new rs(n)),o}function pm(n,o){var l=o?Ra(n.buffer):n.buffer;return new n.constructor(l,n.byteOffset,n.byteLength)}function mm(n){var o=new n.constructor(n.source,Mu.exec(n));return o.lastIndex=n.lastIndex,o}function ym(n){return or?vt(or.call(n)):{}}function $h(n,o){var l=o?Ra(n.buffer):n.buffer;return new n.constructor(l,n.byteOffset,n.length)}function qh(n,o){if(n!==o){var l=n!==e,f=n===null,_=n===n,m=Ce(n),E=o!==e,w=o===null,x=o===o,M=Ce(o);if(!w&&!M&&!m&&n>o||m&&E&&x&&!w&&!M||f&&E&&x||!l&&x||!_)return 1;if(!f&&!m&&!M&&n<o||M&&l&&_&&!f&&!m||w&&l&&_||!E&&_||!x)return-1}return 0}function vm(n,o,l){for(var f=-1,_=n.criteria,m=o.criteria,E=_.length,w=l.length;++f<E;){var x=qh(_[f],m[f]);if(x){if(f>=w)return x;var M=l[f];return x*(M=="desc"?-1:1)}}return n.index-o.index}function jh(n,o,l,f){for(var _=-1,m=n.length,E=l.length,w=-1,x=o.length,M=zt(m-E,0),O=I(x+M),P=!f;++w<x;)O[w]=o[w];for(;++_<E;)(P||_<m)&&(O[l[_]]=n[_]);for(;M--;)O[w++]=n[_++];return O}function Jh(n,o,l,f){for(var _=-1,m=n.length,E=-1,w=l.length,x=-1,M=o.length,O=zt(m-w,0),P=I(O+M),G=!f;++_<O;)P[_]=n[_];for(var k=_;++x<M;)P[k+x]=o[x];for(;++E<w;)(G||_<m)&&(P[k+l[E]]=n[_++]);return P}function ue(n,o){var l=-1,f=n.length;for(o||(o=I(f));++l<f;)o[l]=n[l];return o}function nn(n,o,l,f){var _=!l;l||(l={});for(var m=-1,E=o.length;++m<E;){var w=o[m],x=f?f(l[w],n[w],w,l,n):e;x===e&&(x=n[w]),_?hn(l,w,x):ar(l,w,x)}return l}function Em(n,o){return nn(n,La(n),o)}function wm(n,o){return nn(n,cc(n),o)}function vs(n,o){return function(l,f){var _=Q(l)?I_:Kp,m=o?o():{};return _(l,n,Y(f,2),m)}}function xi(n){return rt(function(o,l){var f=-1,_=l.length,m=_>1?l[_-1]:e,E=_>2?l[2]:e;for(m=n.length>3&&typeof m=="function"?(_--,m):e,E&&ne(l[0],l[1],E)&&(m=_<3?e:m,_=1),o=vt(o);++f<_;){var w=l[f];w&&n(o,w,f,m)}return o})}function Qh(n,o){return function(l,f){if(l==null)return l;if(!he(l))return n(l,f);for(var _=l.length,m=o?_:-1,E=vt(l);(o?m--:++m<_)&&f(E[m],m,E)!==!1;);return l}}function tc(n){return function(o,l,f){for(var _=-1,m=vt(o),E=f(o),w=E.length;w--;){var x=E[n?w:++_];if(l(m[x],x,m)===!1)break}return o}}function Rm(n,o,l){var f=o&b,_=fr(n);function m(){var E=this&&this!==Yt&&this instanceof m?_:n;return E.apply(f?l:this,arguments)}return m}function ec(n){return function(o){o=gt(o);var l=mi(o)?Ve(o):e,f=l?l[0]:o.charAt(0),_=l?Mn(l,1).join(""):o.slice(1);return f[n]()+_}}function Ti(n){return function(o){return Vo(Qc(Jc(o).replace(f_,"")),n,"")}}function fr(n){return function(){var o=arguments;switch(o.length){case 0:return new n;case 1:return new n(o[0]);case 2:return new n(o[0],o[1]);case 3:return new n(o[0],o[1],o[2]);case 4:return new n(o[0],o[1],o[2],o[3]);case 5:return new n(o[0],o[1],o[2],o[3],o[4]);case 6:return new n(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new n(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var l=Ci(n.prototype),f=n.apply(l,o);return It(f)?f:l}}function Cm(n,o,l){var f=fr(n);function _(){for(var m=arguments.length,E=I(m),w=m,x=Ii(_);w--;)E[w]=arguments[w];var M=m<3&&E[0]!==x&&E[m-1]!==x?[]:In(E,x);if(m-=M.length,m<l)return oc(n,o,Es,_.placeholder,e,E,M,e,e,l-m);var O=this&&this!==Yt&&this instanceof _?f:n;return Ee(O,this,E)}return _}function nc(n){return function(o,l,f){var _=vt(o);if(!he(o)){var m=Y(l,3);o=kt(o),l=function(w){return m(_[w],w,_)}}var E=n(o,l,f);return E>-1?_[m?o[E]:E]:e}}function ic(n){return fn(function(o){var l=o.length,f=l,_=De.prototype.thru;for(n&&o.reverse();f--;){var m=o[f];if(typeof m!="function")throw new Pe(u);if(_&&!E&&xs(m)=="wrapper")var E=new De([],!0)}for(f=E?f:l;++f<l;){m=o[f];var w=xs(m),x=w=="wrapper"?Aa(m):e;x&&Ma(x[0])&&x[1]==(K|U|D|X)&&!x[4].length&&x[9]==1?E=E[xs(x[0])].apply(E,x[3]):E=m.length==1&&Ma(m)?E[w]():E.thru(m)}return function(){var M=arguments,O=M[0];if(E&&M.length==1&&Q(O))return E.plant(O).value();for(var P=0,G=l?o[P].apply(this,M):O;++P<l;)G=o[P].call(this,G);return G}})}function Es(n,o,l,f,_,m,E,w,x,M){var O=o&K,P=o&b,G=o&F,k=o&(U|N),V=o&$,nt=G?e:fr(n);function H(){for(var st=arguments.length,at=I(st),xe=st;xe--;)at[xe]=arguments[xe];if(k)var ie=Ii(H),Te=F_(at,ie);if(f&&(at=jh(at,f,_,k)),m&&(at=Jh(at,m,E,k)),st-=Te,k&&st<M){var Ot=In(at,ie);return oc(n,o,Es,H.placeholder,l,at,Ot,w,x,M-st)}var qe=P?l:this,pn=G?qe[n]:n;return st=at.length,w?at=Km(at,w):V&&st>1&&at.reverse(),O&&x<st&&(at.length=x),this&&this!==Yt&&this instanceof H&&(pn=nt||fr(pn)),pn.apply(qe,at)}return H}function rc(n,o){return function(l,f){return jp(l,n,o(f),{})}}function ws(n,o){return function(l,f){var _;if(l===e&&f===e)return o;if(l!==e&&(_=l),f!==e){if(_===e)return f;typeof l=="string"||typeof f=="string"?(l=Re(l),f=Re(f)):(l=Kh(l),f=Kh(f)),_=n(l,f)}return _}}function Ca(n){return fn(function(o){return o=Ct(o,we(Y())),rt(function(l){var f=this;return n(o,function(_){return Ee(_,f,l)})})})}function Rs(n,o){o=o===e?" ":Re(o);var l=o.length;if(l<2)return l?pa(o,n):o;var f=pa(o,ls(n/yi(o)));return mi(o)?Mn(Ve(f),0,n).join(""):f.slice(0,n)}function xm(n,o,l,f){var _=o&b,m=fr(n);function E(){for(var w=-1,x=arguments.length,M=-1,O=f.length,P=I(O+x),G=this&&this!==Yt&&this instanceof E?m:n;++M<O;)P[M]=f[M];for(;x--;)P[M++]=arguments[++w];return Ee(G,_?l:this,P)}return E}function sc(n){return function(o,l,f){return f&&typeof f!="number"&&ne(o,l,f)&&(l=f=e),o=_n(o),l===e?(l=o,o=0):l=_n(l),f=f===e?o<l?1:-1:_n(f),um(o,l,f,n)}}function Cs(n){return function(o,l){return typeof o=="string"&&typeof l=="string"||(o=Ge(o),l=Ge(l)),n(o,l)}}function oc(n,o,l,f,_,m,E,w,x,M){var O=o&U,P=O?E:e,G=O?e:E,k=O?m:e,V=O?e:m;o|=O?D:Z,o&=~(O?Z:D),o&z||(o&=-4);var nt=[n,o,_,k,P,V,G,w,x,M],H=l.apply(e,nt);return Ma(n)&&yc(H,nt),H.placeholder=f,vc(H,n,o)}function xa(n){var o=Nt[n];return function(l,f){if(l=Ge(l),f=f==null?0:jt(tt(f),292),f&&vh(l)){var _=(gt(l)+"e").split("e"),m=o(_[0]+"e"+(+_[1]+f));return _=(gt(m)+"e").split("e"),+(_[0]+"e"+(+_[1]-f))}return o(l)}}var Tm=wi&&1/Jr(new wi([,-0]))[1]==pe?function(n){return new wi(n)}:Za;function ac(n){return function(o){var l=Jt(o);return l==ve?ta(o):l==qt?X_(o):D_(o,n(o))}}function cn(n,o,l,f,_,m,E,w){var x=o&F;if(!x&&typeof n!="function")throw new Pe(u);var M=f?f.length:0;if(M||(o&=-97,f=_=e),E=E===e?E:zt(tt(E),0),w=w===e?w:tt(w),M-=_?_.length:0,o&Z){var O=f,P=_;f=_=e}var G=x?e:Aa(n),k=[n,o,l,f,_,O,P,m,E,w];if(G&&Wm(k,G),n=k[0],o=k[1],l=k[2],f=k[3],_=k[4],w=k[9]=k[9]===e?x?0:n.length:zt(k[9]-M,0),!w&&o&(U|N)&&(o&=-25),!o||o==b)var V=Rm(n,o,l);else o==U||o==N?V=Cm(n,o,w):(o==D||o==(b|D))&&!_.length?V=xm(n,o,l,f):V=Es.apply(e,k);var nt=G?kh:yc;return vc(nt(V,k),n,o)}function lc(n,o,l,f){return n===e||$e(n,Ei[l])&&!_t.call(f,l)?o:n}function uc(n,o,l,f,_,m){return It(n)&&It(o)&&(m.set(o,n),ps(n,o,e,uc,m),m.delete(o)),n}function Im(n){return _r(n)?e:n}function hc(n,o,l,f,_,m){var E=l&T,w=n.length,x=o.length;if(w!=x&&!(E&&x>w))return!1;var M=m.get(n),O=m.get(o);if(M&&O)return M==o&&O==n;var P=-1,G=!0,k=l&A?new Zn:e;for(m.set(n,o),m.set(o,n);++P<w;){var V=n[P],nt=o[P];if(f)var H=E?f(nt,V,P,o,n,m):f(V,nt,P,n,o,m);if(H!==e){if(H)continue;G=!1;break}if(k){if(!Ho(o,function(st,at){if(!er(k,at)&&(V===st||_(V,st,l,f,m)))return k.push(at)})){G=!1;break}}else if(!(V===nt||_(V,nt,l,f,m))){G=!1;break}}return m.delete(n),m.delete(o),G}function Am(n,o,l,f,_,m,E){switch(l){case gi:if(n.byteLength!=o.byteLength||n.byteOffset!=o.byteOffset)return!1;n=n.buffer,o=o.buffer;case tr:return!(n.byteLength!=o.byteLength||!m(new rs(n),new rs(o)));case ye:case oe:case ae:return $e(+n,+o);case Wn:return n.name==o.name&&n.message==o.message;case an:case Xn:return n==o+"";case ve:var w=ta;case qt:var x=f&T;if(w||(w=Jr),n.size!=o.size&&!x)return!1;var M=E.get(n);if(M)return M==o;f|=A,E.set(n,o);var O=hc(w(n),w(o),f,_,m,E);return E.delete(n),O;case Bt:if(or)return or.call(n)==or.call(o)}return!1}function bm(n,o,l,f,_,m){var E=l&T,w=Ta(n),x=w.length,M=Ta(o),O=M.length;if(x!=O&&!E)return!1;for(var P=x;P--;){var G=w[P];if(!(E?G in o:_t.call(o,G)))return!1}var k=m.get(n),V=m.get(o);if(k&&V)return k==o&&V==n;var nt=!0;m.set(n,o),m.set(o,n);for(var H=E;++P<x;){G=w[P];var st=n[G],at=o[G];if(f)var xe=E?f(at,st,G,o,n,m):f(st,at,G,n,o,m);if(!(xe===e?st===at||_(st,at,l,f,m):xe)){nt=!1;break}H||(H=G=="constructor")}if(nt&&!H){var ie=n.constructor,Te=o.constructor;ie!=Te&&"constructor"in n&&"constructor"in o&&!(typeof ie=="function"&&ie instanceof ie&&typeof Te=="function"&&Te instanceof Te)&&(nt=!1)}return m.delete(n),m.delete(o),nt}function fn(n){return Pa(pc(n,e,Tc),n+"")}function Ta(n){return Sh(n,kt,La)}function Ia(n){return Sh(n,ce,cc)}var Aa=hs?function(n){return hs.get(n)}:Za;function xs(n){for(var o=n.name+"",l=Ri[o],f=_t.call(Ri,o)?l.length:0;f--;){var _=l[f],m=_.func;if(m==null||m==n)return _.name}return o}function Ii(n){var o=_t.call(p,"placeholder")?p:n;return o.placeholder}function Y(){var n=p.iteratee||Ba;return n=n===Ba?Ph:n,arguments.length?n(arguments[0],arguments[1]):n}function Ts(n,o){var l=n.__data__;return Nm(o)?l[typeof o=="string"?"string":"hash"]:l.map}function ba(n){for(var o=kt(n),l=o.length;l--;){var f=o[l],_=n[f];o[l]=[f,_,gc(_)]}return o}function $n(n,o){var l=U_(n,o);return Oh(l)?l:e}function Lm(n){var o=_t.call(n,Bn),l=n[Bn];try{n[Bn]=e;var f=!0}catch{}var _=ns.call(n);return f&&(o?n[Bn]=l:delete n[Bn]),_}var La=na?function(n){return n==null?[]:(n=vt(n),xn(na(n),function(o){return mh.call(n,o)}))}:Va,cc=na?function(n){for(var o=[];n;)Tn(o,La(n)),n=ss(n);return o}:Va,Jt=ee;(ia&&Jt(new ia(new ArrayBuffer(1)))!=gi||ir&&Jt(new ir)!=ve||ra&&Jt(ra.resolve())!=kn||wi&&Jt(new wi)!=qt||rr&&Jt(new rr)!=Qi)&&(Jt=function(n){var o=ee(n),l=o==le?n.constructor:e,f=l?qn(l):"";if(f)switch(f){case cp:return gi;case fp:return ve;case dp:return kn;case gp:return qt;case _p:return Qi}return o});function Sm(n,o,l){for(var f=-1,_=l.length;++f<_;){var m=l[f],E=m.size;switch(m.type){case"drop":n+=E;break;case"dropRight":o-=E;break;case"take":o=jt(o,n+E);break;case"takeRight":n=zt(n,o-E);break}}return{start:n,end:o}}function Mm(n){var o=n.match(zg);return o?o[1].split(Gg):[]}function fc(n,o,l){o=Sn(o,n);for(var f=-1,_=o.length,m=!1;++f<_;){var E=rn(o[f]);if(!(m=n!=null&&l(n,E)))break;n=n[E]}return m||++f!=_?m:(_=n==null?0:n.length,!!_&&Os(_)&&dn(E,_)&&(Q(n)||jn(n)))}function Om(n){var o=n.length,l=new n.constructor(o);return o&&typeof n[0]=="string"&&_t.call(n,"index")&&(l.index=n.index,l.input=n.input),l}function dc(n){return typeof n.constructor=="function"&&!dr(n)?Ci(ss(n)):{}}function Pm(n,o,l){var f=n.constructor;switch(o){case tr:return Ra(n);case ye:case oe:return new f(+n);case gi:return pm(n,l);case bo:case Lo:case So:case Mo:case Oo:case Po:case Do:case Fo:case No:return $h(n,l);case ve:return new f;case ae:case Xn:return new f(n);case an:return mm(n);case qt:return new f;case Bt:return ym(n)}}function Dm(n,o){var l=o.length;if(!l)return n;var f=l-1;return o[f]=(l>1?"& ":"")+o[f],o=o.join(l>2?", ":" "),n.replace(Ng,`{
/* [wrapped with `+o+`] */
`)}function Fm(n){return Q(n)||jn(n)||!!(yh&&n&&n[yh])}function dn(n,o){var l=typeof n;return o=o??yt,!!o&&(l=="number"||l!="symbol"&&Vg.test(n))&&n>-1&&n%1==0&&n<o}function ne(n,o,l){if(!It(l))return!1;var f=typeof o;return(f=="number"?he(l)&&dn(o,l.length):f=="string"&&o in l)?$e(l[o],n):!1}function Sa(n,o){if(Q(n))return!1;var l=typeof n;return l=="number"||l=="symbol"||l=="boolean"||n==null||Ce(n)?!0:Og.test(n)||!Mg.test(n)||o!=null&&n in vt(o)}function Nm(n){var o=typeof n;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?n!=="__proto__":n===null}function Ma(n){var o=xs(n),l=p[o];if(typeof l!="function"||!(o in ot.prototype))return!1;if(n===l)return!0;var f=Aa(l);return!!f&&n===f[0]}function zm(n){return!!gh&&gh in n}var Gm=ts?gn:Ha;function dr(n){var o=n&&n.constructor,l=typeof o=="function"&&o.prototype||Ei;return n===l}function gc(n){return n===n&&!It(n)}function _c(n,o){return function(l){return l==null?!1:l[n]===o&&(o!==e||n in vt(l))}}function Um(n){var o=Ss(n,function(f){return l.size===d&&l.clear(),f}),l=o.cache;return o}function Wm(n,o){var l=n[1],f=o[1],_=l|f,m=_<(b|F|K),E=f==K&&l==U||f==K&&l==X&&n[7].length<=o[8]||f==(K|X)&&o[7].length<=o[8]&&l==U;if(!(m||E))return n;f&b&&(n[2]=o[2],_|=l&b?0:z);var w=o[3];if(w){var x=n[3];n[3]=x?jh(x,w,o[4]):w,n[4]=x?In(n[3],g):o[4]}return w=o[5],w&&(x=n[5],n[5]=x?Jh(x,w,o[6]):w,n[6]=x?In(n[5],g):o[6]),w=o[7],w&&(n[7]=w),f&K&&(n[8]=n[8]==null?o[8]:jt(n[8],o[8])),n[9]==null&&(n[9]=o[9]),n[0]=o[0],n[1]=_,n}function km(n){var o=[];if(n!=null)for(var l in vt(n))o.push(l);return o}function Xm(n){return ns.call(n)}function pc(n,o,l){return o=zt(o===e?n.length-1:o,0),function(){for(var f=arguments,_=-1,m=zt(f.length-o,0),E=I(m);++_<m;)E[_]=f[o+_];_=-1;for(var w=I(o+1);++_<o;)w[_]=f[_];return w[o]=l(E),Ee(n,this,w)}}function mc(n,o){return o.length<2?n:Hn(n,Ne(o,0,-1))}function Km(n,o){for(var l=n.length,f=jt(o.length,l),_=ue(n);f--;){var m=o[f];n[f]=dn(m,l)?_[m]:e}return n}function Oa(n,o){if(!(o==="constructor"&&typeof n[o]=="function")&&o!="__proto__")return n[o]}var yc=Ec(kh),gr=rp||function(n,o){return Yt.setTimeout(n,o)},Pa=Ec(fm);function vc(n,o,l){var f=o+"";return Pa(n,Dm(f,Bm(Mm(f),l)))}function Ec(n){var o=0,l=0;return function(){var f=lp(),_=ht-(f-l);if(l=f,_>0){if(++o>=St)return arguments[0]}else o=0;return n.apply(e,arguments)}}function Is(n,o){var l=-1,f=n.length,_=f-1;for(o=o===e?f:o;++l<o;){var m=_a(l,_),E=n[m];n[m]=n[l],n[l]=E}return n.length=o,n}var wc=Um(function(n){var o=[];return n.charCodeAt(0)===46&&o.push(""),n.replace(Pg,function(l,f,_,m){o.push(_?m.replace(kg,"$1"):f||l)}),o});function rn(n){if(typeof n=="string"||Ce(n))return n;var o=n+"";return o=="0"&&1/n==-1/0?"-0":o}function qn(n){if(n!=null){try{return es.call(n)}catch{}try{return n+""}catch{}}return""}function Bm(n,o){return Oe(Ze,function(l){var f="_."+l[0];o&l[1]&&!qr(n,f)&&n.push(f)}),n.sort()}function Rc(n){if(n instanceof ot)return n.clone();var o=new De(n.__wrapped__,n.__chain__);return o.__actions__=ue(n.__actions__),o.__index__=n.__index__,o.__values__=n.__values__,o}function Ym(n,o,l){(l?ne(n,o,l):o===e)?o=1:o=zt(tt(o),0);var f=n==null?0:n.length;if(!f||o<1)return[];for(var _=0,m=0,E=I(ls(f/o));_<f;)E[m++]=Ne(n,_,_+=o);return E}function Zm(n){for(var o=-1,l=n==null?0:n.length,f=0,_=[];++o<l;){var m=n[o];m&&(_[f++]=m)}return _}function Vm(){var n=arguments.length;if(!n)return[];for(var o=I(n-1),l=arguments[0],f=n;f--;)o[f-1]=arguments[f];return Tn(Q(l)?ue(l):[l],Zt(o,1))}var Hm=rt(function(n,o){return Mt(n)?lr(n,Zt(o,1,Mt,!0)):[]}),$m=rt(function(n,o){var l=ze(o);return Mt(l)&&(l=e),Mt(n)?lr(n,Zt(o,1,Mt,!0),Y(l,2)):[]}),qm=rt(function(n,o){var l=ze(o);return Mt(l)&&(l=e),Mt(n)?lr(n,Zt(o,1,Mt,!0),e,l):[]});function jm(n,o,l){var f=n==null?0:n.length;return f?(o=l||o===e?1:tt(o),Ne(n,o<0?0:o,f)):[]}function Jm(n,o,l){var f=n==null?0:n.length;return f?(o=l||o===e?1:tt(o),o=f-o,Ne(n,0,o<0?0:o)):[]}function Qm(n,o){return n&&n.length?ys(n,Y(o,3),!0,!0):[]}function t0(n,o){return n&&n.length?ys(n,Y(o,3),!0):[]}function e0(n,o,l,f){var _=n==null?0:n.length;return _?(l&&typeof l!="number"&&ne(n,o,l)&&(l=0,f=_),Vp(n,o,l,f)):[]}function Cc(n,o,l){var f=n==null?0:n.length;if(!f)return-1;var _=l==null?0:tt(l);return _<0&&(_=zt(f+_,0)),jr(n,Y(o,3),_)}function xc(n,o,l){var f=n==null?0:n.length;if(!f)return-1;var _=f-1;return l!==e&&(_=tt(l),_=l<0?zt(f+_,0):jt(_,f-1)),jr(n,Y(o,3),_,!0)}function Tc(n){var o=n==null?0:n.length;return o?Zt(n,1):[]}function n0(n){var o=n==null?0:n.length;return o?Zt(n,pe):[]}function i0(n,o){var l=n==null?0:n.length;return l?(o=o===e?1:tt(o),Zt(n,o)):[]}function r0(n){for(var o=-1,l=n==null?0:n.length,f={};++o<l;){var _=n[o];f[_[0]]=_[1]}return f}function Ic(n){return n&&n.length?n[0]:e}function s0(n,o,l){var f=n==null?0:n.length;if(!f)return-1;var _=l==null?0:tt(l);return _<0&&(_=zt(f+_,0)),pi(n,o,_)}function o0(n){var o=n==null?0:n.length;return o?Ne(n,0,-1):[]}var a0=rt(function(n){var o=Ct(n,Ea);return o.length&&o[0]===n[0]?ha(o):[]}),l0=rt(function(n){var o=ze(n),l=Ct(n,Ea);return o===ze(l)?o=e:l.pop(),l.length&&l[0]===n[0]?ha(l,Y(o,2)):[]}),u0=rt(function(n){var o=ze(n),l=Ct(n,Ea);return o=typeof o=="function"?o:e,o&&l.pop(),l.length&&l[0]===n[0]?ha(l,e,o):[]});function h0(n,o){return n==null?"":op.call(n,o)}function ze(n){var o=n==null?0:n.length;return o?n[o-1]:e}function c0(n,o,l){var f=n==null?0:n.length;if(!f)return-1;var _=f;return l!==e&&(_=tt(l),_=_<0?zt(f+_,0):jt(_,f-1)),o===o?B_(n,o,_):jr(n,oh,_,!0)}function f0(n,o){return n&&n.length?zh(n,tt(o)):e}var d0=rt(Ac);function Ac(n,o){return n&&n.length&&o&&o.length?ga(n,o):n}function g0(n,o,l){return n&&n.length&&o&&o.length?ga(n,o,Y(l,2)):n}function _0(n,o,l){return n&&n.length&&o&&o.length?ga(n,o,e,l):n}var p0=fn(function(n,o){var l=n==null?0:n.length,f=oa(n,o);return Wh(n,Ct(o,function(_){return dn(_,l)?+_:_}).sort(qh)),f});function m0(n,o){var l=[];if(!(n&&n.length))return l;var f=-1,_=[],m=n.length;for(o=Y(o,3);++f<m;){var E=n[f];o(E,f,n)&&(l.push(E),_.push(f))}return Wh(n,_),l}function Da(n){return n==null?n:hp.call(n)}function y0(n,o,l){var f=n==null?0:n.length;return f?(l&&typeof l!="number"&&ne(n,o,l)?(o=0,l=f):(o=o==null?0:tt(o),l=l===e?f:tt(l)),Ne(n,o,l)):[]}function v0(n,o){return ms(n,o)}function E0(n,o,l){return ma(n,o,Y(l,2))}function w0(n,o){var l=n==null?0:n.length;if(l){var f=ms(n,o);if(f<l&&$e(n[f],o))return f}return-1}function R0(n,o){return ms(n,o,!0)}function C0(n,o,l){return ma(n,o,Y(l,2),!0)}function x0(n,o){var l=n==null?0:n.length;if(l){var f=ms(n,o,!0)-1;if($e(n[f],o))return f}return-1}function T0(n){return n&&n.length?Xh(n):[]}function I0(n,o){return n&&n.length?Xh(n,Y(o,2)):[]}function A0(n){var o=n==null?0:n.length;return o?Ne(n,1,o):[]}function b0(n,o,l){return n&&n.length?(o=l||o===e?1:tt(o),Ne(n,0,o<0?0:o)):[]}function L0(n,o,l){var f=n==null?0:n.length;return f?(o=l||o===e?1:tt(o),o=f-o,Ne(n,o<0?0:o,f)):[]}function S0(n,o){return n&&n.length?ys(n,Y(o,3),!1,!0):[]}function M0(n,o){return n&&n.length?ys(n,Y(o,3)):[]}var O0=rt(function(n){return Ln(Zt(n,1,Mt,!0))}),P0=rt(function(n){var o=ze(n);return Mt(o)&&(o=e),Ln(Zt(n,1,Mt,!0),Y(o,2))}),D0=rt(function(n){var o=ze(n);return o=typeof o=="function"?o:e,Ln(Zt(n,1,Mt,!0),e,o)});function F0(n){return n&&n.length?Ln(n):[]}function N0(n,o){return n&&n.length?Ln(n,Y(o,2)):[]}function z0(n,o){return o=typeof o=="function"?o:e,n&&n.length?Ln(n,e,o):[]}function Fa(n){if(!(n&&n.length))return[];var o=0;return n=xn(n,function(l){if(Mt(l))return o=zt(l.length,o),!0}),Jo(o,function(l){return Ct(n,$o(l))})}function bc(n,o){if(!(n&&n.length))return[];var l=Fa(n);return o==null?l:Ct(l,function(f){return Ee(o,e,f)})}var G0=rt(function(n,o){return Mt(n)?lr(n,o):[]}),U0=rt(function(n){return va(xn(n,Mt))}),W0=rt(function(n){var o=ze(n);return Mt(o)&&(o=e),va(xn(n,Mt),Y(o,2))}),k0=rt(function(n){var o=ze(n);return o=typeof o=="function"?o:e,va(xn(n,Mt),e,o)}),X0=rt(Fa);function K0(n,o){return Zh(n||[],o||[],ar)}function B0(n,o){return Zh(n||[],o||[],cr)}var Y0=rt(function(n){var o=n.length,l=o>1?n[o-1]:e;return l=typeof l=="function"?(n.pop(),l):e,bc(n,l)});function Lc(n){var o=p(n);return o.__chain__=!0,o}function Z0(n,o){return o(n),n}function As(n,o){return o(n)}var V0=fn(function(n){var o=n.length,l=o?n[0]:0,f=this.__wrapped__,_=function(m){return oa(m,n)};return o>1||this.__actions__.length||!(f instanceof ot)||!dn(l)?this.thru(_):(f=f.slice(l,+l+(o?1:0)),f.__actions__.push({func:As,args:[_],thisArg:e}),new De(f,this.__chain__).thru(function(m){return o&&!m.length&&m.push(e),m}))});function H0(){return Lc(this)}function $0(){return new De(this.value(),this.__chain__)}function q0(){this.__values__===e&&(this.__values__=Kc(this.value()));var n=this.__index__>=this.__values__.length,o=n?e:this.__values__[this.__index__++];return{done:n,value:o}}function j0(){return this}function J0(n){for(var o,l=this;l instanceof fs;){var f=Rc(l);f.__index__=0,f.__values__=e,o?_.__wrapped__=f:o=f;var _=f;l=l.__wrapped__}return _.__wrapped__=n,o}function Q0(){var n=this.__wrapped__;if(n instanceof ot){var o=n;return this.__actions__.length&&(o=new ot(this)),o=o.reverse(),o.__actions__.push({func:As,args:[Da],thisArg:e}),new De(o,this.__chain__)}return this.thru(Da)}function ty(){return Yh(this.__wrapped__,this.__actions__)}var ey=vs(function(n,o,l){_t.call(n,l)?++n[l]:hn(n,l,1)});function ny(n,o,l){var f=Q(n)?rh:Zp;return l&&ne(n,o,l)&&(o=e),f(n,Y(o,3))}function iy(n,o){var l=Q(n)?xn:bh;return l(n,Y(o,3))}var ry=nc(Cc),sy=nc(xc);function oy(n,o){return Zt(bs(n,o),1)}function ay(n,o){return Zt(bs(n,o),pe)}function ly(n,o,l){return l=l===e?1:tt(l),Zt(bs(n,o),l)}function Sc(n,o){var l=Q(n)?Oe:bn;return l(n,Y(o,3))}function Mc(n,o){var l=Q(n)?A_:Ah;return l(n,Y(o,3))}var uy=vs(function(n,o,l){_t.call(n,l)?n[l].push(o):hn(n,l,[o])});function hy(n,o,l,f){n=he(n)?n:bi(n),l=l&&!f?tt(l):0;var _=n.length;return l<0&&(l=zt(_+l,0)),Ps(n)?l<=_&&n.indexOf(o,l)>-1:!!_&&pi(n,o,l)>-1}var cy=rt(function(n,o,l){var f=-1,_=typeof o=="function",m=he(n)?I(n.length):[];return bn(n,function(E){m[++f]=_?Ee(o,E,l):ur(E,o,l)}),m}),fy=vs(function(n,o,l){hn(n,l,o)});function bs(n,o){var l=Q(n)?Ct:Dh;return l(n,Y(o,3))}function dy(n,o,l,f){return n==null?[]:(Q(o)||(o=o==null?[]:[o]),l=f?e:l,Q(l)||(l=l==null?[]:[l]),Gh(n,o,l))}var gy=vs(function(n,o,l){n[l?0:1].push(o)},function(){return[[],[]]});function _y(n,o,l){var f=Q(n)?Vo:lh,_=arguments.length<3;return f(n,Y(o,4),l,_,bn)}function py(n,o,l){var f=Q(n)?b_:lh,_=arguments.length<3;return f(n,Y(o,4),l,_,Ah)}function my(n,o){var l=Q(n)?xn:bh;return l(n,Ms(Y(o,3)))}function yy(n){var o=Q(n)?Ch:hm;return o(n)}function vy(n,o,l){(l?ne(n,o,l):o===e)?o=1:o=tt(o);var f=Q(n)?kp:cm;return f(n,o)}function Ey(n){var o=Q(n)?Xp:dm;return o(n)}function wy(n){if(n==null)return 0;if(he(n))return Ps(n)?yi(n):n.length;var o=Jt(n);return o==ve||o==qt?n.size:fa(n).length}function Ry(n,o,l){var f=Q(n)?Ho:gm;return l&&ne(n,o,l)&&(o=e),f(n,Y(o,3))}var Cy=rt(function(n,o){if(n==null)return[];var l=o.length;return l>1&&ne(n,o[0],o[1])?o=[]:l>2&&ne(o[0],o[1],o[2])&&(o=[o[0]]),Gh(n,Zt(o,1),[])}),Ls=ip||function(){return Yt.Date.now()};function xy(n,o){if(typeof o!="function")throw new Pe(u);return n=tt(n),function(){if(--n<1)return o.apply(this,arguments)}}function Oc(n,o,l){return o=l?e:o,o=n&&o==null?n.length:o,cn(n,K,e,e,e,e,o)}function Pc(n,o){var l;if(typeof o!="function")throw new Pe(u);return n=tt(n),function(){return--n>0&&(l=o.apply(this,arguments)),n<=1&&(o=e),l}}var Na=rt(function(n,o,l){var f=b;if(l.length){var _=In(l,Ii(Na));f|=D}return cn(n,f,o,l,_)}),Dc=rt(function(n,o,l){var f=b|F;if(l.length){var _=In(l,Ii(Dc));f|=D}return cn(o,f,n,l,_)});function Fc(n,o,l){o=l?e:o;var f=cn(n,U,e,e,e,e,e,o);return f.placeholder=Fc.placeholder,f}function Nc(n,o,l){o=l?e:o;var f=cn(n,N,e,e,e,e,e,o);return f.placeholder=Nc.placeholder,f}function zc(n,o,l){var f,_,m,E,w,x,M=0,O=!1,P=!1,G=!0;if(typeof n!="function")throw new Pe(u);o=Ge(o)||0,It(l)&&(O=!!l.leading,P="maxWait"in l,m=P?zt(Ge(l.maxWait)||0,o):m,G="trailing"in l?!!l.trailing:G);function k(Ot){var qe=f,pn=_;return f=_=e,M=Ot,E=n.apply(pn,qe),E}function V(Ot){return M=Ot,w=gr(st,o),O?k(Ot):E}function nt(Ot){var qe=Ot-x,pn=Ot-M,nf=o-qe;return P?jt(nf,m-pn):nf}function H(Ot){var qe=Ot-x,pn=Ot-M;return x===e||qe>=o||qe<0||P&&pn>=m}function st(){var Ot=Ls();if(H(Ot))return at(Ot);w=gr(st,nt(Ot))}function at(Ot){return w=e,G&&f?k(Ot):(f=_=e,E)}function xe(){w!==e&&Vh(w),M=0,f=x=_=w=e}function ie(){return w===e?E:at(Ls())}function Te(){var Ot=Ls(),qe=H(Ot);if(f=arguments,_=this,x=Ot,qe){if(w===e)return V(x);if(P)return Vh(w),w=gr(st,o),k(x)}return w===e&&(w=gr(st,o)),E}return Te.cancel=xe,Te.flush=ie,Te}var Ty=rt(function(n,o){return Ih(n,1,o)}),Iy=rt(function(n,o,l){return Ih(n,Ge(o)||0,l)});function Ay(n){return cn(n,$)}function Ss(n,o){if(typeof n!="function"||o!=null&&typeof o!="function")throw new Pe(u);var l=function(){var f=arguments,_=o?o.apply(this,f):f[0],m=l.cache;if(m.has(_))return m.get(_);var E=n.apply(this,f);return l.cache=m.set(_,E)||m,E};return l.cache=new(Ss.Cache||un),l}Ss.Cache=un;function Ms(n){if(typeof n!="function")throw new Pe(u);return function(){var o=arguments;switch(o.length){case 0:return!n.call(this);case 1:return!n.call(this,o[0]);case 2:return!n.call(this,o[0],o[1]);case 3:return!n.call(this,o[0],o[1],o[2])}return!n.apply(this,o)}}function by(n){return Pc(2,n)}var Ly=_m(function(n,o){o=o.length==1&&Q(o[0])?Ct(o[0],we(Y())):Ct(Zt(o,1),we(Y()));var l=o.length;return rt(function(f){for(var _=-1,m=jt(f.length,l);++_<m;)f[_]=o[_].call(this,f[_]);return Ee(n,this,f)})}),za=rt(function(n,o){var l=In(o,Ii(za));return cn(n,D,e,o,l)}),Gc=rt(function(n,o){var l=In(o,Ii(Gc));return cn(n,Z,e,o,l)}),Sy=fn(function(n,o){return cn(n,X,e,e,e,o)});function My(n,o){if(typeof n!="function")throw new Pe(u);return o=o===e?o:tt(o),rt(n,o)}function Oy(n,o){if(typeof n!="function")throw new Pe(u);return o=o==null?0:zt(tt(o),0),rt(function(l){var f=l[o],_=Mn(l,0,o);return f&&Tn(_,f),Ee(n,this,_)})}function Py(n,o,l){var f=!0,_=!0;if(typeof n!="function")throw new Pe(u);return It(l)&&(f="leading"in l?!!l.leading:f,_="trailing"in l?!!l.trailing:_),zc(n,o,{leading:f,maxWait:o,trailing:_})}function Dy(n){return Oc(n,1)}function Fy(n,o){return za(wa(o),n)}function Ny(){if(!arguments.length)return[];var n=arguments[0];return Q(n)?n:[n]}function zy(n){return Fe(n,C)}function Gy(n,o){return o=typeof o=="function"?o:e,Fe(n,C,o)}function Uy(n){return Fe(n,y|C)}function Wy(n,o){return o=typeof o=="function"?o:e,Fe(n,y|C,o)}function ky(n,o){return o==null||Th(n,o,kt(o))}function $e(n,o){return n===o||n!==n&&o!==o}var Xy=Cs(ua),Ky=Cs(function(n,o){return n>=o}),jn=Mh(function(){return arguments}())?Mh:function(n){return bt(n)&&_t.call(n,"callee")&&!mh.call(n,"callee")},Q=I.isArray,By=Ju?we(Ju):Jp;function he(n){return n!=null&&Os(n.length)&&!gn(n)}function Mt(n){return bt(n)&&he(n)}function Yy(n){return n===!0||n===!1||bt(n)&&ee(n)==ye}var On=sp||Ha,Zy=Qu?we(Qu):Qp;function Vy(n){return bt(n)&&n.nodeType===1&&!_r(n)}function Hy(n){if(n==null)return!0;if(he(n)&&(Q(n)||typeof n=="string"||typeof n.splice=="function"||On(n)||Ai(n)||jn(n)))return!n.length;var o=Jt(n);if(o==ve||o==qt)return!n.size;if(dr(n))return!fa(n).length;for(var l in n)if(_t.call(n,l))return!1;return!0}function $y(n,o){return hr(n,o)}function qy(n,o,l){l=typeof l=="function"?l:e;var f=l?l(n,o):e;return f===e?hr(n,o,e,l):!!f}function Ga(n){if(!bt(n))return!1;var o=ee(n);return o==Wn||o==Se||typeof n.message=="string"&&typeof n.name=="string"&&!_r(n)}function jy(n){return typeof n=="number"&&vh(n)}function gn(n){if(!It(n))return!1;var o=ee(n);return o==di||o==Ji||o==$t||o==Zr}function Uc(n){return typeof n=="number"&&n==tt(n)}function Os(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=yt}function It(n){var o=typeof n;return n!=null&&(o=="object"||o=="function")}function bt(n){return n!=null&&typeof n=="object"}var Wc=th?we(th):em;function Jy(n,o){return n===o||ca(n,o,ba(o))}function Qy(n,o,l){return l=typeof l=="function"?l:e,ca(n,o,ba(o),l)}function tv(n){return kc(n)&&n!=+n}function ev(n){if(Gm(n))throw new J(a);return Oh(n)}function nv(n){return n===null}function iv(n){return n==null}function kc(n){return typeof n=="number"||bt(n)&&ee(n)==ae}function _r(n){if(!bt(n)||ee(n)!=le)return!1;var o=ss(n);if(o===null)return!0;var l=_t.call(o,"constructor")&&o.constructor;return typeof l=="function"&&l instanceof l&&es.call(l)==Q_}var Ua=eh?we(eh):nm;function rv(n){return Uc(n)&&n>=-9007199254740991&&n<=yt}var Xc=nh?we(nh):im;function Ps(n){return typeof n=="string"||!Q(n)&&bt(n)&&ee(n)==Xn}function Ce(n){return typeof n=="symbol"||bt(n)&&ee(n)==Bt}var Ai=ih?we(ih):rm;function sv(n){return n===e}function ov(n){return bt(n)&&Jt(n)==Qi}function av(n){return bt(n)&&ee(n)==Cg}var lv=Cs(da),uv=Cs(function(n,o){return n<=o});function Kc(n){if(!n)return[];if(he(n))return Ps(n)?Ve(n):ue(n);if(nr&&n[nr])return k_(n[nr]());var o=Jt(n),l=o==ve?ta:o==qt?Jr:bi;return l(n)}function _n(n){if(!n)return n===0?n:0;if(n=Ge(n),n===pe||n===-1/0){var o=n<0?-1:1;return o*At}return n===n?n:0}function tt(n){var o=_n(n),l=o%1;return o===o?l?o-l:o:0}function Bc(n){return n?Vn(tt(n),0,Wt):0}function Ge(n){if(typeof n=="number")return n;if(Ce(n))return Xt;if(It(n)){var o=typeof n.valueOf=="function"?n.valueOf():n;n=It(o)?o+"":o}if(typeof n!="string")return n===0?n:+n;n=uh(n);var l=Bg.test(n);return l||Zg.test(n)?x_(n.slice(2),l?2:8):Kg.test(n)?Xt:+n}function Yc(n){return nn(n,ce(n))}function hv(n){return n?Vn(tt(n),-9007199254740991,yt):n===0?n:0}function gt(n){return n==null?"":Re(n)}var cv=xi(function(n,o){if(dr(o)||he(o)){nn(o,kt(o),n);return}for(var l in o)_t.call(o,l)&&ar(n,l,o[l])}),Zc=xi(function(n,o){nn(o,ce(o),n)}),Ds=xi(function(n,o,l,f){nn(o,ce(o),n,f)}),fv=xi(function(n,o,l,f){nn(o,kt(o),n,f)}),dv=fn(oa);function gv(n,o){var l=Ci(n);return o==null?l:xh(l,o)}var _v=rt(function(n,o){n=vt(n);var l=-1,f=o.length,_=f>2?o[2]:e;for(_&&ne(o[0],o[1],_)&&(f=1);++l<f;)for(var m=o[l],E=ce(m),w=-1,x=E.length;++w<x;){var M=E[w],O=n[M];(O===e||$e(O,Ei[M])&&!_t.call(n,M))&&(n[M]=m[M])}return n}),pv=rt(function(n){return n.push(e,uc),Ee(Vc,e,n)});function mv(n,o){return sh(n,Y(o,3),en)}function yv(n,o){return sh(n,Y(o,3),la)}function vv(n,o){return n==null?n:aa(n,Y(o,3),ce)}function Ev(n,o){return n==null?n:Lh(n,Y(o,3),ce)}function wv(n,o){return n&&en(n,Y(o,3))}function Rv(n,o){return n&&la(n,Y(o,3))}function Cv(n){return n==null?[]:_s(n,kt(n))}function xv(n){return n==null?[]:_s(n,ce(n))}function Wa(n,o,l){var f=n==null?e:Hn(n,o);return f===e?l:f}function Tv(n,o){return n!=null&&fc(n,o,Hp)}function ka(n,o){return n!=null&&fc(n,o,$p)}var Iv=rc(function(n,o,l){o!=null&&typeof o.toString!="function"&&(o=ns.call(o)),n[o]=l},Ka(fe)),Av=rc(function(n,o,l){o!=null&&typeof o.toString!="function"&&(o=ns.call(o)),_t.call(n,o)?n[o].push(l):n[o]=[l]},Y),bv=rt(ur);function kt(n){return he(n)?Rh(n):fa(n)}function ce(n){return he(n)?Rh(n,!0):sm(n)}function Lv(n,o){var l={};return o=Y(o,3),en(n,function(f,_,m){hn(l,o(f,_,m),f)}),l}function Sv(n,o){var l={};return o=Y(o,3),en(n,function(f,_,m){hn(l,_,o(f,_,m))}),l}var Mv=xi(function(n,o,l){ps(n,o,l)}),Vc=xi(function(n,o,l,f){ps(n,o,l,f)}),Ov=fn(function(n,o){var l={};if(n==null)return l;var f=!1;o=Ct(o,function(m){return m=Sn(m,n),f||(f=m.length>1),m}),nn(n,Ia(n),l),f&&(l=Fe(l,y|v|C,Im));for(var _=o.length;_--;)ya(l,o[_]);return l});function Pv(n,o){return Hc(n,Ms(Y(o)))}var Dv=fn(function(n,o){return n==null?{}:am(n,o)});function Hc(n,o){if(n==null)return{};var l=Ct(Ia(n),function(f){return[f]});return o=Y(o),Uh(n,l,function(f,_){return o(f,_[0])})}function Fv(n,o,l){o=Sn(o,n);var f=-1,_=o.length;for(_||(_=1,n=e);++f<_;){var m=n==null?e:n[rn(o[f])];m===e&&(f=_,m=l),n=gn(m)?m.call(n):m}return n}function Nv(n,o,l){return n==null?n:cr(n,o,l)}function zv(n,o,l,f){return f=typeof f=="function"?f:e,n==null?n:cr(n,o,l,f)}var $c=ac(kt),qc=ac(ce);function Gv(n,o,l){var f=Q(n),_=f||On(n)||Ai(n);if(o=Y(o,4),l==null){var m=n&&n.constructor;_?l=f?new m:[]:It(n)?l=gn(m)?Ci(ss(n)):{}:l={}}return(_?Oe:en)(n,function(E,w,x){return o(l,E,w,x)}),l}function Uv(n,o){return n==null?!0:ya(n,o)}function Wv(n,o,l){return n==null?n:Bh(n,o,wa(l))}function kv(n,o,l,f){return f=typeof f=="function"?f:e,n==null?n:Bh(n,o,wa(l),f)}function bi(n){return n==null?[]:Qo(n,kt(n))}function Xv(n){return n==null?[]:Qo(n,ce(n))}function Kv(n,o,l){return l===e&&(l=o,o=e),l!==e&&(l=Ge(l),l=l===l?l:0),o!==e&&(o=Ge(o),o=o===o?o:0),Vn(Ge(n),o,l)}function Bv(n,o,l){return o=_n(o),l===e?(l=o,o=0):l=_n(l),n=Ge(n),qp(n,o,l)}function Yv(n,o,l){if(l&&typeof l!="boolean"&&ne(n,o,l)&&(o=l=e),l===e&&(typeof o=="boolean"?(l=o,o=e):typeof n=="boolean"&&(l=n,n=e)),n===e&&o===e?(n=0,o=1):(n=_n(n),o===e?(o=n,n=0):o=_n(o)),n>o){var f=n;n=o,o=f}if(l||n%1||o%1){var _=Eh();return jt(n+_*(o-n+C_("1e-"+((_+"").length-1))),o)}return _a(n,o)}var Zv=Ti(function(n,o,l){return o=o.toLowerCase(),n+(l?jc(o):o)});function jc(n){return Xa(gt(n).toLowerCase())}function Jc(n){return n=gt(n),n&&n.replace(Hg,N_).replace(d_,"")}function Vv(n,o,l){n=gt(n),o=Re(o);var f=n.length;l=l===e?f:Vn(tt(l),0,f);var _=l;return l-=o.length,l>=0&&n.slice(l,_)==o}function Hv(n){return n=gt(n),n&&bg.test(n)?n.replace(Lu,z_):n}function $v(n){return n=gt(n),n&&Dg.test(n)?n.replace(zo,"\\$&"):n}var qv=Ti(function(n,o,l){return n+(l?"-":"")+o.toLowerCase()}),jv=Ti(function(n,o,l){return n+(l?" ":"")+o.toLowerCase()}),Jv=ec("toLowerCase");function Qv(n,o,l){n=gt(n),o=tt(o);var f=o?yi(n):0;if(!o||f>=o)return n;var _=(o-f)/2;return Rs(us(_),l)+n+Rs(ls(_),l)}function t1(n,o,l){n=gt(n),o=tt(o);var f=o?yi(n):0;return o&&f<o?n+Rs(o-f,l):n}function e1(n,o,l){n=gt(n),o=tt(o);var f=o?yi(n):0;return o&&f<o?Rs(o-f,l)+n:n}function n1(n,o,l){return l||o==null?o=0:o&&(o=+o),up(gt(n).replace(Go,""),o||0)}function i1(n,o,l){return(l?ne(n,o,l):o===e)?o=1:o=tt(o),pa(gt(n),o)}function r1(){var n=arguments,o=gt(n[0]);return n.length<3?o:o.replace(n[1],n[2])}var s1=Ti(function(n,o,l){return n+(l?"_":"")+o.toLowerCase()});function o1(n,o,l){return l&&typeof l!="number"&&ne(n,o,l)&&(o=l=e),l=l===e?Wt:l>>>0,l?(n=gt(n),n&&(typeof o=="string"||o!=null&&!Ua(o))&&(o=Re(o),!o&&mi(n))?Mn(Ve(n),0,l):n.split(o,l)):[]}var a1=Ti(function(n,o,l){return n+(l?" ":"")+Xa(o)});function l1(n,o,l){return n=gt(n),l=l==null?0:Vn(tt(l),0,n.length),o=Re(o),n.slice(l,l+o.length)==o}function u1(n,o,l){var f=p.templateSettings;l&&ne(n,o,l)&&(o=e),n=gt(n),o=Ds({},o,f,lc);var _=Ds({},o.imports,f.imports,lc),m=kt(_),E=Qo(_,m),w,x,M=0,O=o.interpolate||Vr,P="__p += '",G=ea((o.escape||Vr).source+"|"+O.source+"|"+(O===Su?Xg:Vr).source+"|"+(o.evaluate||Vr).source+"|$","g"),k="//# sourceURL="+(_t.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++y_+"]")+`
`;n.replace(G,function(H,st,at,xe,ie,Te){return at||(at=xe),P+=n.slice(M,Te).replace($g,G_),st&&(w=!0,P+=`' +
__e(`+st+`) +
'`),ie&&(x=!0,P+=`';
`+ie+`;
__p += '`),at&&(P+=`' +
((__t = (`+at+`)) == null ? '' : __t) +
'`),M=Te+H.length,H}),P+=`';
`;var V=_t.call(o,"variable")&&o.variable;if(!V)P=`with (obj) {
`+P+`
}
`;else if(Wg.test(V))throw new J(h);P=(x?P.replace(xg,""):P).replace(Tg,"$1").replace(Ig,"$1;"),P="function("+(V||"obj")+`) {
`+(V?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(w?", __e = _.escape":"")+(x?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+P+`return __p
}`;var nt=tf(function(){return ft(m,k+"return "+P).apply(e,E)});if(nt.source=P,Ga(nt))throw nt;return nt}function h1(n){return gt(n).toLowerCase()}function c1(n){return gt(n).toUpperCase()}function f1(n,o,l){if(n=gt(n),n&&(l||o===e))return uh(n);if(!n||!(o=Re(o)))return n;var f=Ve(n),_=Ve(o),m=hh(f,_),E=ch(f,_)+1;return Mn(f,m,E).join("")}function d1(n,o,l){if(n=gt(n),n&&(l||o===e))return n.slice(0,dh(n)+1);if(!n||!(o=Re(o)))return n;var f=Ve(n),_=ch(f,Ve(o))+1;return Mn(f,0,_).join("")}function g1(n,o,l){if(n=gt(n),n&&(l||o===e))return n.replace(Go,"");if(!n||!(o=Re(o)))return n;var f=Ve(n),_=hh(f,Ve(o));return Mn(f,_).join("")}function _1(n,o){var l=j,f=Lt;if(It(o)){var _="separator"in o?o.separator:_;l="length"in o?tt(o.length):l,f="omission"in o?Re(o.omission):f}n=gt(n);var m=n.length;if(mi(n)){var E=Ve(n);m=E.length}if(l>=m)return n;var w=l-yi(f);if(w<1)return f;var x=E?Mn(E,0,w).join(""):n.slice(0,w);if(_===e)return x+f;if(E&&(w+=x.length-w),Ua(_)){if(n.slice(w).search(_)){var M,O=x;for(_.global||(_=ea(_.source,gt(Mu.exec(_))+"g")),_.lastIndex=0;M=_.exec(O);)var P=M.index;x=x.slice(0,P===e?w:P)}}else if(n.indexOf(Re(_),w)!=w){var G=x.lastIndexOf(_);G>-1&&(x=x.slice(0,G))}return x+f}function p1(n){return n=gt(n),n&&Ag.test(n)?n.replace(bu,Y_):n}var m1=Ti(function(n,o,l){return n+(l?" ":"")+o.toUpperCase()}),Xa=ec("toUpperCase");function Qc(n,o,l){return n=gt(n),o=l?e:o,o===e?W_(n)?H_(n):M_(n):n.match(o)||[]}var tf=rt(function(n,o){try{return Ee(n,e,o)}catch(l){return Ga(l)?l:new J(l)}}),y1=fn(function(n,o){return Oe(o,function(l){l=rn(l),hn(n,l,Na(n[l],n))}),n});function v1(n){var o=n==null?0:n.length,l=Y();return n=o?Ct(n,function(f){if(typeof f[1]!="function")throw new Pe(u);return[l(f[0]),f[1]]}):[],rt(function(f){for(var _=-1;++_<o;){var m=n[_];if(Ee(m[0],this,f))return Ee(m[1],this,f)}})}function E1(n){return Yp(Fe(n,y))}function Ka(n){return function(){return n}}function w1(n,o){return n==null||n!==n?o:n}var R1=ic(),C1=ic(!0);function fe(n){return n}function Ba(n){return Ph(typeof n=="function"?n:Fe(n,y))}function x1(n){return Fh(Fe(n,y))}function T1(n,o){return Nh(n,Fe(o,y))}var I1=rt(function(n,o){return function(l){return ur(l,n,o)}}),A1=rt(function(n,o){return function(l){return ur(n,l,o)}});function Ya(n,o,l){var f=kt(o),_=_s(o,f);l==null&&!(It(o)&&(_.length||!f.length))&&(l=o,o=n,n=this,_=_s(o,kt(o)));var m=!(It(l)&&"chain"in l)||!!l.chain,E=gn(n);return Oe(_,function(w){var x=o[w];n[w]=x,E&&(n.prototype[w]=function(){var M=this.__chain__;if(m||M){var O=n(this.__wrapped__),P=O.__actions__=ue(this.__actions__);return P.push({func:x,args:arguments,thisArg:n}),O.__chain__=M,O}return x.apply(n,Tn([this.value()],arguments))})}),n}function b1(){return Yt._===this&&(Yt._=tp),this}function Za(){}function L1(n){return n=tt(n),rt(function(o){return zh(o,n)})}var S1=Ca(Ct),M1=Ca(rh),O1=Ca(Ho);function ef(n){return Sa(n)?$o(rn(n)):lm(n)}function P1(n){return function(o){return n==null?e:Hn(n,o)}}var D1=sc(),F1=sc(!0);function Va(){return[]}function Ha(){return!1}function N1(){return{}}function z1(){return""}function G1(){return!0}function U1(n,o){if(n=tt(n),n<1||n>yt)return[];var l=Wt,f=jt(n,Wt);o=Y(o),n-=Wt;for(var _=Jo(f,o);++l<n;)o(l);return _}function W1(n){return Q(n)?Ct(n,rn):Ce(n)?[n]:ue(wc(gt(n)))}function k1(n){var o=++J_;return gt(n)+o}var X1=ws(function(n,o){return n+o},0),K1=xa("ceil"),B1=ws(function(n,o){return n/o},1),Y1=xa("floor");function Z1(n){return n&&n.length?gs(n,fe,ua):e}function V1(n,o){return n&&n.length?gs(n,Y(o,2),ua):e}function H1(n){return ah(n,fe)}function $1(n,o){return ah(n,Y(o,2))}function q1(n){return n&&n.length?gs(n,fe,da):e}function j1(n,o){return n&&n.length?gs(n,Y(o,2),da):e}var J1=ws(function(n,o){return n*o},1),Q1=xa("round"),tE=ws(function(n,o){return n-o},0);function eE(n){return n&&n.length?jo(n,fe):0}function nE(n,o){return n&&n.length?jo(n,Y(o,2)):0}return p.after=xy,p.ary=Oc,p.assign=cv,p.assignIn=Zc,p.assignInWith=Ds,p.assignWith=fv,p.at=dv,p.before=Pc,p.bind=Na,p.bindAll=y1,p.bindKey=Dc,p.castArray=Ny,p.chain=Lc,p.chunk=Ym,p.compact=Zm,p.concat=Vm,p.cond=v1,p.conforms=E1,p.constant=Ka,p.countBy=ey,p.create=gv,p.curry=Fc,p.curryRight=Nc,p.debounce=zc,p.defaults=_v,p.defaultsDeep=pv,p.defer=Ty,p.delay=Iy,p.difference=Hm,p.differenceBy=$m,p.differenceWith=qm,p.drop=jm,p.dropRight=Jm,p.dropRightWhile=Qm,p.dropWhile=t0,p.fill=e0,p.filter=iy,p.flatMap=oy,p.flatMapDeep=ay,p.flatMapDepth=ly,p.flatten=Tc,p.flattenDeep=n0,p.flattenDepth=i0,p.flip=Ay,p.flow=R1,p.flowRight=C1,p.fromPairs=r0,p.functions=Cv,p.functionsIn=xv,p.groupBy=uy,p.initial=o0,p.intersection=a0,p.intersectionBy=l0,p.intersectionWith=u0,p.invert=Iv,p.invertBy=Av,p.invokeMap=cy,p.iteratee=Ba,p.keyBy=fy,p.keys=kt,p.keysIn=ce,p.map=bs,p.mapKeys=Lv,p.mapValues=Sv,p.matches=x1,p.matchesProperty=T1,p.memoize=Ss,p.merge=Mv,p.mergeWith=Vc,p.method=I1,p.methodOf=A1,p.mixin=Ya,p.negate=Ms,p.nthArg=L1,p.omit=Ov,p.omitBy=Pv,p.once=by,p.orderBy=dy,p.over=S1,p.overArgs=Ly,p.overEvery=M1,p.overSome=O1,p.partial=za,p.partialRight=Gc,p.partition=gy,p.pick=Dv,p.pickBy=Hc,p.property=ef,p.propertyOf=P1,p.pull=d0,p.pullAll=Ac,p.pullAllBy=g0,p.pullAllWith=_0,p.pullAt=p0,p.range=D1,p.rangeRight=F1,p.rearg=Sy,p.reject=my,p.remove=m0,p.rest=My,p.reverse=Da,p.sampleSize=vy,p.set=Nv,p.setWith=zv,p.shuffle=Ey,p.slice=y0,p.sortBy=Cy,p.sortedUniq=T0,p.sortedUniqBy=I0,p.split=o1,p.spread=Oy,p.tail=A0,p.take=b0,p.takeRight=L0,p.takeRightWhile=S0,p.takeWhile=M0,p.tap=Z0,p.throttle=Py,p.thru=As,p.toArray=Kc,p.toPairs=$c,p.toPairsIn=qc,p.toPath=W1,p.toPlainObject=Yc,p.transform=Gv,p.unary=Dy,p.union=O0,p.unionBy=P0,p.unionWith=D0,p.uniq=F0,p.uniqBy=N0,p.uniqWith=z0,p.unset=Uv,p.unzip=Fa,p.unzipWith=bc,p.update=Wv,p.updateWith=kv,p.values=bi,p.valuesIn=Xv,p.without=G0,p.words=Qc,p.wrap=Fy,p.xor=U0,p.xorBy=W0,p.xorWith=k0,p.zip=X0,p.zipObject=K0,p.zipObjectDeep=B0,p.zipWith=Y0,p.entries=$c,p.entriesIn=qc,p.extend=Zc,p.extendWith=Ds,Ya(p,p),p.add=X1,p.attempt=tf,p.camelCase=Zv,p.capitalize=jc,p.ceil=K1,p.clamp=Kv,p.clone=zy,p.cloneDeep=Uy,p.cloneDeepWith=Wy,p.cloneWith=Gy,p.conformsTo=ky,p.deburr=Jc,p.defaultTo=w1,p.divide=B1,p.endsWith=Vv,p.eq=$e,p.escape=Hv,p.escapeRegExp=$v,p.every=ny,p.find=ry,p.findIndex=Cc,p.findKey=mv,p.findLast=sy,p.findLastIndex=xc,p.findLastKey=yv,p.floor=Y1,p.forEach=Sc,p.forEachRight=Mc,p.forIn=vv,p.forInRight=Ev,p.forOwn=wv,p.forOwnRight=Rv,p.get=Wa,p.gt=Xy,p.gte=Ky,p.has=Tv,p.hasIn=ka,p.head=Ic,p.identity=fe,p.includes=hy,p.indexOf=s0,p.inRange=Bv,p.invoke=bv,p.isArguments=jn,p.isArray=Q,p.isArrayBuffer=By,p.isArrayLike=he,p.isArrayLikeObject=Mt,p.isBoolean=Yy,p.isBuffer=On,p.isDate=Zy,p.isElement=Vy,p.isEmpty=Hy,p.isEqual=$y,p.isEqualWith=qy,p.isError=Ga,p.isFinite=jy,p.isFunction=gn,p.isInteger=Uc,p.isLength=Os,p.isMap=Wc,p.isMatch=Jy,p.isMatchWith=Qy,p.isNaN=tv,p.isNative=ev,p.isNil=iv,p.isNull=nv,p.isNumber=kc,p.isObject=It,p.isObjectLike=bt,p.isPlainObject=_r,p.isRegExp=Ua,p.isSafeInteger=rv,p.isSet=Xc,p.isString=Ps,p.isSymbol=Ce,p.isTypedArray=Ai,p.isUndefined=sv,p.isWeakMap=ov,p.isWeakSet=av,p.join=h0,p.kebabCase=qv,p.last=ze,p.lastIndexOf=c0,p.lowerCase=jv,p.lowerFirst=Jv,p.lt=lv,p.lte=uv,p.max=Z1,p.maxBy=V1,p.mean=H1,p.meanBy=$1,p.min=q1,p.minBy=j1,p.stubArray=Va,p.stubFalse=Ha,p.stubObject=N1,p.stubString=z1,p.stubTrue=G1,p.multiply=J1,p.nth=f0,p.noConflict=b1,p.noop=Za,p.now=Ls,p.pad=Qv,p.padEnd=t1,p.padStart=e1,p.parseInt=n1,p.random=Yv,p.reduce=_y,p.reduceRight=py,p.repeat=i1,p.replace=r1,p.result=Fv,p.round=Q1,p.runInContext=R,p.sample=yy,p.size=wy,p.snakeCase=s1,p.some=Ry,p.sortedIndex=v0,p.sortedIndexBy=E0,p.sortedIndexOf=w0,p.sortedLastIndex=R0,p.sortedLastIndexBy=C0,p.sortedLastIndexOf=x0,p.startCase=a1,p.startsWith=l1,p.subtract=tE,p.sum=eE,p.sumBy=nE,p.template=u1,p.times=U1,p.toFinite=_n,p.toInteger=tt,p.toLength=Bc,p.toLower=h1,p.toNumber=Ge,p.toSafeInteger=hv,p.toString=gt,p.toUpper=c1,p.trim=f1,p.trimEnd=d1,p.trimStart=g1,p.truncate=_1,p.unescape=p1,p.uniqueId=k1,p.upperCase=m1,p.upperFirst=Xa,p.each=Sc,p.eachRight=Mc,p.first=Ic,Ya(p,function(){var n={};return en(p,function(o,l){_t.call(p.prototype,l)||(n[l]=o)}),n}(),{chain:!1}),p.VERSION=r,Oe(["bind","bindKey","curry","curryRight","partial","partialRight"],function(n){p[n].placeholder=p}),Oe(["drop","take"],function(n,o){ot.prototype[n]=function(l){l=l===e?1:zt(tt(l),0);var f=this.__filtered__&&!o?new ot(this):this.clone();return f.__filtered__?f.__takeCount__=jt(l,f.__takeCount__):f.__views__.push({size:jt(l,Wt),type:n+(f.__dir__<0?"Right":"")}),f},ot.prototype[n+"Right"]=function(l){return this.reverse()[n](l).reverse()}}),Oe(["filter","map","takeWhile"],function(n,o){var l=o+1,f=l==Ut||l==Ye;ot.prototype[n]=function(_){var m=this.clone();return m.__iteratees__.push({iteratee:Y(_,3),type:l}),m.__filtered__=m.__filtered__||f,m}}),Oe(["head","last"],function(n,o){var l="take"+(o?"Right":"");ot.prototype[n]=function(){return this[l](1).value()[0]}}),Oe(["initial","tail"],function(n,o){var l="drop"+(o?"":"Right");ot.prototype[n]=function(){return this.__filtered__?new ot(this):this[l](1)}}),ot.prototype.compact=function(){return this.filter(fe)},ot.prototype.find=function(n){return this.filter(n).head()},ot.prototype.findLast=function(n){return this.reverse().find(n)},ot.prototype.invokeMap=rt(function(n,o){return typeof n=="function"?new ot(this):this.map(function(l){return ur(l,n,o)})}),ot.prototype.reject=function(n){return this.filter(Ms(Y(n)))},ot.prototype.slice=function(n,o){n=tt(n);var l=this;return l.__filtered__&&(n>0||o<0)?new ot(l):(n<0?l=l.takeRight(-n):n&&(l=l.drop(n)),o!==e&&(o=tt(o),l=o<0?l.dropRight(-o):l.take(o-n)),l)},ot.prototype.takeRightWhile=function(n){return this.reverse().takeWhile(n).reverse()},ot.prototype.toArray=function(){return this.take(Wt)},en(ot.prototype,function(n,o){var l=/^(?:filter|find|map|reject)|While$/.test(o),f=/^(?:head|last)$/.test(o),_=p[f?"take"+(o=="last"?"Right":""):o],m=f||/^find/.test(o);_&&(p.prototype[o]=function(){var E=this.__wrapped__,w=f?[1]:arguments,x=E instanceof ot,M=w[0],O=x||Q(E),P=function(st){var at=_.apply(p,Tn([st],w));return f&&G?at[0]:at};O&&l&&typeof M=="function"&&M.length!=1&&(x=O=!1);var G=this.__chain__,k=!!this.__actions__.length,V=m&&!G,nt=x&&!k;if(!m&&O){E=nt?E:new ot(this);var H=n.apply(E,w);return H.__actions__.push({func:As,args:[P],thisArg:e}),new De(H,G)}return V&&nt?n.apply(this,w):(H=this.thru(P),V?f?H.value()[0]:H.value():H)})}),Oe(["pop","push","shift","sort","splice","unshift"],function(n){var o=Qr[n],l=/^(?:push|sort|unshift)$/.test(n)?"tap":"thru",f=/^(?:pop|shift)$/.test(n);p.prototype[n]=function(){var _=arguments;if(f&&!this.__chain__){var m=this.value();return o.apply(Q(m)?m:[],_)}return this[l](function(E){return o.apply(Q(E)?E:[],_)})}}),en(ot.prototype,function(n,o){var l=p[o];if(l){var f=l.name+"";_t.call(Ri,f)||(Ri[f]=[]),Ri[f].push({name:o,func:l})}}),Ri[Es(e,F).name]=[{name:"wrapper",func:e}],ot.prototype.clone=pp,ot.prototype.reverse=mp,ot.prototype.value=yp,p.prototype.at=V0,p.prototype.chain=H0,p.prototype.commit=$0,p.prototype.next=q0,p.prototype.plant=J0,p.prototype.reverse=Q0,p.prototype.toJSON=p.prototype.valueOf=p.prototype.value=ty,p.prototype.first=p.prototype.head,nr&&(p.prototype[nr]=j0),p},vi=$_();Kn?((Kn.exports=vi)._=vi,Bo._=vi):Yt._=vi}).call(sE)}(wr,wr.exports)),wr.exports}var ti=oE();const We={ADD:"add",REMOVE:"remove"},Lr={PROPERTYCHANGE:"propertychange"},it={CHANGE:"change",ERROR:"error",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",TOUCHMOVE:"touchmove",WHEEL:"wheel"};class uo{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Wx(i,t,e){let r,s;e=e||Fr;let a=0,u=i.length,h=!1;for(;a<u;)r=a+(u-a>>1),s=+e(i[r],t),s<0?a=r+1:(u=r,h=!s);return h?a:~a}function Fr(i,t){return i>t?1:i<t?-1:0}function kx(i,t){return i<t?1:i>t?-1:0}function Kl(i,t,e){if(i[0]<=t)return 0;const r=i.length;if(t<=i[r-1])return r-1;if(typeof e=="function"){for(let s=1;s<r;++s){const a=i[s];if(a===t)return s;if(a<t)return e(t,i[s-1],a)>0?s-1:s}return r-1}if(e>0){for(let s=1;s<r;++s)if(i[s]<t)return s-1;return r-1}if(e<0){for(let s=1;s<r;++s)if(i[s]<=t)return s;return r-1}for(let s=1;s<r;++s){if(i[s]==t)return s;if(i[s]<t)return i[s-1]-t<t-i[s]?s-1:s}return r-1}function Xx(i,t,e){for(;t<e;){const r=i[t];i[t]=i[e],i[e]=r,++t,--e}}function aE(i,t){const e=Array.isArray(t)?t:[t],r=e.length;for(let s=0;s<r;s++)i[i.length]=e[s]}function ho(i,t){const e=i.length;if(e!==t.length)return!1;for(let r=0;r<e;r++)if(i[r]!==t[r])return!1;return!0}function lE(i,t,e){const r=t||Fr;return i.every(function(s,a){if(a===0)return!0;const u=r(i[a-1],s);return!(u>0||u===0)})}function qs(){return!0}function Nr(){return!1}function js(){}function uE(i){let t,e,r;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==r||!ho(s,e))&&(r=this,e=s,t=i.apply(this,arguments)),t}}function hE(i){function t(){let e;try{e=i()}catch(r){return Promise.reject(r)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function zr(i){for(const t in i)delete i[t]}function ld(i){let t;for(t in i)return!1;return!t}class Un{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}class co extends uo{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const r=this.listeners_||(this.listeners_={}),s=r[t]||(r[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",r=e?t:t.type,s=this.listeners_&&this.listeners_[r];if(!s)return;const a=e?new Un(t):t;a.target||(a.target=this.eventTarget_||this);const u=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});r in u||(u[r]=0,h[r]=0),++u[r];let c;for(let d=0,g=s.length;d<g;++d)if("handleEvent"in s[d]?c=s[d].handleEvent(a):c=s[d].call(this,a),c===!1||a.propagationStopped){c=!1;break}if(--u[r]===0){let d=h[r];for(delete h[r];d--;)this.removeEventListener(r,js);delete u[r]}return c}disposeInternal(){this.listeners_&&zr(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const r=this.listeners_[t];if(!r)return;const s=r.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(r[s]=js,++this.pendingRemovals_[t]):(r.splice(s,1),r.length===0&&delete this.listeners_[t]))}}function mt(i,t,e,r,s){if(s){const u=e;e=function(h){return i.removeEventListener(t,e),u.call(r??this,h)}}else r&&r!==i&&(e=e.bind(r));const a={target:i,type:t,listener:e};return i.addEventListener(t,e),a}function Js(i,t,e,r){return mt(i,t,e,r,!0)}function Pt(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),zr(i))}let Gr=class extends co{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(it.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const r=t.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=mt(this,t[a],e);return s}return mt(this,t,e)}onceInternal(t,e){let r;if(Array.isArray(t)){const s=t.length;r=new Array(s);for(let a=0;a<s;++a)r[a]=Js(this,t[a],e)}else r=Js(this,t,e);return e.ol_key=r,r}unInternal(t,e){const r=e.ol_key;if(r)cE(r);else if(Array.isArray(t))for(let s=0,a=t.length;s<a;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}};Gr.prototype.on;Gr.prototype.once;Gr.prototype.un;function cE(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)Pt(i[t]);else Pt(i)}function ct(){throw new Error("Unimplemented abstract method.")}let fE=0;function te(i){return i.ol_uid||(i.ol_uid=String(++fE))}class sf extends Un{constructor(t,e,r){super(t),this.key=e,this.oldValue=r}}class Rn extends Gr{constructor(t){super(),this.on,this.once,this.un,te(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let r;r=`change:${t}`,this.hasListener(r)&&this.dispatchEvent(new sf(r,t,e)),r=Lr.PROPERTYCHANGE,this.hasListener(r)&&this.dispatchEvent(new sf(r,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,r){const s=this.values_||(this.values_={});if(r)s[t]=e;else{const a=s[t];s[t]=e,a!==e&&this.notify(t,a)}}setProperties(t,e){for(const r in t)this.set(r,t[r],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const r=this.values_[t];delete this.values_[t],ld(this.values_)&&(this.values_=null),e||this.notify(t,r)}}}const of={LENGTH:"length"};class Ns extends Un{constructor(t,e,r){super(t),this.element=e,this.index=r}}class sn extends Rn{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let r=0,s=this.array_.length;r<s;++r)this.assertUnique_(this.array_[r],r);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,r=t.length;e<r;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let r=0,s=e.length;r<s;++r)t(e[r],r,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(of.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ns(We.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let r=0,s=e.length;r<s;++r)if(e[r]===t)return this.removeAt(r)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ns(We.REMOVE,e,t)),e}setAt(t,e){const r=this.getLength();if(t>=r){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const s=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ns(We.REMOVE,s,t)),this.dispatchEvent(new Ns(We.ADD,e,t))}updateLength_(){this.set(of.LENGTH,this.array_.length)}assertUnique_(t,e){for(let r=0,s=this.array_.length;r<s;++r)if(this.array_[r]===t&&r!==e)throw new Error("Duplicate item added to a unique collection")}}class Ni extends Un{constructor(t,e,r){super(t),this.map=e,this.frameState=r!==void 0?r:null}}class Fn extends Ni{constructor(t,e,r,s,a,u){super(t,e,a),this.originalEvent=r,this.pixel_=null,this.coordinate_=null,this.dragging=s!==void 0?s:!1,this.activePointers=u}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const xt={SINGLECLICK:"singleclick",CLICK:it.CLICK,DBLCLICK:it.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},ai=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",dE=ai.includes("safari")&&!ai.includes("chrom");dE&&(ai.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ai));const gE=ai.includes("webkit")&&!ai.includes("edge"),Bl=ai.includes("macintosh"),_E=typeof devicePixelRatio<"u"?devicePixelRatio:1,ud=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,hd=typeof Image<"u"&&Image.prototype.decode,cd=function(){let i=!1;try{const t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i}(),El={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown"};class pE extends co{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const r=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=r,this.pointerdownListenerKey_=mt(r,El.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=mt(r,El.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(it.TOUCHMOVE,this.boundHandleTouchMove_,cd?{passive:!1}:!1)}emulateClick_(t){let e=new Fn(xt.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new Fn(xt.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const r=new Fn(xt.SINGLECLICK,this.map_,t);this.dispatchEvent(r)},250)}updateActivePointers_(t){const e=t,r=e.pointerId;if(e.type==xt.POINTERUP||e.type==xt.POINTERCANCEL){delete this.trackedTouches_[r];for(const s in this.trackedTouches_)if(this.trackedTouches_[s].target!==e.target){delete this.trackedTouches_[s];break}}else(e.type==xt.POINTERDOWN||e.type==xt.POINTERMOVE)&&(this.trackedTouches_[r]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new Fn(xt.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(Pt),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new Fn(xt.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const r=this.map_.getOwnerDocument();this.dragListenerKeys_.push(mt(r,xt.POINTERMOVE,this.handlePointerMove_,this),mt(r,xt.POINTERUP,this.handlePointerUp_,this),mt(this.element_,xt.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==r&&this.dragListenerKeys_.push(mt(this.element_.getRootNode(),xt.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new Fn(xt.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new Fn(xt.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(Pt(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(it.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(Pt(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Pt),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const Nn={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Qt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},B={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function wt(i,t){if(!i)throw new Error(t)}const Qs=1/0;class mE{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,zr(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,r=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const s=this.keyFunction_(r);return delete this.queuedElements_[s],r}enqueue(t){wt(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=Qs?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,r=this.priorities_,s=e.length,a=e[t],u=r[t],h=t;for(;t<s>>1;){const c=this.getLeftChildIndex_(t),d=this.getRightChildIndex_(t),g=d<s&&r[d]<r[c]?d:c;e[t]=e[g],r[t]=r[g],t=g}e[t]=a,r[t]=u,this.siftDown_(h,t)}siftDown_(t,e){const r=this.elements_,s=this.priorities_,a=r[e],u=s[e];for(;e>t;){const h=this.getParentIndex_(e);if(s[h]>u)r[e]=r[h],s[e]=s[h],e=h;else break}r[e]=a,s[e]=u}reprioritize(){const t=this.priorityFunction_,e=this.elements_,r=this.priorities_;let s=0;const a=e.length;let u,h,c;for(h=0;h<a;++h)u=e[h],c=t(u),c==Qs?delete this.queuedElements_[this.keyFunction_(u)]:(r[s]=c,e[s++]=u);e.length=s,r.length=s,this.heapify_()}}class yE extends mE{constructor(t,e){super(r=>t.apply(null,r),r=>r[0].getKey()),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(it.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,r=e.getState();if(r===B.LOADED||r===B.ERROR||r===B.EMPTY){r!==B.ERROR&&e.removeEventListener(it.CHANGE,this.boundHandleTileChange_);const s=e.getKey();s in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[s],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let r=0;for(;this.tilesLoading_<t&&r<e&&this.getCount()>0;){const s=this.dequeue()[0],a=s.getKey();s.getState()===B.IDLE&&!(a in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[a]=!0,++this.tilesLoading_,++r,s.load())}}}function vE(i,t,e,r,s){if(!i||!(e in i.wantedTiles)||!i.wantedTiles[e][t.getKey()])return Qs;const a=i.viewState.center,u=r[0]-a[0],h=r[1]-a[1];return 65536*Math.log(s)+Math.sqrt(u*u+h*h)/s}const Ue={ANIMATING:0,INTERACTING:1},je={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function Dt(i,t,e){return Math.min(Math.max(i,t),e)}function EE(i,t,e,r,s,a){const u=s-e,h=a-r;if(u!==0||h!==0){const c=((i-e)*u+(t-r)*h)/(u*u+h*h);c>1?(e=s,r=a):c>0&&(e+=u*c,r+=h*c)}return ki(i,t,e,r)}function ki(i,t,e,r){const s=e-i,a=r-t;return s*s+a*a}function wE(i){const t=i.length;for(let r=0;r<t;r++){let s=r,a=Math.abs(i[r][r]);for(let h=r+1;h<t;h++){const c=Math.abs(i[h][r]);c>a&&(a=c,s=h)}if(a===0)return null;const u=i[s];i[s]=i[r],i[r]=u;for(let h=r+1;h<t;h++){const c=-i[h][r]/i[r][r];for(let d=r;d<t+1;d++)r==d?i[h][d]=0:i[h][d]+=c*i[r][d]}}const e=new Array(t);for(let r=t-1;r>=0;r--){e[r]=i[r][t]/i[r][r];for(let s=r-1;s>=0;s--)i[s][t]-=i[s][r]*e[r]}return e}function af(i){return i*180/Math.PI}function Gn(i){return i*Math.PI/180}function ri(i,t){const e=i%t;return e*t<0?e+t:e}function RE(i,t,e){return i+e*(t-i)}function Yl(i,t){const e=Math.pow(10,t);return Math.round(i*e)/e}function zs(i,t){return Math.floor(Yl(i,t))}function Gs(i,t){return Math.ceil(Yl(i,t))}function wl(i,t,e){if(i>=t&&i<e)return i;const r=e-t;return((i-t)%r+r)%r+t}function lf(i,t,e){return function(r,s,a,u,h){if(!r)return;if(!s&&!t)return r;const c=t?0:a[0]*s,d=t?0:a[1]*s,g=h?h[0]:0,y=h?h[1]:0;let v=i[0]+c/2+g,C=i[2]-c/2+g,T=i[1]+d/2+y,A=i[3]-d/2+y;v>C&&(v=(C+v)/2,C=v),T>A&&(T=(A+T)/2,A=T);let b=Dt(r[0],v,C),F=Dt(r[1],T,A);if(u&&e&&s){const z=30*s;b+=-z*Math.log(1+Math.max(0,v-r[0])/z)+z*Math.log(1+Math.max(0,r[0]-C)/z),F+=-z*Math.log(1+Math.max(0,T-r[1])/z)+z*Math.log(1+Math.max(0,r[1]-A)/z)}return[b,F]}}function CE(i){return i}const Vt={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function uf(i){const t=hi();for(let e=0,r=i.length;e<r;++e)Hs(t,i[e]);return t}function Bx(i,t,e){return e?(e[0]=i[0]-t,e[1]=i[1]-t,e[2]=i[2]+t,e[3]=i[3]+t,e):[i[0]-t,i[1]-t,i[2]+t,i[3]+t]}function xE(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i.slice()}function fd(i,t,e){let r,s;return t<i[0]?r=i[0]-t:i[2]<t?r=t-i[2]:r=0,e<i[1]?s=i[1]-e:i[3]<e?s=e-i[3]:s=0,r*r+s*s}function Zl(i,t){return dd(i,t[0],t[1])}function Yx(i,t){return i[0]<=t[0]&&t[2]<=i[2]&&i[1]<=t[1]&&t[3]<=i[3]}function dd(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function hf(i,t){const e=i[0],r=i[1],s=i[2],a=i[3],u=t[0],h=t[1];let c=Vt.UNKNOWN;return u<e?c=c|Vt.LEFT:u>s&&(c=c|Vt.RIGHT),h<r?c=c|Vt.BELOW:h>a&&(c=c|Vt.ABOVE),c===Vt.UNKNOWN&&(c=Vt.INTERSECTING),c}function hi(){return[1/0,1/0,-1/0,-1/0]}function Ur(i,t,e,r,s){return s?(s[0]=i,s[1]=t,s[2]=e,s[3]=r,s):[i,t,e,r]}function fo(i){return Ur(1/0,1/0,-1/0,-1/0,i)}function TE(i,t){const e=i[0],r=i[1];return Ur(e,r,e,r,t)}function IE(i,t,e,r,s){const a=fo(s);return gd(a,i,t,e,r)}function Rl(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function AE(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function Hs(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function gd(i,t,e,r,s){for(;e<r;e+=s)bE(i,t[e],t[e+1]);return i}function bE(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function _d(i,t){let e;return e=t(go(i)),e||(e=t(_o(i)),e)||(e=t(po(i)),e)||(e=t(ci(i)),e)?e:!1}function Cl(i){let t=0;return mo(i)||(t=Tt(i)*ke(i)),t}function go(i){return[i[0],i[1]]}function _o(i){return[i[2],i[1]]}function Zi(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function LE(i,t){let e;if(t==="bottom-left")e=go(i);else if(t==="bottom-right")e=_o(i);else if(t==="top-left")e=ci(i);else if(t==="top-right")e=po(i);else throw new Error("Invalid corner");return e}function xl(i,t,e,r,s){const[a,u,h,c,d,g,y,v]=pd(i,t,e,r);return Ur(Math.min(a,h,d,y),Math.min(u,c,g,v),Math.max(a,h,d,y),Math.max(u,c,g,v),s)}function pd(i,t,e,r){const s=t*r[0]/2,a=t*r[1]/2,u=Math.cos(e),h=Math.sin(e),c=s*u,d=s*h,g=a*u,y=a*h,v=i[0],C=i[1];return[v-c+y,C-d-g,v-c-y,C-d+g,v+c-y,C+d+g,v+c+y,C+d-g,v-c+y,C-d-g]}function ke(i){return i[3]-i[1]}function si(i,t,e){const r=e||hi();return Wr(i,t)?(i[0]>t[0]?r[0]=i[0]:r[0]=t[0],i[1]>t[1]?r[1]=i[1]:r[1]=t[1],i[2]<t[2]?r[2]=i[2]:r[2]=t[2],i[3]<t[3]?r[3]=i[3]:r[3]=t[3]):fo(r),r}function ci(i){return[i[0],i[3]]}function po(i){return[i[2],i[3]]}function Tt(i){return i[2]-i[0]}function Wr(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function mo(i){return i[2]<i[0]||i[3]<i[1]}function SE(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function ME(i,t,e){let r=!1;const s=hf(i,t),a=hf(i,e);if(s===Vt.INTERSECTING||a===Vt.INTERSECTING)r=!0;else{const u=i[0],h=i[1],c=i[2],d=i[3],g=t[0],y=t[1],v=e[0],C=e[1],T=(C-y)/(v-g);let A,b;a&Vt.ABOVE&&!(s&Vt.ABOVE)&&(A=v-(C-d)/T,r=A>=u&&A<=c),!r&&a&Vt.RIGHT&&!(s&Vt.RIGHT)&&(b=C-(v-c)*T,r=b>=h&&b<=d),!r&&a&Vt.BELOW&&!(s&Vt.BELOW)&&(A=v-(C-h)/T,r=A>=u&&A<=c),!r&&a&Vt.LEFT&&!(s&Vt.LEFT)&&(b=C-(v-u)*T,r=b>=h&&b<=d)}return r}function OE(i,t){const e=t.getExtent(),r=Zi(i);if(t.canWrapX()&&(r[0]<e[0]||r[0]>=e[2])){const s=Tt(e),u=Math.floor((r[0]-e[0])/s)*s;i[0]-=u,i[2]-=u}return i}function PE(i,t,e){if(t.canWrapX()){const r=t.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[r[0],i[1],r[2],i[3]]];OE(i,t);const s=Tt(r);if(Tt(i)>s&&!e)return[[r[0],i[1],r[2],i[3]]];if(i[0]<r[0])return[[i[0]+s,i[1],r[2],i[3]],[r[0],i[1],i[2],i[3]]];if(i[2]>r[2])return[[i[0],i[1],r[2],i[3]],[r[0],i[1],i[2]-s,i[3]]]}return[i]}function DE(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function Zx(i,t){const e=t.getRadius(),r=t.getCenter(),s=r[0],a=r[1],u=i[0],h=i[1];let c=u-s;const d=h-a;c===0&&d===0&&(c=1);const g=Math.sqrt(c*c+d*d),y=s+e*c/g,v=a+e*d/g;return[y,v]}function FE(i,t){const e=i[0],r=i[1],s=t[0],a=t[1],u=s[0],h=s[1],c=a[0],d=a[1],g=c-u,y=d-h,v=g===0&&y===0?0:(g*(e-u)+y*(r-h))/(g*g+y*y||0);let C,T;return v<=0?(C=u,T=h):v>=1?(C=c,T=d):(C=u+v*g,T=h+v*y),[C,T]}function to(i,t){let e=!0;for(let r=i.length-1;r>=0;--r)if(i[r]!=t[r]){e=!1;break}return e}function Vl(i,t){const e=Math.cos(t),r=Math.sin(t),s=i[0]*e-i[1]*r,a=i[1]*e+i[0]*r;return i[0]=s,i[1]=a,i}function NE(i,t){return i[0]*=t,i[1]*=t,i}function md(i,t){const e=i[0]-t[0],r=i[1]-t[1];return e*e+r*r}function Vx(i,t){return Math.sqrt(md(i,t))}function Hx(i,t){return md(i,FE(i,t))}function zE(i,t){if(t.canWrapX()){const e=Tt(t.getExtent()),r=GE(i,t,e);r&&(i[0]-=r*e)}return i}function GE(i,t,e){const r=t.getExtent();let s=0;return t.canWrapX()&&(i[0]<r[0]||i[0]>r[2])&&(e=e||Tt(r),s=Math.floor((i[0]-r[0])/e)),s}function yd(i){return Math.pow(i,3)}function ji(i){return 1-yd(1-i)}function UE(i){return 3*i*i-2*i*i*i}function WE(i){return i}const kE=63710088e-1;function cf(i,t,e){e=e||kE;const r=Gn(i[1]),s=Gn(t[1]),a=(s-r)/2,u=Gn(t[0]-i[0])/2,h=Math.sin(a)*Math.sin(a)+Math.sin(u)*Math.sin(u)*Math.cos(r)*Math.cos(s);return 2*e*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))}function vd(...i){console.warn(...i)}const Hl={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};class $l{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||Hl[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}}const kr=6378137,Wi=Math.PI*kr,XE=[-Wi,-Wi,Wi,Wi],KE=[-180,-85,180,85],Us=kr*Math.log(Math.tan(Math.PI/2));class Li extends $l{constructor(t){super({code:t,units:"m",extent:XE,global:!0,worldExtent:KE,getPointResolution:function(e,r){return e/Math.cosh(r[1]/kr)}})}}const ff=[new Li("EPSG:3857"),new Li("EPSG:102100"),new Li("EPSG:102113"),new Li("EPSG:900913"),new Li("http://www.opengis.net/def/crs/EPSG/0/3857"),new Li("http://www.opengis.net/gml/srs/epsg.xml#3857")];function BE(i,t,e,r){const s=i.length;e=e>1?e:2,r=r??e,t===void 0&&(e>2?t=i.slice():t=new Array(s));for(let a=0;a<s;a+=r){t[a]=Wi*i[a]/180;let u=kr*Math.log(Math.tan(Math.PI*(+i[a+1]+90)/360));u>Us?u=Us:u<-Us&&(u=-Us),t[a+1]=u}return t}function YE(i,t,e,r){const s=i.length;e=e>1?e:2,r=r??e,t===void 0&&(e>2?t=i.slice():t=new Array(s));for(let a=0;a<s;a+=r)t[a]=180*i[a]/Wi,t[a+1]=360*Math.atan(Math.exp(i[a+1]/kr))/Math.PI-90;return t}const ZE=6378137,df=[-180,-90,180,90],VE=Math.PI*ZE/180;class Jn extends $l{constructor(t,e){super({code:t,units:"degrees",extent:df,axisOrientation:e,global:!0,metersPerUnit:VE,worldExtent:df})}}const gf=[new Jn("CRS:84"),new Jn("EPSG:4326","neu"),new Jn("urn:ogc:def:crs:OGC:1.3:CRS84"),new Jn("urn:ogc:def:crs:OGC:2:84"),new Jn("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new Jn("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Jn("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Tl={};function HE(i){return Tl[i]||Tl[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function $E(i,t){Tl[i]=t}let Xi={};function Sr(i,t,e){const r=i.getCode(),s=t.getCode();r in Xi||(Xi[r]={}),Xi[r][s]=e}function $a(i,t){return i in Xi&&t in Xi[i]?Xi[i][t]:null}const eo=.9996,Be=.00669438,yo=Be*Be,vo=yo*Be,ei=Be/(1-Be),_f=Math.sqrt(1-Be),Vi=(1-_f)/(1+_f),Ed=Vi*Vi,ql=Ed*Vi,jl=ql*Vi,wd=jl*Vi,Rd=1-Be/4-3*yo/64-5*vo/256,qE=3*Be/8+3*yo/32+45*vo/1024,jE=15*yo/256+45*vo/1024,JE=35*vo/3072,QE=3/2*Vi-27/32*ql+269/512*wd,tw=21/16*Ed-55/32*jl,ew=151/96*ql-417/128*wd,nw=1097/512*jl,no=6378137;function iw(i,t,e){const r=i-5e5,u=(e.north?t:t-1e7)/eo/(no*Rd),h=u+QE*Math.sin(2*u)+tw*Math.sin(4*u)+ew*Math.sin(6*u)+nw*Math.sin(8*u),c=Math.sin(h),d=c*c,g=Math.cos(h),y=c/g,v=y*y,C=v*v,T=1-Be*d,A=Math.sqrt(1-Be*d),b=no/A,F=(1-Be)/T,z=ei*g**2,U=z*z,N=r/(b*eo),D=N*N,Z=D*N,K=Z*N,X=K*N,$=X*N,j=h-y/F*(D/2-K/24*(5+3*v+10*z-4*U-9*ei))+$/720*(61+90*v+298*z+45*C-252*ei-3*U);let Lt=(N-Z/6*(1+2*v+z)+X/120*(5-2*z+28*v-3*U+8*ei+24*C))/g;return Lt=wl(Lt+Gn(Cd(e.number)),-Math.PI,Math.PI),[af(Lt),af(j)]}const pf=-80,mf=84,rw=-180,sw=180;function ow(i,t,e){i=wl(i,rw,sw),t<pf?t=pf:t>mf&&(t=mf);const r=Gn(t),s=Math.sin(r),a=Math.cos(r),u=s/a,h=u*u,c=h*h,d=Gn(i),g=Cd(e.number),y=Gn(g),v=no/Math.sqrt(1-Be*s**2),C=ei*a**2,T=a*wl(d-y,-Math.PI,Math.PI),A=T*T,b=A*T,F=b*T,z=F*T,U=z*T,N=no*(Rd*r-qE*Math.sin(2*r)+jE*Math.sin(4*r)-JE*Math.sin(6*r)),D=eo*v*(T+b/6*(1-h+C)+z/120*(5-18*h+c+72*C-58*ei))+5e5;let Z=eo*(N+v*u*(A/2+F/24*(5-h+9*C+4*C**2)+U/720*(61-58*h+c+600*C-330*ei)));return e.north||(Z+=1e7),[D,Z]}function Cd(i){return(i-1)*6-180+3}const aw=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function xd(i){let t=0;for(const s of aw){const a=i.match(s);if(a){t=parseInt(a[1]);break}}if(!t)return null;let e=0,r=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(r=!0,e=t-32600),e?{number:e,north:r}:null}function yf(i,t){return function(e,r,s,a){const u=e.length;s=s>1?s:2,a=a??s,r||(s>2?r=e.slice():r=new Array(u));for(let h=0;h<u;h+=a){const c=e[h],d=e[h+1],g=i(c,d,t);r[h]=g[0],r[h+1]=g[1]}return r}}function lw(i){return xd(i)?new $l({code:i,units:"m"}):null}function uw(i){const t=xd(i.getCode());return t?{forward:yf(ow,t),inverse:yf(iw,t)}:null}const hw=[uw],cw=[lw];let Il=!0;function fw(i){Il=!1}function Jl(i,t){if(t!==void 0){for(let e=0,r=i.length;e<r;++e)t[e]=i[e];t=t}else t=i.slice();return t}function Al(i){$E(i.getCode(),i),Sr(i,i,Jl)}function dw(i){i.forEach(Al)}function Ae(i){if(typeof i!="string")return i;const t=HE(i);if(t)return t;for(const e of cw){const r=e(i);if(r)return r}return null}function vf(i,t,e,r){i=Ae(i);let s;const a=i.getPointResolutionFunc();if(a)s=a(t,e);else{const u=i.getUnits();if(u=="degrees"||r=="degrees")s=t;else{const h=tu(i,Ae("EPSG:4326"));if(!h&&u!=="degrees")s=t*i.getMetersPerUnit();else{let d=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];d=h(d,d,2);const g=cf(d.slice(0,2),d.slice(2,4)),y=cf(d.slice(4,6),d.slice(6,8));s=(g+y)/2}const c=i.getMetersPerUnit();c!==void 0&&(s/=c)}}return s}function Ef(i){dw(i),i.forEach(function(t){i.forEach(function(e){t!==e&&Sr(t,e,Jl)})})}function gw(i,t,e,r){i.forEach(function(s){t.forEach(function(a){Sr(s,a,e),Sr(a,s,r)})})}function Ql(i,t){return i?typeof i=="string"?Ae(i):i:Ae(t)}function _w(i){return function(t,e,r,s){const a=t.length;r=r!==void 0?r:2,s=s??r,e=e!==void 0?e:new Array(a);for(let u=0;u<a;u+=s){const h=i(t.slice(u,u+r)),c=h.length;for(let d=0,g=s;d<g;++d)e[u+d]=d>=c?t[u+d]:h[d]}return e}}function qa(i,t){if(i===t)return!0;const e=i.getUnits()===t.getUnits();return(i.getCode()===t.getCode()||tu(i,t)===Jl)&&e}function tu(i,t){const e=i.getCode(),r=t.getCode();let s=$a(e,r);if(s)return s;let a=null,u=null;for(const c of hw)a||(a=c(i)),u||(u=c(t));if(!a&&!u)return null;const h="EPSG:4326";if(u)if(a)s=ja(a.inverse,u.forward);else{const c=$a(e,h);c&&(s=ja(c,u.forward))}else{const c=$a(h,r);c&&(s=ja(a.inverse,c))}return s&&(Al(i),Al(t),Sr(i,t,s)),s}function ja(i,t){return function(e,r,s,a){return r=i(e,r,s,a),t(r,r,s,a)}}function io(i,t){const e=Ae(i),r=Ae(t);return tu(e,r)}function Td(i,t,e){const r=io(t,e);if(!r){const s=Ae(t).getCode(),a=Ae(e).getCode();throw new Error(`No transform available between ${s} and ${a}`)}return r(i,void 0,i.length)}function bl(i,t){return i}function mn(i,t){return Il&&!to(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Il=!1,vd("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function pw(i,t){return i}function ni(i,t){return i}function mw(){Ef(ff),Ef(gf),gw(gf,ff,BE,YE)}mw();new Array(6);function Ki(){return[1,0,0,1,0,0]}function $x(i,t){return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i}function Ie(i,t){const e=t[0],r=t[1];return t[0]=i[0]*e+i[2]*r+i[4],t[1]=i[1]*e+i[3]*r+i[5],t}function Mr(i,t,e,r,s,a,u,h){const c=Math.sin(a),d=Math.cos(a);return i[0]=r*d,i[1]=s*c,i[2]=-r*c,i[3]=s*d,i[4]=u*r*d-h*r*c+t,i[5]=u*s*c+h*s*d+e,i}function Id(i,t){const e=yw(t);wt(e!==0,"Transformation matrix cannot be inverted");const r=t[0],s=t[1],a=t[2],u=t[3],h=t[4],c=t[5];return i[0]=u/e,i[1]=-s/e,i[2]=-a/e,i[3]=r/e,i[4]=(a*c-u*h)/e,i[5]=-(r*c-s*h)/e,i}function yw(i){return i[0]*i[3]-i[1]*i[2]}const vw=[1e5,1e5,1e5,1e5,2,2];function Ew(i){return"matrix("+i.join(", ")+")"}function wf(i){return i.substring(7,i.length-1).split(",").map(parseFloat)}function ww(i,t){const e=wf(i),r=wf(t);for(let s=0;s<6;++s)if(Math.round((e[s]-r[s])*vw[s])!==0)return!1;return!0}function Ad(i,t,e,r,s,a,u){a=a||[],u=u||2;let h=0;for(let c=t;c<e;c+=r){const d=i[c],g=i[c+1];a[h++]=s[0]*d+s[2]*g+s[4],a[h++]=s[1]*d+s[3]*g+s[5];for(let y=2;y<u;y++)a[h++]=i[c+y]}return a&&a.length!=h&&(a.length=h),a}function Rw(i,t,e,r,s,a,u){u=u||[];const h=Math.cos(s),c=Math.sin(s),d=a[0],g=a[1];let y=0;for(let v=t;v<e;v+=r){const C=i[v]-d,T=i[v+1]-g;u[y++]=d+C*h-T*c,u[y++]=g+C*c+T*h;for(let A=v+2;A<v+r;++A)u[y++]=i[A]}return u&&u.length!=y&&(u.length=y),u}function Cw(i,t,e,r,s,a,u,h){h=h||[];const c=u[0],d=u[1];let g=0;for(let y=t;y<e;y+=r){const v=i[y]-c,C=i[y+1]-d;h[g++]=c+s*v,h[g++]=d+a*C;for(let T=y+2;T<y+r;++T)h[g++]=i[T]}return h&&h.length!=g&&(h.length=g),h}function xw(i,t,e,r,s,a,u){u=u||[];let h=0;for(let c=t;c<e;c+=r){u[h++]=i[c]+s,u[h++]=i[c+1]+a;for(let d=c+2;d<c+r;++d)u[h++]=i[d]}return u&&u.length!=h&&(u.length=h),u}const Rf=Ki(),Tw=[NaN,NaN];class Iw extends Rn{constructor(){super(),this.extent_=hi(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=uE((t,e,r)=>{if(!r)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(r),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return ct()}closestPointXY(t,e,r,s){return ct()}containsXY(t,e){return this.closestPointXY(t,e,Tw,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return ct()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&fo(e),this.extentRevision_=this.getRevision()}return SE(this.extent_,t)}rotate(t,e){ct()}scale(t,e,r){ct()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return ct()}getType(){return ct()}applyTransform(t){ct()}intersectsExtent(t){return ct()}translate(t,e){ct()}transform(t,e){const r=Ae(t),s=r.getUnits()=="tile-pixels"?function(a,u,h){const c=r.getExtent(),d=r.getWorldExtent(),g=ke(d)/ke(c);Mr(Rf,d[0],d[3],g,-g,0,0,0);const y=Ad(a,0,a.length,h,Rf,u),v=io(r,e);return v?v(y,y,h):y}:io(r,e);return this.applyTransform(s),this}}class eu extends Iw{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return IE(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return ct()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Cf(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){ct()}setLayout(t,e,r){let s;if(t)s=Cf(t);else{for(let a=0;a<r;++a){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}s=e.length,t=Aw(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const r=this.getFlatCoordinates();if(r){const s=this.getStride();Rw(r,0,r.length,s,t,e,r),this.changed()}}scale(t,e,r){e===void 0&&(e=t),r||(r=Zi(this.getExtent()));const s=this.getFlatCoordinates();if(s){const a=this.getStride();Cw(s,0,s.length,a,t,e,r,s),this.changed()}}translate(t,e){const r=this.getFlatCoordinates();if(r){const s=this.getStride();xw(r,0,r.length,s,t,e,r),this.changed()}}}function Aw(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function Cf(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}function qx(i,t,e){const r=i.getFlatCoordinates();if(!r)return null;const s=i.getStride();return Ad(r,0,r.length,s,t,e)}function bd(i,t,e,r){let s=0;const a=i[e-r],u=i[e-r+1];let h=0,c=0;for(;t<e;t+=r){const d=i[t]-a,g=i[t+1]-u;s+=c*d-h*g,h=d,c=g}return s/2}function Ld(i,t,e,r){let s=0;for(let a=0,u=e.length;a<u;++a){const h=e[a];s+=bd(i,t,h,r),t=h}return s}function jx(i,t,e,r){let s=0;for(let a=0,u=e.length;a<u;++a){const h=e[a];s+=Ld(i,t,h,r),t=h[h.length-1]}return s}function xf(i,t,e,r,s,a,u){const h=i[t],c=i[t+1],d=i[e]-h,g=i[e+1]-c;let y;if(d===0&&g===0)y=t;else{const v=((s-h)*d+(a-c)*g)/(d*d+g*g);if(v>1)y=e;else if(v>0){for(let C=0;C<r;++C)u[C]=RE(i[t+C],i[e+C],v);u.length=r;return}else y=t}for(let v=0;v<r;++v)u[v]=i[y+v];u.length=r}function Sd(i,t,e,r,s){let a=i[t],u=i[t+1];for(t+=r;t<e;t+=r){const h=i[t],c=i[t+1],d=ki(a,u,h,c);d>s&&(s=d),a=h,u=c}return s}function Md(i,t,e,r,s){for(let a=0,u=e.length;a<u;++a){const h=e[a];s=Sd(i,t,h,r,s),t=h}return s}function Jx(i,t,e,r,s){for(let a=0,u=e.length;a<u;++a){const h=e[a];s=Md(i,t,h,r,s),t=h[h.length-1]}return s}function Od(i,t,e,r,s,a,u,h,c,d,g){if(t==e)return d;let y,v;if(s===0){if(v=ki(u,h,i[t],i[t+1]),v<d){for(y=0;y<r;++y)c[y]=i[t+y];return c.length=r,v}return d}g=g||[NaN,NaN];let C=t+r;for(;C<e;)if(xf(i,C-r,C,r,u,h,g),v=ki(u,h,g[0],g[1]),v<d){for(d=v,y=0;y<r;++y)c[y]=g[y];c.length=r,C+=r}else C+=r*Math.max((Math.sqrt(v)-Math.sqrt(d))/s|0,1);if(a&&(xf(i,e-r,t,r,u,h,g),v=ki(u,h,g[0],g[1]),v<d)){for(d=v,y=0;y<r;++y)c[y]=g[y];c.length=r}return d}function Pd(i,t,e,r,s,a,u,h,c,d,g){g=g||[NaN,NaN];for(let y=0,v=e.length;y<v;++y){const C=e[y];d=Od(i,t,C,r,s,a,u,h,c,d,g),t=C}return d}function Qx(i,t,e,r,s,a,u,h,c,d,g){g=g||[NaN,NaN];for(let y=0,v=e.length;y<v;++y){const C=e[y];d=Pd(i,t,C,r,s,a,u,h,c,d,g),t=C[C.length-1]}return d}function bw(i,t,e,r){for(let s=0,a=e.length;s<a;++s)i[t++]=e[s];return t}function Dd(i,t,e,r){for(let s=0,a=e.length;s<a;++s){const u=e[s];for(let h=0;h<r;++h)i[t++]=u[h]}return t}function Fd(i,t,e,r,s){s=s||[];let a=0;for(let u=0,h=e.length;u<h;++u){const c=Dd(i,t,e[u],r);s[a++]=c,t=c}return s.length=a,s}function tT(i,t,e,r,s){s=s||[];let a=0;for(let u=0,h=e.length;u<h;++u){const c=Fd(i,t,e[u],r,s[a]);c.length===0&&(c[0]=t),s[a++]=c,t=c[c.length-1]}return s.length=a,s}function Nd(i,t,e,r,s){s=s!==void 0?s:[];let a=0;for(let u=t;u<e;u+=r)s[a++]=i.slice(u,u+r);return s.length=a,s}function zd(i,t,e,r,s){s=s!==void 0?s:[];let a=0;for(let u=0,h=e.length;u<h;++u){const c=e[u];s[a++]=Nd(i,t,c,r,s[a]),t=c}return s.length=a,s}function eT(i,t,e,r,s){s=s!==void 0?s:[];let a=0;for(let u=0,h=e.length;u<h;++u){const c=e[u];s[a++]=c.length===1&&c[0]===t?[]:zd(i,t,c,r,s[a]),t=c[c.length-1]}return s.length=a,s}function Gd(i,t,e,r,s,a,u){const h=(e-t)/r;if(h<3){for(;t<e;t+=r)a[u++]=i[t],a[u++]=i[t+1];return u}const c=new Array(h);c[0]=1,c[h-1]=1;const d=[t,e-r];let g=0;for(;d.length>0;){const y=d.pop(),v=d.pop();let C=0;const T=i[v],A=i[v+1],b=i[y],F=i[y+1];for(let z=v+r;z<y;z+=r){const U=i[z],N=i[z+1],D=EE(U,N,T,A,b,F);D>C&&(g=z,C=D)}C>s&&(c[(g-t)/r]=1,v+r<g&&d.push(v,g),g+r<y&&d.push(g,y))}for(let y=0;y<h;++y)c[y]&&(a[u++]=i[t+y*r],a[u++]=i[t+y*r+1]);return u}function nT(i,t,e,r,s,a,u,h){for(let c=0,d=e.length;c<d;++c){const g=e[c];u=Gd(i,t,g,r,s,a,u),h.push(u),t=g}return u}function Si(i,t){return t*Math.round(i/t)}function Lw(i,t,e,r,s,a,u){if(t==e)return u;let h=Si(i[t],s),c=Si(i[t+1],s);t+=r,a[u++]=h,a[u++]=c;let d,g;do if(d=Si(i[t],s),g=Si(i[t+1],s),t+=r,t==e)return a[u++]=d,a[u++]=g,u;while(d==h&&g==c);for(;t<e;){const y=Si(i[t],s),v=Si(i[t+1],s);if(t+=r,y==d&&v==g)continue;const C=d-h,T=g-c,A=y-h,b=v-c;if(C*b==T*A&&(C<0&&A<C||C==A||C>0&&A>C)&&(T<0&&b<T||T==b||T>0&&b>T)){d=y,g=v;continue}a[u++]=d,a[u++]=g,h=d,c=g,d=y,g=v}return a[u++]=d,a[u++]=g,u}function Ud(i,t,e,r,s,a,u,h){for(let c=0,d=e.length;c<d;++c){const g=e[c];u=Lw(i,t,g,r,s,a,u),h.push(u),t=g}return u}function iT(i,t,e,r,s,a,u,h){for(let c=0,d=e.length;c<d;++c){const g=e[c],y=[];u=Ud(i,t,g,r,s,a,u,y),h.push(y),t=g[g.length-1]}return u}class Or extends eu{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Or(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,r,s){return s<fd(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Sd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Od(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,r,s))}getArea(){return bd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return Nd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Gd(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Or(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Dd(this.flatCoordinates,0,t,this.stride),this.changed()}}class nu extends eu{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new nu(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,r,s){const a=this.flatCoordinates,u=ki(t,e,a[0],a[1]);if(u<s){const h=this.stride;for(let c=0;c<h;++c)r[c]=a[c];return r.length=h,u}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return TE(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return dd(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=bw(this.flatCoordinates,0,t,this.stride),this.changed()}}function Sw(i,t,e,r,s){return!_d(s,function(u){return!ii(i,t,e,r,u[0],u[1])})}function ii(i,t,e,r,s,a){let u=0,h=i[e-r],c=i[e-r+1];for(;t<e;t+=r){const d=i[t],g=i[t+1];c<=a?g>a&&(d-h)*(a-c)-(s-h)*(g-c)>0&&u++:g<=a&&(d-h)*(a-c)-(s-h)*(g-c)<0&&u--,h=d,c=g}return u!==0}function iu(i,t,e,r,s,a){if(e.length===0||!ii(i,t,e[0],r,s,a))return!1;for(let u=1,h=e.length;u<h;++u)if(ii(i,e[u-1],e[u],r,s,a))return!1;return!0}function rT(i,t,e,r,s,a){if(e.length===0)return!1;for(let u=0,h=e.length;u<h;++u){const c=e[u];if(iu(i,t,c,r,s,a))return!0;t=c[c.length-1]}return!1}function Wd(i,t,e,r,s,a,u){let h,c,d,g,y,v,C;const T=s[a+1],A=[];for(let z=0,U=e.length;z<U;++z){const N=e[z];for(g=i[N-r],v=i[N-r+1],h=t;h<N;h+=r)y=i[h],C=i[h+1],(T<=v&&C<=T||v<=T&&T<=C)&&(d=(T-v)/(C-v)*(y-g)+g,A.push(d)),g=y,v=C}let b=NaN,F=-1/0;for(A.sort(Fr),g=A[0],h=1,c=A.length;h<c;++h){y=A[h];const z=Math.abs(y-g);z>F&&(d=(g+y)/2,iu(i,t,e,r,d,T)&&(b=d,F=z)),g=y}return isNaN(b)&&(b=s[a]),u?(u.push(b,T,F),u):[b,T,F]}function sT(i,t,e,r,s){let a=[];for(let u=0,h=e.length;u<h;++u){const c=e[u];a=Wd(i,t,c,r,s,2*u,a),t=c[c.length-1]}return a}function Mw(i,t,e,r,s){let a;for(t+=r;t<e;t+=r)if(a=s(i.slice(t-r,t),i.slice(t,t+r)),a)return a;return!1}function oT(i,t){const[e,r]=i,[s,a]=t,u=((e[0]-s[0])*(s[1]-a[1])-(e[1]-s[1])*(s[0]-a[0]))/((e[0]-r[0])*(s[1]-a[1])-(e[1]-r[1])*(s[0]-a[0])),h=((e[0]-s[0])*(e[1]-r[1])-(e[1]-s[1])*(e[0]-r[0]))/((e[0]-r[0])*(s[1]-a[1])-(e[1]-r[1])*(s[0]-a[0]));if(0<=u&&u<=1&&0<=h&&h<=1)return[e[0]+u*(r[0]-e[0]),e[1]+u*(r[1]-e[1])]}function ru(i,t,e,r,s,a){return a=a??gd(hi(),i,t,e,r),Wr(s,a)?a[0]>=s[0]&&a[2]<=s[2]||a[1]>=s[1]&&a[3]<=s[3]?!0:Mw(i,t,e,r,function(u,h){return ME(s,u,h)}):!1}function aT(i,t,e,r,s){for(let a=0,u=e.length;a<u;++a){if(ru(i,t,e[a],r,s))return!0;t=e[a]}return!1}function kd(i,t,e,r,s){return!!(ru(i,t,e,r,s)||ii(i,t,e,r,s[0],s[1])||ii(i,t,e,r,s[0],s[3])||ii(i,t,e,r,s[2],s[1])||ii(i,t,e,r,s[2],s[3]))}function Xd(i,t,e,r,s){if(!kd(i,t,e[0],r,s))return!1;if(e.length===1)return!0;for(let a=1,u=e.length;a<u;++a)if(Sw(i,e[a-1],e[a],r,s)&&!ru(i,e[a-1],e[a],r,s))return!1;return!0}function lT(i,t,e,r,s){for(let a=0,u=e.length;a<u;++a){const h=e[a];if(Xd(i,t,h,r,s))return!0;t=h[h.length-1]}return!1}function Ow(i,t,e,r){for(;t<e-r;){for(let s=0;s<r;++s){const a=i[t+s];i[t+s]=i[e-r+s],i[e-r+s]=a}t+=r,e-=r}}function su(i,t,e,r){let s=0,a=i[e-r],u=i[e-r+1];for(;t<e;t+=r){const h=i[t],c=i[t+1];s+=(h-a)*(c+u),a=h,u=c}return s===0?void 0:s>0}function Kd(i,t,e,r,s){s=s!==void 0?s:!1;for(let a=0,u=e.length;a<u;++a){const h=e[a],c=su(i,t,h,r);if(a===0){if(s&&c||!s&&!c)return!1}else if(s&&!c||!s&&c)return!1;t=h}return!0}function uT(i,t,e,r,s){for(let a=0,u=e.length;a<u;++a){const h=e[a];if(!Kd(i,t,h,r,s))return!1;h.length&&(t=h[h.length-1])}return!0}function Ll(i,t,e,r,s){s=s!==void 0?s:!1;for(let a=0,u=e.length;a<u;++a){const h=e[a],c=su(i,t,h,r);(a===0?s&&c||!s&&!c:s&&!c||!s&&c)&&Ow(i,t,h,r),t=h}return t}function hT(i,t,e,r,s){for(let a=0,u=e.length;a<u;++a)t=Ll(i,t,e[a],r,s);return t}function cT(i,t){const e=[];let r=0,s=0,a;for(let u=0,h=t.length;u<h;++u){const c=t[u],d=su(i,r,c,2);if(a===void 0&&(a=d),d===a)e.push(t.slice(s,u+1));else{if(e.length===0)continue;e[e.length-1].push(t[s])}s=u+1,r=c}return e}class Hi extends eu{constructor(t,e,r){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&r?(this.setFlatCoordinates(e,t),this.ends_=r):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?aE(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Hi(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,r,s){return s<fd(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Md(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Pd(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,r,s))}containsXY(t,e){return iu(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Ld(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ll(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,zd(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Zi(this.getExtent());this.flatInteriorPoint_=Wd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new nu(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Or(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,r=this.ends_,s=[];let a=0;for(let u=0,h=r.length;u<h;++u){const c=r[u],d=new Or(e.slice(a,c),t);s.push(d),a=c}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Kd(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ll(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],r=[];return e.length=Ud(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,r),new Hi(e,"XY",r)}getType(){return"Polygon"}intersectsExtent(t){return Xd(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const r=Fd(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=r.length===0?0:r[r.length-1],this.changed()}}function Tf(i){if(mo(i))throw new Error("Cannot create polygon from empty extent");const t=i[0],e=i[1],r=i[2],s=i[3],a=[t,e,t,s,r,s,r,e,t,e];return new Hi(a,"XY",[a.length])}function fT(i,t,e){t=t||32;const r=i.getStride(),s=i.getLayout(),a=i.getCenter(),u=r*(t+1),h=new Array(u);for(let g=0;g<u;g+=r){h[g]=0,h[g+1]=0;for(let y=2;y<r;y++)h[g+y]=a[y]}const c=[h.length],d=new Hi(h,s,c);return Pw(d,a,i.getRadius()),d}function Pw(i,t,e,r){const s=i.getFlatCoordinates(),a=i.getStride(),u=s.length/a-1,h=0;for(let c=0;c<=u;++c){const d=c*a,g=h+ri(c,u)*2*Math.PI/u;s[d]=t[0]+e*Math.cos(g),s[d+1]=t[1]+e*Math.sin(g)}i.changed()}function ou(i,t,e,r){const s=Tt(t)/e[0],a=ke(t)/e[1];return r?Math.min(i,Math.max(s,a)):Math.min(i,Math.min(s,a))}function au(i,t,e){let r=Math.min(i,t);const s=50;return r*=Math.log(1+s*Math.max(0,i/t-1))/s+1,e&&(r=Math.max(r,e),r/=Math.log(1+s*Math.max(0,e/i-1))/s+1),Dt(r,e/2,t*2)}function Dw(i,t,e,r){return t=t!==void 0?t:!0,function(s,a,u,h){if(s!==void 0){const c=i[0],d=i[i.length-1],g=e?ou(c,e,u,r):c;if(h)return t?au(s,g,d):Dt(s,d,g);const y=Math.min(g,s),v=Math.floor(Kl(i,y,a));return i[v]>g&&v<i.length-1?i[v+1]:i[v]}}}function Fw(i,t,e,r,s,a){return r=r!==void 0?r:!0,e=e!==void 0?e:0,function(u,h,c,d){if(u!==void 0){const g=s?ou(t,s,c,a):t;if(d)return r?au(u,g,e):Dt(u,e,g);const y=1e-9,v=Math.ceil(Math.log(t/g)/Math.log(i)-y),C=-h*(.5-y)+.5,T=Math.min(g,u),A=Math.floor(Math.log(t/T)/Math.log(i)+C),b=Math.max(v,A),F=t/Math.pow(i,b);return Dt(F,e,g)}}}function If(i,t,e,r,s){return e=e!==void 0?e:!0,function(a,u,h,c){if(a!==void 0){const d=r?ou(i,r,h,s):i;return!e||!c?Dt(a,t,d):au(a,d,t)}}}function lu(i){if(i!==void 0)return 0}function Af(i){if(i!==void 0)return i}function Nw(i){const t=2*Math.PI/i;return function(e,r){if(r)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function zw(i){const t=Gn(5);return function(e,r){return r||e===void 0?e:Math.abs(e)<=t?0:e}}const Gw=42,uu=256,Ja=0;class En extends Rn{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Ql(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&fw(),t.center&&(t.center=mn(t.center,this.projection_)),t.extent&&(t.extent=ni(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const h in je)delete e[h];this.setProperties(e,!0);const r=Ww(t);this.maxResolution_=r.maxResolution,this.minResolution_=r.minResolution,this.zoomFactor_=r.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=r.minZoom;const s=Uw(t),a=r.constraint,u=kw(t);this.constraints_={center:s,resolution:a,rotation:u},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const r=this.getCenterInternal();if(r){const s=t||[0,0,0,0];e=e||[0,0,0,0];const a=this.getResolution(),u=a/2*(s[3]-e[3]+e[1]-s[1]),h=a/2*(s[0]-e[0]+e[2]-s[2]);this.setCenterInternal([r[0]+u,r[1]-h])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let r=0;r<e.length;++r){let s=arguments[r];s.center&&(s=Object.assign({},s),s.center=mn(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=mn(s.anchor,this.getProjection())),e[r]=s}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,r;e>1&&typeof arguments[e-1]=="function"&&(r=arguments[e-1],--e);let s=0;for(;s<e&&!this.isDef();++s){const g=arguments[s];g.center&&this.setCenterInternal(g.center),g.zoom!==void 0?this.setZoom(g.zoom):g.resolution&&this.setResolution(g.resolution),g.rotation!==void 0&&this.setRotation(g.rotation)}if(s===e){r&&Ws(r,!0);return}let a=Date.now(),u=this.targetCenter_.slice(),h=this.targetResolution_,c=this.targetRotation_;const d=[];for(;s<e;++s){const g=arguments[s],y={start:a,complete:!1,anchor:g.anchor,duration:g.duration!==void 0?g.duration:1e3,easing:g.easing||UE,callback:r};if(g.center&&(y.sourceCenter=u,y.targetCenter=g.center.slice(),u=y.targetCenter),g.zoom!==void 0?(y.sourceResolution=h,y.targetResolution=this.getResolutionForZoom(g.zoom),h=y.targetResolution):g.resolution&&(y.sourceResolution=h,y.targetResolution=g.resolution,h=y.targetResolution),g.rotation!==void 0){y.sourceRotation=c;const v=ri(g.rotation-c+Math.PI,2*Math.PI)-Math.PI;y.targetRotation=c+v,c=y.targetRotation}Xw(y)?y.complete=!0:a+=y.duration,d.push(y)}this.animations_.push(d),this.setHint(Ue.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[Ue.ANIMATING]>0}getInteracting(){return this.hints_[Ue.INTERACTING]>0}cancelAnimations(){this.setHint(Ue.ANIMATING,-this.hints_[Ue.ANIMATING]);let t;for(let e=0,r=this.animations_.length;e<r;++e){const s=this.animations_[e];if(s[0].callback&&Ws(s[0].callback,!1),!t)for(let a=0,u=s.length;a<u;++a){const h=s[a];if(!h.complete){t=h.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let r=this.animations_.length-1;r>=0;--r){const s=this.animations_[r];let a=!0;for(let u=0,h=s.length;u<h;++u){const c=s[u];if(c.complete)continue;const d=t-c.start;let g=c.duration>0?d/c.duration:1;g>=1?(c.complete=!0,g=1):a=!1;const y=c.easing(g);if(c.sourceCenter){const v=c.sourceCenter[0],C=c.sourceCenter[1],T=c.targetCenter[0],A=c.targetCenter[1];this.nextCenter_=c.targetCenter;const b=v+y*(T-v),F=C+y*(A-C);this.targetCenter_=[b,F]}if(c.sourceResolution&&c.targetResolution){const v=y===1?c.targetResolution:c.sourceResolution+y*(c.targetResolution-c.sourceResolution);if(c.anchor){const C=this.getViewportSize_(this.getRotation()),T=this.constraints_.resolution(v,0,C,!0);this.targetCenter_=this.calculateCenterZoom(T,c.anchor)}this.nextResolution_=c.targetResolution,this.targetResolution_=v,this.applyTargetState_(!0)}if(c.sourceRotation!==void 0&&c.targetRotation!==void 0){const v=y===1?ri(c.targetRotation+Math.PI,2*Math.PI)-Math.PI:c.sourceRotation+y*(c.targetRotation-c.sourceRotation);if(c.anchor){const C=this.constraints_.rotation(v,!0);this.targetCenter_=this.calculateCenterRotate(C,c.anchor)}this.nextRotation_=c.targetRotation,this.targetRotation_=v}if(this.applyTargetState_(!0),e=!0,!c.complete)break}if(a){this.animations_[r]=null,this.setHint(Ue.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const u=s[0].callback;u&&Ws(u,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let r;const s=this.getCenterInternal();return s!==void 0&&(r=[s[0]-e[0],s[1]-e[1]],Vl(r,t-this.getRotation()),DE(r,e)),r}calculateCenterZoom(t,e){let r;const s=this.getCenterInternal(),a=this.getResolution();if(s!==void 0&&a!==void 0){const u=e[0]-t*(e[0]-s[0])/a,h=e[1]-t*(e[1]-s[1])/a;r=[u,h]}return r}getViewportSize_(t){const e=this.viewportSize_;if(t){const r=e[0],s=e[1];return[Math.abs(r*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(r*Math.sin(t))+Math.abs(s*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&bl(t,this.getProjection())}getCenterInternal(){return this.get(je.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return pw(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();wt(e,"The view center is not defined");const r=this.getResolution();wt(r!==void 0,"The view resolution is not defined");const s=this.getRotation();return wt(s!==void 0,"The view rotation is not defined"),xl(e,r,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(je.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(ni(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const r=Tt(t)/e[0],s=ke(t)/e[1];return Math.max(r,s)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),r=this.minResolution_,s=Math.log(e/r)/Math.log(t);return function(a){return e/Math.pow(t,a*s)}}getRotation(){return this.get(je.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),r=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,a=Math.log(r/s)/e;return function(u){return Math.log(r/u)/e/a}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const r=this.padding_;return r&&(e=[e[0]-r[1]-r[3],e[1]-r[0]-r[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),r=this.getRotation();let s=this.getCenterInternal();const a=this.padding_;if(a){const u=this.getViewportSizeMinusPadding_();s=Qa(s,this.getViewportSize_(),[u[0]/2+a[3],u[1]/2+a[0]],e,r)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:r,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,r,s;if(this.resolutions_){const a=Kl(this.resolutions_,t,1);e=a,r=this.resolutions_[a],a==this.resolutions_.length-1?s=2:s=r/this.resolutions_[a+1]}else r=this.maxResolution_,s=this.zoomFactor_;return e+Math.log(r/t)/Math.log(s)}getResolutionForZoom(t){var e;if((e=this.resolutions_)!=null&&e.length){if(this.resolutions_.length===1)return this.resolutions_[0];const r=Dt(Math.floor(t),0,this.resolutions_.length-2),s=this.resolutions_[r]/this.resolutions_[r+1];return this.resolutions_[r]/Math.pow(s,Dt(t-r,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let r;if(wt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){wt(!mo(t),"Cannot fit empty extent provided as `geometry`");const s=ni(t,this.getProjection());r=Tf(s)}else if(t.getType()==="Circle"){const s=ni(t.getExtent(),this.getProjection());r=Tf(s),r.rotate(this.getRotation(),Zi(s))}else r=t;this.fitInternal(r,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),r=Math.cos(e),s=Math.sin(-e),a=t.getFlatCoordinates(),u=t.getStride();let h=1/0,c=1/0,d=-1/0,g=-1/0;for(let y=0,v=a.length;y<v;y+=u){const C=a[y]*r-a[y+1]*s,T=a[y]*s+a[y+1]*r;h=Math.min(h,C),c=Math.min(c,T),d=Math.max(d,C),g=Math.max(g,T)}return[h,c,d,g]}fitInternal(t,e){e=e||{};let r=e.size;r||(r=this.getViewportSizeMinusPadding_());const s=e.padding!==void 0?e.padding:[0,0,0,0],a=e.nearest!==void 0?e.nearest:!1;let u;e.minResolution!==void 0?u=e.minResolution:e.maxZoom!==void 0?u=this.getResolutionForZoom(e.maxZoom):u=0;const h=this.rotatedExtentForGeometry(t);let c=this.getResolutionForExtentInternal(h,[r[0]-s[1]-s[3],r[1]-s[0]-s[2]]);c=isNaN(c)?u:Math.max(c,u),c=this.getConstrainedResolution(c,a?0:1);const d=this.getRotation(),g=Math.sin(d),y=Math.cos(d),v=Zi(h);v[0]+=(s[1]-s[3])/2*c,v[1]+=(s[0]-s[2])/2*c;const C=v[0]*y-v[1]*g,T=v[1]*y+v[0]*g,A=this.getConstrainedCenter([C,T],c),b=e.callback?e.callback:js;e.duration!==void 0?this.animateInternal({resolution:c,center:A,duration:e.duration,easing:e.easing},b):(this.targetResolution_=c,this.targetCenter_=A,this.applyTargetState_(!1,!0),Ws(b,!0))}centerOn(t,e,r){this.centerOnInternal(mn(t,this.getProjection()),e,r)}centerOnInternal(t,e,r){this.setCenterInternal(Qa(t,e,r,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,r,s){let a;const u=this.padding_;if(u&&t){const h=this.getViewportSizeMinusPadding_(-r),c=Qa(t,s,[h[0]/2+u[3],h[1]/2+u[0]],e,r);a=[t[0]-c[0],t[1]-c[1]]}return a}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=bl(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&mn(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const r=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),a=this.constraints_.resolution(this.targetResolution_*t,0,s,r);e&&(this.targetCenter_=this.calculateCenterZoom(a,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=mn(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const r=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,r);e&&(this.targetCenter_=this.calculateCenterRotate(s,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&mn(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const r=this.getAnimating()||this.getInteracting()||e,s=this.constraints_.rotation(this.targetRotation_,r),a=this.getViewportSize_(s),u=this.constraints_.resolution(this.targetResolution_,0,a,r),h=this.constraints_.center(this.targetCenter_,u,a,r,this.calculateCenterShift(this.targetCenter_,u,s,a));this.get(je.ROTATION)!==s&&this.set(je.ROTATION,s),this.get(je.RESOLUTION)!==u&&(this.set(je.RESOLUTION,u),this.set("zoom",this.getZoom(),!0)),(!h||!this.get(je.CENTER)||!to(this.get(je.CENTER),h))&&this.set(je.CENTER,h),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,r){t=t!==void 0?t:200;const s=e||0,a=this.constraints_.rotation(this.targetRotation_),u=this.getViewportSize_(a),h=this.constraints_.resolution(this.targetResolution_,s,u),c=this.constraints_.center(this.targetCenter_,h,u,!1,this.calculateCenterShift(this.targetCenter_,h,a,u));if(t===0&&!this.cancelAnchor_){this.targetResolution_=h,this.targetRotation_=a,this.targetCenter_=c,this.applyTargetState_();return}r=r||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==h||this.getRotation()!==a||!this.getCenterInternal()||!to(this.getCenterInternal(),c))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:a,center:c,resolution:h,duration:t,easing:ji,anchor:r}))}beginInteraction(){this.resolveConstraints(0),this.setHint(Ue.INTERACTING,1)}endInteraction(t,e,r){r=r&&mn(r,this.getProjection()),this.endInteractionInternal(t,e,r)}endInteractionInternal(t,e,r){this.getInteracting()&&(this.setHint(Ue.INTERACTING,-1),this.resolveConstraints(t,e,r))}getConstrainedCenter(t,e){const r=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),r)}getConstrainedZoom(t,e){const r=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(r,e))}getConstrainedResolution(t,e){e=e||0;const r=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,r)}}function Ws(i,t){setTimeout(function(){i(t)},0)}function Uw(i){if(i.extent!==void 0){const e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return lf(i.extent,i.constrainOnlyCenter,e)}const t=Ql(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,lf(e,!1,!1)}return CE}function Ww(i){let t,e,r,u=i.minZoom!==void 0?i.minZoom:Ja,h=i.maxZoom!==void 0?i.maxZoom:28;const c=i.zoomFactor!==void 0?i.zoomFactor:2,d=i.multiWorld!==void 0?i.multiWorld:!1,g=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,y=i.showFullExtent!==void 0?i.showFullExtent:!1,v=Ql(i.projection,"EPSG:3857"),C=v.getExtent();let T=i.constrainOnlyCenter,A=i.extent;if(!d&&!A&&v.isGlobal()&&(T=!1,A=C),i.resolutions!==void 0){const b=i.resolutions;e=b[u],r=b[h]!==void 0?b[h]:b[b.length-1],i.constrainResolution?t=Dw(b,g,!T&&A,y):t=If(e,r,g,!T&&A,y)}else{const F=(C?Math.max(Tt(C),ke(C)):360*Hl.degrees/v.getMetersPerUnit())/uu/Math.pow(2,Ja),z=F/Math.pow(2,28-Ja);e=i.maxResolution,e!==void 0?u=0:e=F/Math.pow(c,u),r=i.minResolution,r===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?r=e/Math.pow(c,h):r=F/Math.pow(c,h):r=z),h=u+Math.floor(Math.log(e/r)/Math.log(c)),r=e/Math.pow(c,h-u),i.constrainResolution?t=Fw(c,e,r,g,!T&&A,y):t=If(e,r,g,!T&&A,y)}return{constraint:t,maxResolution:e,minResolution:r,minZoom:u,zoomFactor:c}}function kw(i){if(i.enableRotation!==void 0?i.enableRotation:!0){const e=i.constrainRotation;return e===void 0||e===!0?zw():e===!1?Af:typeof e=="number"?Nw(e):Af}return lu}function Xw(i){return!(i.sourceCenter&&i.targetCenter&&!to(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function Qa(i,t,e,r,s){const a=Math.cos(-s);let u=Math.sin(-s),h=i[0]*a-i[1]*u,c=i[1]*a+i[0]*u;h+=(t[0]/2-e[0])*r,c+=(e[1]-t[1]/2)*r,u=-u;const d=h*a-c*u,g=c*a+h*u;return[d,g]}const ks="ol-hidden",Eo="ol-unselectable",hu="ol-control",bf="ol-collapsed",Kw=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z0-9]+?)\\s*$`].join(""),"i"),Lf=["style","variant","weight","size","lineHeight","family"],Bd=function(i){const t=i.match(Kw);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let r=0,s=Lf.length;r<s;++r){const a=t[r+1];a!==void 0&&(e[Lf[r]]=a)}return e.families=e.family.split(/,\s?/),e};function se(i,t,e,r){let s;return e&&e.length?s=e.shift():ud?s=new OffscreenCanvas(i||300,t||300):s=document.createElement("canvas"),i&&(s.width=i),t&&(s.height=t),s.getContext("2d",r)}let tl;function ro(){return tl||(tl=se(1,1)),tl}function cu(i){const t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}function Sf(i,t){const e=t.parentNode;e&&e.replaceChild(i,t)}function Bw(i){for(;i.lastChild;)i.lastChild.remove()}function Yw(i,t){const e=i.childNodes;for(let r=0;;++r){const s=e[r],a=t[r];if(!s&&!a)break;if(s!==a){if(!s){i.appendChild(a);continue}if(!a){i.removeChild(s),--r;continue}i.insertBefore(a,s)}}}class fu extends Rn{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){var t;(t=this.element)==null||t.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){var e;this.map_&&((e=this.element)==null||e.remove());for(let r=0,s=this.listenerKeys.length;r<s;++r)Pt(this.listenerKeys[r]);if(this.listenerKeys.length=0,this.map_=t,t){const r=this.target_??t.getOverlayContainerStopEvent();this.element&&r.appendChild(this.element),this.render!==js&&this.listenerKeys.push(mt(t,Nn.POSTRENDER,this.render,this)),t.render()}}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class Zw extends fu{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",r=t.tipLabel!==void 0?t.tipLabel:"Attributions",s=t.expandClassName!==void 0?t.expandClassName:e+"-expand",a=t.collapseLabel!==void 0?t.collapseLabel:"›",u=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof a=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=a,this.collapseLabel_.className=u):this.collapseLabel_=a;const h=t.label!==void 0?t.label:"i";typeof h=="string"?(this.label_=document.createElement("span"),this.label_.textContent=h,this.label_.className=s):this.label_=h;const c=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=r,this.toggleButton_.appendChild(c),this.toggleButton_.addEventListener(it.CLICK,this.handleClick_.bind(this),!1);const d=e+" "+Eo+" "+hu+(this.collapsed_&&this.collapsible_?" "+bf:"")+(this.collapsible_?"":" ol-uncollapsible"),g=this.element;g.className=d,g.appendChild(this.toggleButton_),g.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),r=new Set(e.flatMap(s=>s.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(s=>r.add(s)):r.add(this.attributions_)),!this.overrideCollapsible_){const s=!e.some(a=>{var u;return((u=a.getSource())==null?void 0:u.getAttributionsCollapsible())===!1});this.setCollapsible(s)}return Array.from(r)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(s=>hE(()=>s))),r=e.length>0;if(this.renderedVisible_!=r&&(this.element.style.display=r?"":"none",this.renderedVisible_=r),!ho(e,this.renderedAttributions_)){Bw(this.ulElement_);for(let s=0,a=e.length;s<a;++s){const u=document.createElement("li");u.innerHTML=e[s],this.ulElement_.appendChild(u)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(bf),this.collapsed_?Sf(this.collapseLabel_,this.label_):Sf(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class Vw extends fu{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",r=t.label!==void 0?t.label:"⇧",s=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof r=="string"?(this.label_=document.createElement("span"),this.label_.className=s,this.label_.textContent=r):(this.label_=r,this.label_.classList.add(s));const a=t.tipLabel?t.tipLabel:"Reset rotation",u=document.createElement("button");u.className=e+"-reset",u.setAttribute("type","button"),u.title=a,u.appendChild(this.label_),u.addEventListener(it.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+Eo+" "+hu,c=this.element;c.className=h,c.appendChild(u),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(ks)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const r=e.getRotation();r!==void 0&&(this.duration_>0&&r%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:ji}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const r=e.viewState.rotation;if(r!=this.rotation_){const s="rotate("+r+"rad)";if(this.autoHide_){const a=this.element.classList.contains(ks);!a&&r===0?this.element.classList.add(ks):a&&r!==0&&this.element.classList.remove(ks)}this.label_.style.transform=s}this.rotation_=r}}class Hw extends fu{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",r=t.delta!==void 0?t.delta:1,s=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",a=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",u=t.zoomInLabel!==void 0?t.zoomInLabel:"+",h=t.zoomOutLabel!==void 0?t.zoomOutLabel:"–",c=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",d=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",g=document.createElement("button");g.className=s,g.setAttribute("type","button"),g.title=c,g.appendChild(typeof u=="string"?document.createTextNode(u):u),g.addEventListener(it.CLICK,this.handleClick_.bind(this,r),!1);const y=document.createElement("button");y.className=a,y.setAttribute("type","button"),y.title=d,y.appendChild(typeof h=="string"?document.createTextNode(h):h),y.addEventListener(it.CLICK,this.handleClick_.bind(this,-r),!1);const v=e+" "+Eo+" "+hu,C=this.element;C.className=v,C.appendChild(g),C.appendChild(y),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const r=this.getMap().getView();if(!r)return;const s=r.getZoom();if(s!==void 0){const a=r.getConstrainedZoom(s+t);this.duration_>0?(r.getAnimating()&&r.cancelAnimations(),r.animate({zoom:a,duration:this.duration_,easing:ji})):r.setZoom(a)}}}function $w(i){i=i||{};const t=new sn;return(i.zoom!==void 0?i.zoom:!0)&&t.push(new Hw(i.zoomOptions)),(i.rotate!==void 0?i.rotate:!0)&&t.push(new Vw(i.rotateOptions)),(i.attribution!==void 0?i.attribution:!0)&&t.push(new Zw(i.attributionOptions)),t}class qw{constructor(t,e,r){this.decay_=t,this.minVelocity_=e,this.delay_=r,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let r=e-3;for(;r>0&&this.points_[r+2]>t;)r-=3;const s=this.points_[e+2]-this.points_[r+2];if(s<1e3/60)return!1;const a=this.points_[e]-this.points_[r],u=this.points_[e+1]-this.points_[r+1];return this.angle_=Math.atan2(u,a),this.initialVelocity_=Math.sqrt(a*a+u*u)/s,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}const Mf={ACTIVE:"active"};class Xr extends Rn{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(Mf.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(Mf.ACTIVE,t)}setMap(t){this.map_=t}}function jw(i,t,e){const r=i.getCenterInternal();if(r){const s=[r[0]+t[0],r[1]+t[1]];i.animateInternal({duration:e!==void 0?e:250,easing:WE,center:i.getConstrainedCenter(s)})}}function du(i,t,e,r){const s=i.getZoom();if(s===void 0)return;const a=i.getConstrainedZoom(s+t),u=i.getResolutionForZoom(a);i.getAnimating()&&i.cancelAnimations(),i.animate({resolution:u,anchor:e,duration:r!==void 0?r:250,easing:ji})}class Jw extends Xr{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==xt.DBLCLICK){const r=t.originalEvent,s=t.map,a=t.coordinate,u=r.shiftKey?-this.delta_:this.delta_,h=s.getView();du(h,u,a,this.duration_),r.preventDefault(),e=!0}return!e}}function Sl(i){const t=arguments;return function(e){let r=!0;for(let s=0,a=t.length;s<a&&(r=r&&t[s](e),!!r);++s);return r}}const dT=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},Qw=function(i){const t=i.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},tR=function(i){const t=i.map.getTargetElement(),e=t.getRootNode(),r=i.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(r):t.contains(r)},Yd=function(i){const t=i.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?tR(i):!0},eR=qs,gT=function(i){return i.type==xt.CLICK},Zd=function(i){const t=i.originalEvent;return t instanceof PointerEvent&&t.button==0&&!(gE&&Bl&&t.ctrlKey)},_T=Nr,pT=function(i){return i.type==xt.SINGLECLICK},Vd=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},mT=function(i){const t=i.originalEvent;return!t.altKey&&(Bl?t.metaKey:t.ctrlKey)&&!t.shiftKey},nR=function(i){const t=i.originalEvent;return Bl?t.metaKey:t.ctrlKey},iR=function(i){const t=i.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},Hd=function(i){const t=i.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},el=function(i){const t=i.originalEvent;return t instanceof PointerEvent&&t.pointerType=="mouse"},rR=function(i){const t=i.originalEvent;return t instanceof PointerEvent&&t.isPrimary&&t.button===0};class Kr extends Xr{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==xt.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==xt.POINTERUP){const r=this.handleUpEvent(t);this.handlingDownUpSequence=r&&this.targetPointers.length>0}}else if(t.type==xt.POINTERDOWN){const r=this.handleDownEvent(t);this.handlingDownUpSequence=r,e=this.stopDown(r)}else t.type==xt.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function gu(i){const t=i.length;let e=0,r=0;for(let s=0;s<t;s++)e+=i[s].clientX,r+=i[s].clientY;return{clientX:e/t,clientY:r/t}}class sR extends Kr{constructor(t){super({stopDown:Nr}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:Sl(Vd,rR);this.condition_=t.onFocusOnly?Sl(Yd,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const r=this.targetPointers,s=e.getEventPixel(gu(r));if(r.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(s[0],s[1]),this.lastCentroid){const a=[this.lastCentroid[0]-s[0],s[1]-this.lastCentroid[1]],h=t.map.getView();NE(a,h.getResolution()),Vl(a,h.getRotation()),h.adjustCenterInternal(a)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=s,this.lastPointersCount_=r.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,r=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const s=this.kinetic_.getDistance(),a=this.kinetic_.getAngle(),u=r.getCenterInternal(),h=e.getPixelFromCoordinateInternal(u),c=e.getCoordinateFromPixelInternal([h[0]-s*Math.cos(a),h[1]-s*Math.sin(a)]);r.animateInternal({center:r.getConstrainedCenter(c),duration:500,easing:ji})}return this.panning_&&(this.panning_=!1,r.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const r=t.map.getView();return this.lastCentroid=null,r.getAnimating()&&r.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class oR extends Kr{constructor(t){t=t||{},super({stopDown:Nr}),this.condition_=t.condition?t.condition:Qw,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!el(t))return;const e=t.map,r=e.getView();if(r.getConstraints().rotation===lu)return;const s=e.getSize(),a=t.pixel,u=Math.atan2(s[1]/2-a[1],a[0]-s[0]/2);if(this.lastAngle_!==void 0){const h=u-this.lastAngle_;r.adjustRotationInternal(-h)}this.lastAngle_=u}handleUpEvent(t){return el(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return el(t)&&Zd(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class aR extends uo{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,r="px",s=this.element_.style;s.left=Math.min(t[0],e[0])+r,s.top=Math.min(t[1],e[1])+r,s.width=Math.abs(e[0]-t[0])+r,s.height=Math.abs(e[1]-t[1])+r}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,s=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);s[4]=s[0].slice(),this.geometry_?this.geometry_.setCoordinates([s]):this.geometry_=new Hi([s])}getGeometry(){return this.geometry_}}const Mi={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class mr extends Un{constructor(t,e,r){super(t),this.coordinate=e,this.mapBrowserEvent=r}}class lR extends Kr{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new aR(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??Zd,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,r){const s=r[0]-e[0],a=r[1]-e[1];return s*s+a*a>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new mr(Mi.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new mr(e?Mi.BOXEND:Mi.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new mr(Mi.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new mr(Mi.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new mr(Mi.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class uR extends lR{constructor(t){t=t||{};const e=t.condition?t.condition:iR;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const r=this.getMap().getView();let s=this.getGeometry();if(this.out_){const a=r.rotatedExtentForGeometry(s),u=r.getResolutionForExtentInternal(a),h=r.getResolution()/u;s=s.clone(),s.scale(h*h)}r.fitInternal(s,{duration:this.duration_,easing:ji})}}const Qn={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class hR extends Xr{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return Vd(e)&&Hd(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==it.KEYDOWN){const r=t.originalEvent,s=r.key;if(this.condition_(t)&&(s==Qn.DOWN||s==Qn.LEFT||s==Qn.RIGHT||s==Qn.UP)){const u=t.map.getView(),h=u.getResolution()*this.pixelDelta_;let c=0,d=0;s==Qn.DOWN?d=-h:s==Qn.LEFT?c=-h:s==Qn.RIGHT?c=h:d=h;const g=[c,d];Vl(g,u.getRotation()),jw(u,g,this.duration_),r.preventDefault(),e=!0}}return!e}}class cR extends Xr{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!nR(e)&&Hd(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==it.KEYDOWN||t.type==it.KEYPRESS){const r=t.originalEvent,s=r.key;if(this.condition_(t)&&(s==="+"||s==="-")){const a=t.map,u=s==="+"?this.delta_:-this.delta_,h=a.getView();du(h,u,void 0,this.duration_),r.preventDefault(),e=!0}}return!e}}class fR extends Xr{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:eR;this.condition_=t.onFocusOnly?Sl(Yd,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null)}handleEvent(t){if(!this.condition_(t)||t.type!==it.WHEEL)return!0;const r=t.map,s=t.originalEvent;s.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.pixel);let a;if(t.type==it.WHEEL&&(a=s.deltaY,s.deltaMode===WheelEvent.DOM_DELTA_LINE&&(a*=40)),a===0)return!1;this.lastDelta_=a;const u=Date.now();this.startTime_===void 0&&(this.startTime_=u),(!this.mode_||u-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(a)<4?"trackpad":"wheel");const h=r.getView();if(this.mode_==="trackpad"&&!(h.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(h.getAnimating()&&h.cancelAnimations(),h.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),h.adjustZoom(-a/this.deltaPerZoom_,this.lastAnchor_?r.getCoordinateFromPixel(this.lastAnchor_):null),this.startTime_=u,!1;this.totalDelta_+=a;const c=Math.max(this.timeout_-(u-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,r),c),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let r=-Dt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(r=r?r>0?1:-1:0),du(e,r,this.lastAnchor_?t.getCoordinateFromPixel(this.lastAnchor_):null,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class dR extends Kr{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Nr),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const r=this.targetPointers[0],s=this.targetPointers[1],a=Math.atan2(s.clientY-r.clientY,s.clientX-r.clientX);if(this.lastAngle_!==void 0){const c=a-this.lastAngle_;this.rotationDelta_+=c,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=c}this.lastAngle_=a;const u=t.map,h=u.getView();h.getConstraints().rotation!==lu&&(this.anchor_=u.getCoordinateFromPixelInternal(u.getEventPixel(gu(this.targetPointers))),this.rotating_&&(u.render(),h.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class gR extends Kr{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Nr),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const r=this.targetPointers[0],s=this.targetPointers[1],a=r.clientX-s.clientX,u=r.clientY-s.clientY,h=Math.sqrt(a*a+u*u);this.lastDistance_!==void 0&&(e=this.lastDistance_/h),this.lastDistance_=h;const c=t.map,d=c.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=c.getCoordinateFromPixelInternal(c.getEventPixel(gu(this.targetPointers))),c.render(),d.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const r=t.map.getView(),s=this.lastScaleDelta_>1?1:-1;return r.endInteraction(this.duration_,s),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function _R(i){i=i||{};const t=new sn,e=new qw(-.005,.05,100);return(i.altShiftDragRotate!==void 0?i.altShiftDragRotate:!0)&&t.push(new oR),(i.doubleClickZoom!==void 0?i.doubleClickZoom:!0)&&t.push(new Jw({delta:i.zoomDelta,duration:i.zoomDuration})),(i.dragPan!==void 0?i.dragPan:!0)&&t.push(new sR({onFocusOnly:i.onFocusOnly,kinetic:e})),(i.pinchRotate!==void 0?i.pinchRotate:!0)&&t.push(new dR),(i.pinchZoom!==void 0?i.pinchZoom:!0)&&t.push(new gR({duration:i.zoomDuration})),(i.keyboard!==void 0?i.keyboard:!0)&&(t.push(new hR),t.push(new cR({delta:i.zoomDelta,duration:i.zoomDuration}))),(i.mouseWheelZoom!==void 0?i.mouseWheelZoom:!0)&&t.push(new fR({onFocusOnly:i.onFocusOnly,duration:i.zoomDuration})),(i.shiftDragZoom!==void 0?i.shiftDragZoom:!0)&&t.push(new uR({duration:i.zoomDuration})),t}const pt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class $d extends Rn{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[pt.OPACITY]=t.opacity!==void 0?t.opacity:1,wt(typeof e[pt.OPACITY]=="number","Layer opacity must be a number"),e[pt.VISIBLE]=t.visible!==void 0?t.visible:!0,e[pt.Z_INDEX]=t.zIndex,e[pt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[pt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[pt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[pt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},r=this.getZIndex();return e.opacity=Dt(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=r===void 0&&!e.managed?1/0:r,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return ct()}getLayerStatesArray(t){return ct()}getExtent(){return this.get(pt.EXTENT)}getMaxResolution(){return this.get(pt.MAX_RESOLUTION)}getMinResolution(){return this.get(pt.MIN_RESOLUTION)}getMinZoom(){return this.get(pt.MIN_ZOOM)}getMaxZoom(){return this.get(pt.MAX_ZOOM)}getOpacity(){return this.get(pt.OPACITY)}getSourceState(){return ct()}getVisible(){return this.get(pt.VISIBLE)}getZIndex(){return this.get(pt.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(pt.EXTENT,t)}setMaxResolution(t){this.set(pt.MAX_RESOLUTION,t)}setMinResolution(t){this.set(pt.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(pt.MAX_ZOOM,t)}setMinZoom(t){this.set(pt.MIN_ZOOM,t)}setOpacity(t){wt(typeof t=="number","Layer opacity must be a number"),this.set(pt.OPACITY,t)}setVisible(t){this.set(pt.VISIBLE,t)}setZIndex(t){this.set(pt.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}class zn extends Un{constructor(t,e){super(t),this.layer=e}}const nl={LAYERS:"layers"};let $i=class qd extends $d{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let r=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(nl.LAYERS,this.handleLayersChanged_),r?Array.isArray(r)?r=new sn(r.slice(),{unique:!0}):wt(typeof r.getArray=="function","Expected `layers` to be an array or a `Collection`"):r=new sn(void 0,{unique:!0}),this.setLayers(r)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(Pt),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(mt(t,We.ADD,this.handleLayersAdd_,this),mt(t,We.REMOVE,this.handleLayersRemove_,this));for(const r in this.listenerKeys_)this.listenerKeys_[r].forEach(Pt);zr(this.listenerKeys_);const e=t.getArray();for(let r=0,s=e.length;r<s;r++){const a=e[r];this.registerLayerListeners_(a),this.dispatchEvent(new zn("addlayer",a))}this.changed()}registerLayerListeners_(t){const e=[mt(t,Lr.PROPERTYCHANGE,this.handleLayerChange_,this),mt(t,it.CHANGE,this.handleLayerChange_,this)];t instanceof qd&&e.push(mt(t,"addlayer",this.handleLayerGroupAdd_,this),mt(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[te(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new zn("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new zn("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new zn("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,r=te(e);this.listenerKeys_[r].forEach(Pt),delete this.listenerKeys_[r],this.dispatchEvent(new zn("removelayer",e)),this.changed()}getLayers(){return this.get(nl.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const r=e.getArray();for(let s=0,a=r.length;s<a;++s)this.dispatchEvent(new zn("removelayer",r[s]))}this.set(nl.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],r=e.length;this.getLayers().forEach(function(u){u.getLayerStatesArray(e)});const s=this.getLayerState();let a=s.zIndex;!t&&s.zIndex===void 0&&(a=0);for(let u=r,h=e.length;u<h;u++){const c=e[u];c.opacity*=s.opacity,c.visible=c.visible&&s.visible,c.maxResolution=Math.min(c.maxResolution,s.maxResolution),c.minResolution=Math.max(c.minResolution,s.minResolution),c.minZoom=Math.max(c.minZoom,s.minZoom),c.maxZoom=Math.min(c.maxZoom,s.maxZoom),s.extent!==void 0&&(c.extent!==void 0?c.extent=si(c.extent,s.extent):c.extent=s.extent),c.zIndex===void 0&&(c.zIndex=a)}return e}getSourceState(){return"ready"}};const on={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"};class wo extends $d{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(pt.SOURCE,this.handleSourcePropertyChange_);const r=t.source?t.source:null;this.setSource(r)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(pt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(Pt(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=mt(t,it.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0)),this.clearRenderer()),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const r=this.getMapInternal();!t&&r&&(t=r.getView()),t instanceof En?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&r&&(e.layerStatesArray=r.getLayerGroup().getLayerStatesArray());let s;if(e.layerStatesArray){if(s=e.layerStatesArray.find(u=>u.layer===this),!s)return!1}else s=this.getLayerState();const a=this.getExtent();return _u(s,e.viewState)&&(!a||Wr(a,e.extent))}getAttributions(t){var a;if(!this.isVisible(t))return[];const e=(a=this.getSource())==null?void 0:a.getAttributions();if(!e)return[];const r=t instanceof En?t.getViewStateAndExtent():t;let s=e(r);return Array.isArray(s)||(s=[s]),s}render(t,e){const r=this.getRenderer();return r.prepareFrame(t)?(this.rendered=!0,r.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(pt.MAP,t)}getMapInternal(){return this.get(pt.MAP)}setMap(t){this.mapPrecomposeKey_&&(Pt(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Pt(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=mt(t,on.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=mt(this,it.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,r=this.getLayerState(!1);wt(!e.some(s=>s.layer===r.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(r)}setSource(t){this.set(pt.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function _u(i,t){if(!i.visible)return!1;const e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;const r=t.zoom;return r>i.minZoom&&r<=i.maxZoom}function jd(i,t,e=0,r=i.length-1,s=pR){for(;r>e;){if(r-e>600){const c=r-e+1,d=t-e+1,g=Math.log(c),y=.5*Math.exp(2*g/3),v=.5*Math.sqrt(g*y*(c-y)/c)*(d-c/2<0?-1:1),C=Math.max(e,Math.floor(t-d*y/c+v)),T=Math.min(r,Math.floor(t+(c-d)*y/c+v));jd(i,t,C,T,s)}const a=i[t];let u=e,h=r;for(yr(i,e,t),s(i[r],a)>0&&yr(i,e,r);u<h;){for(yr(i,u,h),u++,h--;s(i[u],a)<0;)u++;for(;s(i[h],a)>0;)h--}s(i[e],a)===0?yr(i,e,h):(h++,yr(i,h,r)),h<=t&&(e=h+1),t<=h&&(r=h-1)}}function yr(i,t,e){const r=i[t];i[t]=i[e],i[e]=r}function pR(i,t){return i<t?-1:i>t?1:0}let mR=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const r=[];if(!Ks(t,e))return r;const s=this.toBBox,a=[];for(;e;){for(let u=0;u<e.children.length;u++){const h=e.children[u],c=e.leaf?s(h):h;Ks(t,c)&&(e.leaf?r.push(h):rl(t,c)?this._all(h,r):a.push(h))}e=a.pop()}return r}collides(t){let e=this.data;if(!Ks(t,e))return!1;const r=[];for(;e;){for(let s=0;s<e.children.length;s++){const a=e.children[s],u=e.leaf?this.toBBox(a):a;if(Ks(t,u)){if(e.leaf||rl(t,u))return!0;r.push(a)}}e=r.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let r=0;r<t.length;r++)this.insert(t[r]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const r=this.data;this.data=e,e=r}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=zi([]),this}remove(t,e){if(!t)return this;let r=this.data;const s=this.toBBox(t),a=[],u=[];let h,c,d;for(;r||a.length;){if(r||(r=a.pop(),c=a[a.length-1],h=u.pop(),d=!0),r.leaf){const g=yR(t,r.children,e);if(g!==-1)return r.children.splice(g,1),a.push(r),this._condense(a),this}!d&&!r.leaf&&rl(r,s)?(a.push(r),u.push(h),h=0,c=r,r=r.children[0]):c?(h++,r=c.children[h],d=!1):r=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const r=[];for(;t;)t.leaf?e.push(...t.children):r.push(...t.children),t=r.pop();return e}_build(t,e,r,s){const a=r-e+1;let u=this._maxEntries,h;if(a<=u)return h=zi(t.slice(e,r+1)),Oi(h,this.toBBox),h;s||(s=Math.ceil(Math.log(a)/Math.log(u)),u=Math.ceil(a/Math.pow(u,s-1))),h=zi([]),h.leaf=!1,h.height=s;const c=Math.ceil(a/u),d=c*Math.ceil(Math.sqrt(u));Of(t,e,r,d,this.compareMinX);for(let g=e;g<=r;g+=d){const y=Math.min(g+d-1,r);Of(t,g,y,c,this.compareMinY);for(let v=g;v<=y;v+=c){const C=Math.min(v+c-1,y);h.children.push(this._build(t,v,C,s-1))}}return Oi(h,this.toBBox),h}_chooseSubtree(t,e,r,s){for(;s.push(e),!(e.leaf||s.length-1===r);){let a=1/0,u=1/0,h;for(let c=0;c<e.children.length;c++){const d=e.children[c],g=il(d),y=wR(t,d)-g;y<u?(u=y,a=g<a?g:a,h=d):y===u&&g<a&&(a=g,h=d)}e=h||e.children[0]}return e}_insert(t,e,r){const s=r?t:this.toBBox(t),a=[],u=this._chooseSubtree(s,this.data,e,a);for(u.children.push(t),Cr(u,s);e>=0&&a[e].children.length>this._maxEntries;)this._split(a,e),e--;this._adjustParentBBoxes(s,a,e)}_split(t,e){const r=t[e],s=r.children.length,a=this._minEntries;this._chooseSplitAxis(r,a,s);const u=this._chooseSplitIndex(r,a,s),h=zi(r.children.splice(u,r.children.length-u));h.height=r.height,h.leaf=r.leaf,Oi(r,this.toBBox),Oi(h,this.toBBox),e?t[e-1].children.push(h):this._splitRoot(r,h)}_splitRoot(t,e){this.data=zi([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Oi(this.data,this.toBBox)}_chooseSplitIndex(t,e,r){let s,a=1/0,u=1/0;for(let h=e;h<=r-e;h++){const c=Rr(t,0,h,this.toBBox),d=Rr(t,h,r,this.toBBox),g=RR(c,d),y=il(c)+il(d);g<a?(a=g,s=h,u=y<u?y:u):g===a&&y<u&&(u=y,s=h)}return s||r-e}_chooseSplitAxis(t,e,r){const s=t.leaf?this.compareMinX:vR,a=t.leaf?this.compareMinY:ER,u=this._allDistMargin(t,e,r,s),h=this._allDistMargin(t,e,r,a);u<h&&t.children.sort(s)}_allDistMargin(t,e,r,s){t.children.sort(s);const a=this.toBBox,u=Rr(t,0,e,a),h=Rr(t,r-e,r,a);let c=Xs(u)+Xs(h);for(let d=e;d<r-e;d++){const g=t.children[d];Cr(u,t.leaf?a(g):g),c+=Xs(u)}for(let d=r-e-1;d>=e;d--){const g=t.children[d];Cr(h,t.leaf?a(g):g),c+=Xs(h)}return c}_adjustParentBBoxes(t,e,r){for(let s=r;s>=0;s--)Cr(e[s],t)}_condense(t){for(let e=t.length-1,r;e>=0;e--)t[e].children.length===0?e>0?(r=t[e-1].children,r.splice(r.indexOf(t[e]),1)):this.clear():Oi(t[e],this.toBBox)}};function yR(i,t,e){if(!e)return t.indexOf(i);for(let r=0;r<t.length;r++)if(e(i,t[r]))return r;return-1}function Oi(i,t){Rr(i,0,i.children.length,t,i)}function Rr(i,t,e,r,s){s||(s=zi(null)),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let a=t;a<e;a++){const u=i.children[a];Cr(s,i.leaf?r(u):u)}return s}function Cr(i,t){return i.minX=Math.min(i.minX,t.minX),i.minY=Math.min(i.minY,t.minY),i.maxX=Math.max(i.maxX,t.maxX),i.maxY=Math.max(i.maxY,t.maxY),i}function vR(i,t){return i.minX-t.minX}function ER(i,t){return i.minY-t.minY}function il(i){return(i.maxX-i.minX)*(i.maxY-i.minY)}function Xs(i){return i.maxX-i.minX+(i.maxY-i.minY)}function wR(i,t){return(Math.max(t.maxX,i.maxX)-Math.min(t.minX,i.minX))*(Math.max(t.maxY,i.maxY)-Math.min(t.minY,i.minY))}function RR(i,t){const e=Math.max(i.minX,t.minX),r=Math.max(i.minY,t.minY),s=Math.min(i.maxX,t.maxX),a=Math.min(i.maxY,t.maxY);return Math.max(0,s-e)*Math.max(0,a-r)}function rl(i,t){return i.minX<=t.minX&&i.minY<=t.minY&&t.maxX<=i.maxX&&t.maxY<=i.maxY}function Ks(i,t){return t.minX<=i.maxX&&t.minY<=i.maxY&&t.maxX>=i.minX&&t.maxY>=i.minY}function zi(i){return{children:i,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Of(i,t,e,r,s){const a=[t,e];for(;a.length;){if(e=a.pop(),t=a.pop(),e-t<=r)continue;const u=t+Math.ceil((e-t)/r/2)*r;jd(i,u,t,e,s),a.push(t,u,u,e)}}const pu=[NaN,NaN,NaN,0];let sl;function CR(){return sl||(sl=se(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),sl}const xR=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,TR=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,IR=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,AR=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function Bs(i,t){return i.endsWith("%")?Number(i.substring(0,i.length-1))/t:Number(i)}function br(i){throw new Error('failed to parse "'+i+'" as color')}function Jd(i){if(i.toLowerCase().startsWith("rgb")){const a=i.match(TR)||i.match(xR)||i.match(IR);if(a){const u=a[4],h=100/255;return[Dt(Bs(a[1],h)+.5|0,0,255),Dt(Bs(a[2],h)+.5|0,0,255),Dt(Bs(a[3],h)+.5|0,0,255),u!==void 0?Dt(Bs(u,100),0,1):1]}br(i)}if(i.startsWith("#")){if(AR.test(i)){const a=i.substring(1),u=a.length<=4?1:2,h=[0,0,0,255];for(let c=0,d=a.length;c<d;c+=u){let g=parseInt(a.substring(c,c+u),16);u===1&&(g+=g<<4),h[c/u]=g}return h[3]=h[3]/255,h}br(i)}const t=CR();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=i,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=i,t.fillStyle===e&&br(i));const r=t.fillStyle;if(r.startsWith("#")||r.startsWith("rgba"))return Jd(r);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const s=Array.from(t.getImageData(0,0,1,1).data);return s[3]=Yl(s[3]/255,3),s}function bR(i){return typeof i=="string"?i:yu(i)}const LR=1024,vr={};let ol=0;function SR(i){if(i.length===4)return i;const t=i.slice();return t[3]=1,t}function al(i){return i>.0031308?Math.pow(i,1/2.4)*269.025-14.025:i*3294.6}function ll(i){return i>.2068965?Math.pow(i,3):(i-4/29)*(108/841)}function ul(i){return i>10.314724?Math.pow((i+14.025)/269.025,2.4):i/3294.6}function hl(i){return i>.0088564?Math.pow(i,1/3):i/(108/841)+4/29}function Pf(i){const t=ul(i[0]),e=ul(i[1]),r=ul(i[2]),s=hl(t*.222488403+e*.716873169+r*.06060791),a=500*(hl(t*.452247074+e*.399439023+r*.148375274)-s),u=200*(s-hl(t*.016863605+e*.117638439+r*.865350722)),h=Math.atan2(u,a)*(180/Math.PI);return[116*s-16,Math.sqrt(a*a+u*u),h<0?h+360:h,i[3]]}function MR(i){const t=(i[0]+16)/116,e=i[1],r=i[2]*Math.PI/180,s=ll(t),a=ll(t+e/500*Math.cos(r)),u=ll(t-e/200*Math.sin(r)),h=al(a*3.021973625-s*1.617392459-u*.404875592),c=al(a*-.943766287+s*1.916279586+u*.027607165),d=al(a*.069407491-s*.22898585+u*1.159737864);return[Dt(h+.5|0,0,255),Dt(c+.5|0,0,255),Dt(d+.5|0,0,255),i[3]]}function mu(i){if(i==="none")return pu;if(vr.hasOwnProperty(i))return vr[i];if(ol>=LR){let e=0;for(const r in vr)(e++&3)===0&&(delete vr[r],--ol)}const t=Jd(i);t.length!==4&&br(i);for(const e of t)isNaN(e)&&br(i);return vr[i]=t,++ol,t}function qi(i){return Array.isArray(i)?i:mu(i)}function yu(i){let t=i[0];t!=(t|0)&&(t=t+.5|0);let e=i[1];e!=(e|0)&&(e=e+.5|0);let r=i[2];r!=(r|0)&&(r=r+.5|0);const s=i[3]===void 0?1:Math.round(i[3]*1e3)/1e3;return"rgba("+t+","+e+","+r+","+s+")"}function Df(i){return i[0]>0&&i[1]>0}function OR(i,t,e){return e===void 0&&(e=[0,0]),e[0]=i[0]*t+.5|0,e[1]=i[1]*t+.5|0,e}function _e(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}let fi=0;const re=1<<fi++,lt=1<<fi++,de=1<<fi++,Je=1<<fi++,li=1<<fi++,xr=1<<fi++,Ys=Math.pow(2,fi)-1,vu={[re]:"boolean",[lt]:"number",[de]:"string",[Je]:"color",[li]:"number[]",[xr]:"size"},PR=Object.keys(vu).map(Number).sort(Fr);function DR(i){return i in vu}function Tr(i){const t=[];for(const e of PR)Ir(i,e)&&t.push(vu[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function Ir(i,t){return(i&t)===t}function Pn(i,t){return i===t}class Gt{constructor(t,e){if(!DR(t))throw new Error(`literal expressions must have a specific type, got ${Tr(t)}`);this.type=t,this.value=e}}class FR{constructor(t,e,...r){this.type=t,this.operator=e,this.args=r}}function Qd(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1,mapState:!1}}function Ht(i,t,e){switch(typeof i){case"boolean":{if(Pn(t,de))return new Gt(de,i?"true":"false");if(!Ir(t,re))throw new Error(`got a boolean, but expected ${Tr(t)}`);return new Gt(re,i)}case"number":{if(Pn(t,xr))return new Gt(xr,_e(i));if(Pn(t,re))return new Gt(re,!!i);if(Pn(t,de))return new Gt(de,i.toString());if(!Ir(t,lt))throw new Error(`got a number, but expected ${Tr(t)}`);return new Gt(lt,i)}case"string":{if(Pn(t,Je))return new Gt(Je,mu(i));if(Pn(t,re))return new Gt(re,!!i);if(!Ir(t,de))throw new Error(`got a string, but expected ${Tr(t)}`);return new Gt(de,i)}}if(!Array.isArray(i))throw new Error("expression must be an array or a primitive value");if(i.length===0)throw new Error("empty expression");if(typeof i[0]=="string")return ZR(i,t,e);for(const r of i)if(typeof r!="number")throw new Error("expected an array of numbers");if(Pn(t,xr)){if(i.length!==2)throw new Error(`expected an array of two values for a size, got ${i.length}`);return new Gt(xr,i)}if(Pn(t,Je)){if(i.length===3)return new Gt(Je,[...i,1]);if(i.length===4)return new Gt(Je,i);throw new Error(`expected an array of 3 or 4 values for a color, got ${i.length}`)}if(!Ir(t,li))throw new Error(`got an array of numbers, but expected ${Tr(t)}`);return new Gt(li,i)}const S={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},NR={[S.Get]:q(et(1,1/0),Ff),[S.Var]:q(et(1,1),zR),[S.Has]:q(et(1,1/0),Ff),[S.Id]:q(GR,Pi),[S.Concat]:q(et(2,1/0),dt(de)),[S.GeometryType]:q(UR,Pi),[S.LineMetric]:q(Pi),[S.Resolution]:q(cl,Pi),[S.Zoom]:q(cl,Pi),[S.Time]:q(cl,Pi),[S.Any]:q(et(2,1/0),dt(re)),[S.All]:q(et(2,1/0),dt(re)),[S.Not]:q(et(1,1),dt(re)),[S.Equal]:q(et(2,2),dt(Ys)),[S.NotEqual]:q(et(2,2),dt(Ys)),[S.GreaterThan]:q(et(2,2),dt(lt)),[S.GreaterThanOrEqualTo]:q(et(2,2),dt(lt)),[S.LessThan]:q(et(2,2),dt(lt)),[S.LessThanOrEqualTo]:q(et(2,2),dt(lt)),[S.Multiply]:q(et(2,1/0),Nf),[S.Coalesce]:q(et(2,1/0),Nf),[S.Divide]:q(et(2,2),dt(lt)),[S.Add]:q(et(2,1/0),dt(lt)),[S.Subtract]:q(et(2,2),dt(lt)),[S.Clamp]:q(et(3,3),dt(lt)),[S.Mod]:q(et(2,2),dt(lt)),[S.Pow]:q(et(2,2),dt(lt)),[S.Abs]:q(et(1,1),dt(lt)),[S.Floor]:q(et(1,1),dt(lt)),[S.Ceil]:q(et(1,1),dt(lt)),[S.Round]:q(et(1,1),dt(lt)),[S.Sin]:q(et(1,1),dt(lt)),[S.Cos]:q(et(1,1),dt(lt)),[S.Atan]:q(et(1,2),dt(lt)),[S.Sqrt]:q(et(1,1),dt(lt)),[S.Match]:q(et(4,1/0),zf,kR),[S.Between]:q(et(3,3),dt(lt)),[S.Interpolate]:q(et(6,1/0),zf,XR),[S.Case]:q(et(3,1/0),WR,KR),[S.In]:q(et(2,2),BR),[S.Number]:q(et(1,1/0),dt(Ys)),[S.String]:q(et(1,1/0),dt(Ys)),[S.Array]:q(et(1,1/0),dt(lt)),[S.Color]:q(et(1,4),dt(lt)),[S.Band]:q(et(1,3),dt(lt)),[S.Palette]:q(et(2,2),YR),[S.ToString]:q(et(1,1),dt(re|lt|de|Je))};function Ff(i,t,e){const r=i.length-1,s=new Array(r);for(let a=0;a<r;++a){const u=i[a+1];switch(typeof u){case"number":{s[a]=new Gt(lt,u);break}case"string":{s[a]=new Gt(de,u);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${u}`)}a===0&&e.properties.add(String(u))}return s}function zR(i,t,e){const r=i[1];if(typeof r!="string")throw new Error("expected a string argument for var operation");return e.variables.add(r),[new Gt(de,r)]}function GR(i,t,e){e.featureId=!0}function UR(i,t,e){e.geometryType=!0}function cl(i,t,e){e.mapState=!0}function Pi(i,t,e){const r=i[0];if(i.length!==1)throw new Error(`expected no arguments for ${r} operation`);return[]}function et(i,t){return function(e,r,s){const a=e[0],u=e.length-1;if(i===t){if(u!==i){const h=i===1?"":"s";throw new Error(`expected ${i} argument${h} for ${a}, got ${u}`)}}else if(u<i||u>t){const h=t===1/0?`${i} or more`:`${i} to ${t}`;throw new Error(`expected ${h} arguments for ${a}, got ${u}`)}}}function Nf(i,t,e){const r=i.length-1,s=new Array(r);for(let a=0;a<r;++a){const u=Ht(i[a+1],t,e);s[a]=u}return s}function dt(i){return function(t,e,r){const s=t.length-1,a=new Array(s);for(let u=0;u<s;++u){const h=Ht(t[u+1],i,r);a[u]=h}return a}}function WR(i,t,e){const r=i[0],s=i.length-1;if(s%2===0)throw new Error(`expected an odd number of arguments for ${r}, got ${s} instead`)}function zf(i,t,e){const r=i[0],s=i.length-1;if(s%2===1)throw new Error(`expected an even number of arguments for operation ${r}, got ${s} instead`)}function kR(i,t,e){const r=i.length-1,s=de|lt|re,a=Ht(i[1],s,e),u=Ht(i[i.length-1],t,e),h=new Array(r-2);for(let c=0;c<r-2;c+=2){try{const d=Ht(i[c+2],a.type,e);h[c]=d}catch(d){throw new Error(`failed to parse argument ${c+1} of match expression: ${d.message}`)}try{const d=Ht(i[c+3],u.type,e);h[c+1]=d}catch(d){throw new Error(`failed to parse argument ${c+2} of match expression: ${d.message}`)}}return[a,...h,u]}function XR(i,t,e){const r=i[1];let s;switch(r[0]){case"linear":s=1;break;case"exponential":const c=r[1];if(typeof c!="number"||c<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(c)} instead`);s=c;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(r)}`)}const a=new Gt(lt,s);let u;try{u=Ht(i[2],lt,e)}catch(c){throw new Error(`failed to parse argument 1 in interpolate expression: ${c.message}`)}const h=new Array(i.length-3);for(let c=0;c<h.length;c+=2){try{const d=Ht(i[c+3],lt,e);h[c]=d}catch(d){throw new Error(`failed to parse argument ${c+2} for interpolate expression: ${d.message}`)}try{const d=Ht(i[c+4],t,e);h[c+1]=d}catch(d){throw new Error(`failed to parse argument ${c+3} for interpolate expression: ${d.message}`)}}return[a,u,...h]}function KR(i,t,e){const r=Ht(i[i.length-1],t,e),s=new Array(i.length-1);for(let a=0;a<s.length-1;a+=2){try{const u=Ht(i[a+1],re,e);s[a]=u}catch(u){throw new Error(`failed to parse argument ${a} of case expression: ${u.message}`)}try{const u=Ht(i[a+2],r.type,e);s[a+1]=u}catch(u){throw new Error(`failed to parse argument ${a+1} of case expression: ${u.message}`)}}return s[s.length-1]=r,s}function BR(i,t,e){let r=i[2];if(!Array.isArray(r))throw new Error('the second argument for the "in" operator must be an array');let s;if(typeof r[0]=="string"){if(r[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(r[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');r=r[1],s=de}else s=lt;const a=new Array(r.length);for(let h=0;h<a.length;h++)try{const c=Ht(r[h],s,e);a[h]=c}catch(c){throw new Error(`failed to parse haystack item ${h} for "in" expression: ${c.message}`)}return[Ht(i[1],s,e),...a]}function YR(i,t,e){let r;try{r=Ht(i[1],lt,e)}catch(u){throw new Error(`failed to parse first argument in palette expression: ${u.message}`)}const s=i[2];if(!Array.isArray(s))throw new Error("the second argument of palette must be an array");const a=new Array(s.length);for(let u=0;u<a.length;u++){let h;try{h=Ht(s[u],Je,e)}catch(c){throw new Error(`failed to parse color at index ${u} in palette expression: ${c.message}`)}if(!(h instanceof Gt))throw new Error(`the palette color at index ${u} must be a literal value`);a[u]=h}return[r,...a]}function q(...i){return function(t,e,r){const s=t[0];let a;for(let u=0;u<i.length;u++){const h=i[u](t,e,r);if(u==i.length-1){if(!h)throw new Error("expected last argument validator to return the parsed args");a=h}}return new FR(e,s,...a)}}function ZR(i,t,e){const r=i[0],s=NR[r];if(!s)throw new Error(`unknown operator: ${r}`);return s(i,t,e)}function tg(i){if(!i)return"";const t=i.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return tg(i.getGeometries()[0]);default:return""}}function eg(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Cn(i,t,e){const r=Ht(i,t,e);return Qe(r)}function Qe(i,t){if(i instanceof Gt){if(i.type===Je&&typeof i.value=="string"){const r=mu(i.value);return function(){return r}}return function(){return i.value}}const e=i.operator;switch(e){case S.Number:case S.String:case S.Coalesce:return VR(i);case S.Get:case S.Var:case S.Has:return HR(i);case S.Id:return r=>r.featureId;case S.GeometryType:return r=>r.geometryType;case S.Concat:{const r=i.args.map(s=>Qe(s));return s=>"".concat(...r.map(a=>a(s).toString()))}case S.Resolution:return r=>r.resolution;case S.Any:case S.All:case S.Between:case S.In:case S.Not:return qR(i);case S.Equal:case S.NotEqual:case S.LessThan:case S.LessThanOrEqualTo:case S.GreaterThan:case S.GreaterThanOrEqualTo:return $R(i);case S.Multiply:case S.Divide:case S.Add:case S.Subtract:case S.Clamp:case S.Mod:case S.Pow:case S.Abs:case S.Floor:case S.Ceil:case S.Round:case S.Sin:case S.Cos:case S.Atan:case S.Sqrt:return jR(i);case S.Case:return JR(i);case S.Match:return QR(i);case S.Interpolate:return tC(i);case S.ToString:return eC(i);default:throw new Error(`Unsupported operator ${e}`)}}function VR(i,t){const e=i.operator,r=i.args.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=Qe(i.args[a]);switch(e){case S.Coalesce:return a=>{for(let u=0;u<r;++u){const h=s[u](a);if(typeof h<"u"&&h!==null)return h}throw new Error("Expected one of the values to be non-null")};case S.Number:case S.String:return a=>{for(let u=0;u<r;++u){const h=s[u](a);if(typeof h===e)return h}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function HR(i,t){const r=i.args[0].value;switch(i.operator){case S.Get:return s=>{const a=i.args;let u=s.properties[r];for(let h=1,c=a.length;h<c;++h){const g=a[h].value;u=u[g]}return u};case S.Var:return s=>s.variables[r];case S.Has:return s=>{const a=i.args;if(!(r in s.properties))return!1;let u=s.properties[r];for(let h=1,c=a.length;h<c;++h){const g=a[h].value;if(!u||!Object.hasOwn(u,g))return!1;u=u[g]}return!0};default:throw new Error(`Unsupported accessor operator ${i.operator}`)}}function $R(i,t){const e=i.operator,r=Qe(i.args[0]),s=Qe(i.args[1]);switch(e){case S.Equal:return a=>r(a)===s(a);case S.NotEqual:return a=>r(a)!==s(a);case S.LessThan:return a=>r(a)<s(a);case S.LessThanOrEqualTo:return a=>r(a)<=s(a);case S.GreaterThan:return a=>r(a)>s(a);case S.GreaterThanOrEqualTo:return a=>r(a)>=s(a);default:throw new Error(`Unsupported comparison operator ${e}`)}}function qR(i,t){const e=i.operator,r=i.args.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=Qe(i.args[a]);switch(e){case S.Any:return a=>{for(let u=0;u<r;++u)if(s[u](a))return!0;return!1};case S.All:return a=>{for(let u=0;u<r;++u)if(!s[u](a))return!1;return!0};case S.Between:return a=>{const u=s[0](a),h=s[1](a),c=s[2](a);return u>=h&&u<=c};case S.In:return a=>{const u=s[0](a);for(let h=1;h<r;++h)if(u===s[h](a))return!0;return!1};case S.Not:return a=>!s[0](a);default:throw new Error(`Unsupported logical operator ${e}`)}}function jR(i,t){const e=i.operator,r=i.args.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=Qe(i.args[a]);switch(e){case S.Multiply:return a=>{let u=1;for(let h=0;h<r;++h)u*=s[h](a);return u};case S.Divide:return a=>s[0](a)/s[1](a);case S.Add:return a=>{let u=0;for(let h=0;h<r;++h)u+=s[h](a);return u};case S.Subtract:return a=>s[0](a)-s[1](a);case S.Clamp:return a=>{const u=s[0](a),h=s[1](a);if(u<h)return h;const c=s[2](a);return u>c?c:u};case S.Mod:return a=>s[0](a)%s[1](a);case S.Pow:return a=>Math.pow(s[0](a),s[1](a));case S.Abs:return a=>Math.abs(s[0](a));case S.Floor:return a=>Math.floor(s[0](a));case S.Ceil:return a=>Math.ceil(s[0](a));case S.Round:return a=>Math.round(s[0](a));case S.Sin:return a=>Math.sin(s[0](a));case S.Cos:return a=>Math.cos(s[0](a));case S.Atan:return r===2?a=>Math.atan2(s[0](a),s[1](a)):a=>Math.atan(s[0](a));case S.Sqrt:return a=>Math.sqrt(s[0](a));default:throw new Error(`Unsupported numeric operator ${e}`)}}function JR(i,t){const e=i.args.length,r=new Array(e);for(let s=0;s<e;++s)r[s]=Qe(i.args[s]);return s=>{for(let a=0;a<e-1;a+=2)if(r[a](s))return r[a+1](s);return r[e-1](s)}}function QR(i,t){const e=i.args.length,r=new Array(e);for(let s=0;s<e;++s)r[s]=Qe(i.args[s]);return s=>{const a=r[0](s);for(let u=1;u<e-1;u+=2)if(a===r[u](s))return r[u+1](s);return r[e-1](s)}}function tC(i,t){const e=i.args.length,r=new Array(e);for(let s=0;s<e;++s)r[s]=Qe(i.args[s]);return s=>{const a=r[0](s),u=r[1](s);let h,c;for(let d=2;d<e;d+=2){const g=r[d](s);let y=r[d+1](s);const v=Array.isArray(y);if(v&&(y=SR(y)),g>=u)return d===2?y:v?nC(a,u,h,c,g,y):Ar(a,u,h,c,g,y);h=g,c=y}return c}}function eC(i,t){const e=i.operator,r=i.args.length,s=new Array(r);for(let a=0;a<r;++a)s[a]=Qe(i.args[a]);switch(e){case S.ToString:return a=>{const u=s[0](a);return i.args[0].type===Je?yu(u):u.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function Ar(i,t,e,r,s,a){const u=s-e;if(u===0)return r;const h=t-e,c=i===1?h/u:(Math.pow(i,h)-1)/(Math.pow(i,u)-1);return r+c*(a-r)}function nC(i,t,e,r,s,a){if(s-e===0)return r;const h=Pf(r),c=Pf(a);let d=c[2]-h[2];d>180?d-=360:d<-180&&(d+=360);const g=[Ar(i,t,e,h[0],s,c[0]),Ar(i,t,e,h[1],s,c[1]),h[2]+Ar(i,t,e,0,s,d),Ar(i,t,e,r[3],s,a[3])];return MR(g)}const ut={IDLE:0,LOADING:1,LOADED:2,ERROR:3};function iC(i,t,e){const r=i;let s=!0,a=!1,u=!1;const h=[Js(r,it.LOAD,function(){u=!0,a||t()})];return r.src&&hd?(a=!0,r.decode().then(function(){s&&t()}).catch(function(c){s&&(u?t():e())})):h.push(Js(r,it.ERROR,e)),function(){s=!1,h.forEach(Pt)}}function rC(i,t){return new Promise((e,r)=>{function s(){u(),e(i)}function a(){u(),r(new Error("Image load error"))}function u(){i.removeEventListener("load",s),i.removeEventListener("error",a)}i.addEventListener("load",s),i.addEventListener("error",a)})}function sC(i,t){return t&&(i.src=t),i.src&&hd?new Promise((e,r)=>i.decode().then(()=>e(i)).catch(s=>i.complete&&i.width?e(i):r(s))):rC(i)}class oC{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=1024}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const r=this.cache_[e];(t++&3)===0&&!r.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,r){const s=fl(t,e,r);return s in this.cache_?this.cache_[s]:null}getPattern(t,e,r){const s=fl(t,e,r);return s in this.patternCache_?this.patternCache_[s]:null}set(t,e,r,s,a){const u=fl(t,e,r),h=u in this.cache_;this.cache_[u]=s,a&&(s.getImageState()===ut.IDLE&&s.load(),s.getImageState()===ut.LOADING?s.ready().then(()=>{this.patternCache_[u]=ro().createPattern(s.getImage(1),"repeat")}):this.patternCache_[u]=ro().createPattern(s.getImage(1),"repeat")),h||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function fl(i,t,e){const r=e?qi(e):"null";return t+":"+i+":"+r}const Xe=new oC;let Er=null;class ng extends co{constructor(t,e,r,s,a){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=r,this.canvas_={},this.color_=a,this.imageState_=s===void 0?ut.IDLE:s,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===ut.LOADED){Er||(Er=se(1,1,void 0,{willReadFrequently:!0})),Er.drawImage(this.image_,0,0);try{Er.getImageData(0,0,1,1),this.tainted_=!1}catch{Er=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(it.CHANGE)}handleImageError_(){this.imageState_=ut.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=ut.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],r=se(t,e);r.fillRect(0,0,t,e),this.hitDetectionImage_=r.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===ut.IDLE){this.image_||this.initializeImage_(),this.imageState_=ut.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&sC(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==ut.LOADED)return;const e=this.image_,r=se(Math.ceil(e.width*t),Math.ceil(e.height*t)),s=r.canvas;r.scale(t,t),r.drawImage(e,0,0),r.globalCompositeOperation="multiply",r.fillStyle=bR(this.color_),r.fillRect(0,0,s.width/t,s.height/t),r.globalCompositeOperation="destination-in",r.drawImage(e,0,0),this.canvas_[t]=s}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===ut.LOADED||this.imageState_===ut.ERROR)t();else{const e=()=>{(this.imageState_===ut.LOADED||this.imageState_===ut.ERROR)&&(this.removeEventListener(it.CHANGE,e),t())};this.addEventListener(it.CHANGE,e)}})),this.ready_}}function Eu(i,t,e,r,s,a){let u=t===void 0?void 0:Xe.get(t,e,s);return u||(u=new ng(i,i&&"src"in i?i.src||void 0:t,e,r,s),Xe.set(t,e,s,u,a)),a&&u&&!Xe.getPattern(t,e,s)&&Xe.set(t,e,s,u,a),u}function Gf(i){return i?Array.isArray(i)?yu(i):typeof i=="object"&&"src"in i?aC(i):i:null}function aC(i){if(!i.offset||!i.size)return Xe.getPattern(i.src,"anonymous",i.color);const t=i.src+":"+i.offset,e=Xe.getPattern(t,void 0,i.color);if(e)return e;const r=Xe.get(i.src,"anonymous",null);if(r.getImageState()!==ut.LOADED)return null;const s=se(i.size[0],i.size[1]);return s.drawImage(r.getImage(1),i.offset[0],i.offset[1],i.size[0],i.size[1],0,0,i.size[0],i.size[1]),Eu(s.canvas,t,void 0,ut.LOADED,i.color,!0),Xe.getPattern(t,void 0,i.color)}const vT="10px sans-serif",Uf="#000",Wf="round",ET=[],wT=0,kf="round",lC=10,uC="#000",RT="center",CT="middle",xT=[0,0,0,0],hC=1,yn=new Rn;let Gi=null,Ml;const Ol={},TT=function(){const t="32px ",e=["monospace","serif"],r=e.length,s="wmytzilWMYTZIL@#/&?$%10";let a,u;function h(d,g,y){let v=!0;for(let C=0;C<r;++C){const T=e[C];if(u=so(d+" "+g+" "+t+T,s),y!=T){const A=so(d+" "+g+" "+t+y+","+T,s);v=v&&A!=u}}return!!v}function c(){let d=!0;const g=yn.getKeys();for(let y=0,v=g.length;y<v;++y){const C=g[y];if(yn.get(C)<100){const[T,A,b]=C.split(`
`);h(T,A,b)?(zr(Ol),Gi=null,Ml=void 0,yn.set(C,100)):(yn.set(C,yn.get(C)+1,!0),d=!1)}}d&&(clearInterval(a),a=void 0)}return function(d){const g=Bd(d);if(!g)return;const y=g.families;for(let v=0,C=y.length;v<C;++v){const T=y[v],A=g.style+`
`+g.weight+`
`+T;yn.get(A)===void 0&&(yn.set(A,100,!0),h(g.style,g.weight,T)||(yn.set(A,0,!0),a===void 0&&(a=setInterval(c,32))))}}}(),cC=function(){let i;return function(t){let e=Ol[t];if(e==null){if(ud){const r=Bd(t),s=ig(t,"Žg");e=(isNaN(Number(r.lineHeight))?1.2:Number(r.lineHeight))*(s.actualBoundingBoxAscent+s.actualBoundingBoxDescent)}else i||(i=document.createElement("div"),i.innerHTML="M",i.style.minHeight="0",i.style.maxHeight="none",i.style.height="auto",i.style.padding="0",i.style.border="none",i.style.position="absolute",i.style.display="block",i.style.left="-99999px"),i.style.font=t,document.body.appendChild(i),e=i.offsetHeight,document.body.removeChild(i);Ol[t]=e}return e}}();function ig(i,t){return Gi||(Gi=se(1,1)),i!=Ml&&(Gi.font=i,Ml=Gi.font),Gi.measureText(t)}function so(i,t){return ig(i,t).width}function IT(i,t,e){if(t in e)return e[t];const r=t.split(`
`).reduce((s,a)=>Math.max(s,so(i,a)),0);return e[t]=r,r}function AT(i,t){const e=[],r=[],s=[];let a=0,u=0,h=0,c=0;for(let d=0,g=t.length;d<=g;d+=2){const y=t[d];if(y===`
`||d===g){a=Math.max(a,u),s.push(u),u=0,h+=c,c=0;continue}const v=t[d+1]||i.font,C=so(v,y);e.push(C),u+=C;const T=cC(v);r.push(T),c=Math.max(c,T)}return{width:a,height:h,widths:e,heights:r,lineWidths:s}}function bT(i,t,e,r,s,a,u,h,c,d,g){i.save(),e!==1&&(i.globalAlpha===void 0?i.globalAlpha=y=>y.globalAlpha*=e:i.globalAlpha*=e),t&&i.transform.apply(i,t),r.contextInstructions?(i.translate(c,d),i.scale(g[0],g[1]),fC(r,i)):g[0]<0||g[1]<0?(i.translate(c,d),i.scale(g[0],g[1]),i.drawImage(r,s,a,u,h,0,0,u,h)):i.drawImage(r,s,a,u,h,c,d,u*g[0],h*g[1]),i.restore()}function fC(i,t){const e=i.contextInstructions;for(let r=0,s=e.length;r<s;r+=2)Array.isArray(e[r+1])?t[e[r]].apply(t,e[r+1]):t[e[r]]=e[r+1]}class Ro{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=_e(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Ro({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return ct()}getImage(t){return ct()}getHitDetectionImage(){return ct()}getPixelRatio(t){return 1}getImageState(){return ct()}getImageSize(){return ct()}getOrigin(){return ct()}getSize(){return ct()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=_e(t)}listenImageChange(t){ct()}load(){ct()}unlistenImageChange(t){ct()}ready(){return Promise.resolve()}}class Co extends Ro{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?ut.LOADING:ut.LOADED,this.imageState_===ut.LOADING&&this.ready().then(()=>this.imageState_=ut.LOADED),this.render()}clone(){const t=this.getScale(),e=new Co({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),r=this.getScaleArray();return[t[0]/2-e[0]/r[0],t[1]/2+e[1]/r[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){var a,u;const e=(a=this.fill_)==null?void 0:a.getKey(),r=`${t},${this.angle_},${this.radius},${this.radius2_},${this.points_},${e}`+Object.values(this.renderOptions_).join(",");let s=(u=Xe.get(r,null,null))==null?void 0:u.getImage(1);if(!s){const h=this.renderOptions_,c=Math.ceil(h.size*t),d=se(c,c);this.draw_(h,d,t),s=d.canvas,Xe.set(r,null,null,new ng(s,void 0,null,ut.LOADED,null))}return s}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,r){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let s=this.radius,a=this.radius2_===void 0?s:this.radius2_;if(s<a){const Z=s;s=a,a=Z}const u=this.radius2_===void 0?this.points_:this.points_*2,h=2*Math.PI/u,c=a*Math.sin(h),d=Math.sqrt(a*a-c*c),g=s-d,y=Math.sqrt(c*c+g*g),v=y/c;if(t==="miter"&&v<=r)return v*e;const C=e/2/v,T=e/2*(g/y),b=Math.sqrt((s+C)*(s+C)+T*T)-s;if(this.radius2_===void 0||t==="bevel")return b*2;const F=s*Math.sin(h),z=Math.sqrt(s*s-F*F),U=a-z,D=Math.sqrt(F*F+U*U)/F;if(D<=r){const Z=D*e/2-a-s;return 2*Math.max(b,Z)}return b*2}createRenderOptions(){let t=Wf,e=kf,r=0,s=null,a=0,u,h=0;this.stroke_&&(u=Gf(this.stroke_.getColor()??uC),h=this.stroke_.getWidth()??hC,s=this.stroke_.getLineDash(),a=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??kf,t=this.stroke_.getLineCap()??Wf,r=this.stroke_.getMiterLimit()??lC);const c=this.calculateLineJoinSize_(e,h,r),d=Math.max(this.radius,this.radius2_||0),g=Math.ceil(2*d+c);return{strokeStyle:u,strokeWidth:h,size:g,lineCap:t,lineDash:s,lineDashOffset:a,lineJoin:e,miterLimit:r}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,r){if(e.scale(r,r),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let s=this.fill_.getColor();s===null&&(s=Uf),e.fillStyle=Gf(s),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let r=this.fill_.getColor(),s=0;typeof r=="string"&&(r=qi(r)),r===null?s=1:Array.isArray(r)&&(s=r.length===4?r[3]:1),s===0&&(e=se(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const r=this.radius;if(e===1/0)t.arc(0,0,r,0,2*Math.PI);else{const s=this.radius2_===void 0?r:this.radius2_;this.radius2_!==void 0&&(e*=2);const a=this.angle_-Math.PI/2,u=2*Math.PI/e;for(let h=0;h<e;h++){const c=a+h*u,d=h%2===0?r:s;t.lineTo(d*Math.cos(c),d*Math.sin(c))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=Uf,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class Br extends Co{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new Br({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class ui{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new ui({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=Eu(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===ut.IDLE&&e.load(),e.getImageState()===ut.LOADING&&(this.patternImage_=e)}this.color_=t}getKey(){const t=this.getColor();return t?t instanceof CanvasPattern||t instanceof CanvasGradient?te(t):typeof t=="object"&&"src"in t?t.src+":"+t.offset:qi(t).toString():""}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}function Xf(i,t,e,r){return e!==void 0&&r!==void 0?[e/i,r/t]:e!==void 0?e/i:r!==void 0?r/t:1}class wu extends Ro{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,r=t.rotation!==void 0?t.rotation:0,s=t.scale!==void 0?t.scale:1,a=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:r,scale:s,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:a,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const u=t.img!==void 0?t.img:null;let h=t.src;wt(!(h!==void 0&&u),"`image` and `src` cannot be provided at the same time"),(h===void 0||h.length===0)&&u&&(h=u.src||te(u)),wt(h!==void 0&&h.length>0,"A defined and non-empty `src` or `image` must be provided"),wt(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let c;if(t.src!==void 0?c=ut.IDLE:u!==void 0&&("complete"in u?u.complete?c=u.src?ut.LOADED:ut.IDLE:c=ut.LOADING:c=ut.LOADED),this.color_=t.color!==void 0?qi(t.color):null,this.iconImage_=Eu(u,h,this.crossOrigin_,c,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let d,g;if(t.size)[d,g]=t.size;else{const y=this.getImage(1);if(y.width&&y.height)d=y.width,g=y.height;else if(y instanceof HTMLImageElement){this.initialOptions_=t;const v=()=>{if(this.unlistenImageChange(v),!this.initialOptions_)return;const C=this.iconImage_.getSize();this.setScale(Xf(C[0],C[1],t.width,t.height))};this.listenImageChange(v);return}}d!==void 0&&this.setScale(Xf(d,g,t.width,t.height))}}clone(){let t,e,r;return this.initialOptions_?(e=this.initialOptions_.width,r=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new wu({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:r,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const s=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!s)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=s[0]),this.anchorYUnits_=="fraction"&&(t[1]*=s[1])}if(this.anchorOrigin_!="top-left"){if(!s)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+s[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+s[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),r=this.getScaleArray();return[t[0]-e[0]/r[0],t[1]+e[1]/r[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),r=this.iconImage_.getSize();if(!e||!r)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=r[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=r[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==ut.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==ut.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(it.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(it.CHANGE,t)}ready(){return this.iconImage_.ready()}}class oi{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new oi({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class Ke{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=Kf,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new Ke({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=Kf,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function dC(i){let t;if(typeof i=="function")t=i;else{let e;Array.isArray(i)?e=i:(wt(typeof i.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[i]),t=function(){return e}}return t}let dl=null;function rg(i,t){if(!dl){const e=new ui({color:"rgba(255,255,255,0.4)"}),r=new oi({color:"#3399CC",width:1.25});dl=[new Ke({image:new Br({fill:e,stroke:r,radius:5}),fill:e,stroke:r})]}return dl}function LT(){const i={},t=[255,255,255,1],e=[0,153,255,1],r=3;return i.Polygon=[new Ke({fill:new ui({color:[255,255,255,.5]})})],i.MultiPolygon=i.Polygon,i.LineString=[new Ke({stroke:new oi({color:t,width:r+2})}),new Ke({stroke:new oi({color:e,width:r})})],i.MultiLineString=i.LineString,i.Circle=i.Polygon.concat(i.LineString),i.Point=[new Ke({image:new Br({radius:r*2,fill:new ui({color:e}),stroke:new oi({color:t,width:r/2})}),zIndex:1/0})],i.MultiPoint=i.Point,i.GeometryCollection=i.Polygon.concat(i.LineString,i.Point),i}function Kf(i){return i.getGeometry()}const gC="#333";class Ru{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.keepUpright_=t.keepUpright,this.scale_=t.scale,this.scaleArray_=_e(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new ui({color:gC}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new Ru({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),keepUpright:this.getKeepUpright(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getKeepUpright(){return this.keepUpright_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setKeepUpright(t){this.keepUpright_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=_e(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}function _C(i){return!0}function pC(i){const t=Qd(),e=mC(i,t),r=eg();return function(s,a){if(r.properties=s.getPropertiesInternal(),r.resolution=a,t.featureId){const u=s.getId();u!==void 0?r.featureId=u:r.featureId=null}return t.geometryType&&(r.geometryType=tg(s.getGeometry())),e(r)}}function Bf(i){const t=Qd(),e=i.length,r=new Array(e);for(let u=0;u<e;++u)r[u]=Pl(i[u],t);const s=eg(),a=new Array(e);return function(u,h){if(s.properties=u.getPropertiesInternal(),s.resolution=h,t.featureId){const d=u.getId();d!==void 0?s.featureId=d:s.featureId=null}let c=0;for(let d=0;d<e;++d){const g=r[d](s);g&&(a[c]=g,c+=1)}return a.length=c,a}}function mC(i,t){const e=i.length,r=new Array(e);for(let s=0;s<e;++s){const a=i[s],u="filter"in a?Cn(a.filter,re,t):_C;let h;if(Array.isArray(a.style)){const c=a.style.length;h=new Array(c);for(let d=0;d<c;++d)h[d]=Pl(a.style[d],t)}else h=[Pl(a.style,t)];r[s]={filter:u,styles:h}}return function(s){const a=[];let u=!1;for(let h=0;h<e;++h){const c=r[h].filter;if(c(s)&&!(i[h].else&&u)){u=!0;for(const d of r[h].styles){const g=d(s);g&&a.push(g)}}}return a}}function Pl(i,t){const e=Pr(i,"",t),r=Dr(i,"",t),s=yC(i,t),a=vC(i,t),u=ge(i,"z-index",t);if(!e&&!r&&!s&&!a&&!ld(i))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(i));const h=new Ke;return function(c){let d=!0;if(e){const g=e(c);g&&(d=!1),h.setFill(g)}if(r){const g=r(c);g&&(d=!1),h.setStroke(g)}if(s){const g=s(c);g&&(d=!1),h.setText(g)}if(a){const g=a(c);g&&(d=!1),h.setImage(g)}return u&&h.setZIndex(u(c)),d?null:h}}function Pr(i,t,e){let r;if(t+"fill-pattern-src"in i)r=CC(i,t+"fill-",e);else{if(i[t+"fill-color"]==="none")return a=>null;r=Cu(i,t+"fill-color",e)}if(!r)return null;const s=new ui;return function(a){const u=r(a);return u===pu?null:(s.setColor(u),s)}}function Dr(i,t,e){const r=ge(i,t+"stroke-width",e),s=Cu(i,t+"stroke-color",e);if(!r&&!s)return null;const a=vn(i,t+"stroke-line-cap",e),u=vn(i,t+"stroke-line-join",e),h=sg(i,t+"stroke-line-dash",e),c=ge(i,t+"stroke-line-dash-offset",e),d=ge(i,t+"stroke-miter-limit",e),g=new oi;return function(y){if(s){const v=s(y);if(v===pu)return null;g.setColor(v)}if(r&&g.setWidth(r(y)),a){const v=a(y);if(v!=="butt"&&v!=="round"&&v!=="square")throw new Error("Expected butt, round, or square line cap");g.setLineCap(v)}if(u){const v=u(y);if(v!=="bevel"&&v!=="round"&&v!=="miter")throw new Error("Expected bevel, round, or miter line join");g.setLineJoin(v)}return h&&g.setLineDash(h(y)),c&&g.setLineDashOffset(c(y)),d&&g.setMiterLimit(d(y)),g}}function yC(i,t){const e="text-",r=vn(i,e+"value",t);if(!r)return null;const s=Pr(i,e,t),a=Pr(i,e+"background-",t),u=Dr(i,e,t),h=Dr(i,e+"background-",t),c=vn(i,e+"font",t),d=ge(i,e+"max-angle",t),g=ge(i,e+"offset-x",t),y=ge(i,e+"offset-y",t),v=Bi(i,e+"overflow",t),C=vn(i,e+"placement",t),T=ge(i,e+"repeat",t),A=xo(i,e+"scale",t),b=Bi(i,e+"rotate-with-view",t),F=ge(i,e+"rotation",t),z=vn(i,e+"align",t),U=vn(i,e+"justify",t),N=vn(i,e+"baseline",t),D=Bi(i,e+"keep-upright",t),Z=sg(i,e+"padding",t),K=To(i,e+"declutter-mode"),X=new Ru({declutterMode:K});return function($){if(X.setText(r($)),s&&X.setFill(s($)),a&&X.setBackgroundFill(a($)),u&&X.setStroke(u($)),h&&X.setBackgroundStroke(h($)),c&&X.setFont(c($)),d&&X.setMaxAngle(d($)),g&&X.setOffsetX(g($)),y&&X.setOffsetY(y($)),v&&X.setOverflow(v($)),C){const j=C($);if(j!=="point"&&j!=="line")throw new Error("Expected point or line for text-placement");X.setPlacement(j)}if(T&&X.setRepeat(T($)),A&&X.setScale(A($)),b&&X.setRotateWithView(b($)),F&&X.setRotation(F($)),z){const j=z($);if(j!=="left"&&j!=="center"&&j!=="right"&&j!=="end"&&j!=="start")throw new Error("Expected left, right, center, start, or end for text-align");X.setTextAlign(j)}if(U){const j=U($);if(j!=="left"&&j!=="right"&&j!=="center")throw new Error("Expected left, right, or center for text-justify");X.setJustify(j)}if(N){const j=N($);if(j!=="bottom"&&j!=="top"&&j!=="middle"&&j!=="alphabetic"&&j!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");X.setTextBaseline(j)}return Z&&X.setPadding(Z($)),D&&X.setKeepUpright(D($)),X}}function vC(i,t){return"icon-src"in i?EC(i,t):"shape-points"in i?wC(i,t):"circle-radius"in i?RC(i,t):null}function EC(i,t){const e="icon-",r=e+"src",s=og(i[r],r),a=oo(i,e+"anchor",t),u=xo(i,e+"scale",t),h=ge(i,e+"opacity",t),c=oo(i,e+"displacement",t),d=ge(i,e+"rotation",t),g=Bi(i,e+"rotate-with-view",t),y=Zf(i,e+"anchor-origin"),v=Vf(i,e+"anchor-x-units"),C=Vf(i,e+"anchor-y-units"),T=AC(i,e+"color"),A=TC(i,e+"cross-origin"),b=IC(i,e+"offset"),F=Zf(i,e+"offset-origin"),z=ao(i,e+"width"),U=ao(i,e+"height"),N=xC(i,e+"size"),D=To(i,e+"declutter-mode"),Z=new wu({src:s,anchorOrigin:y,anchorXUnits:v,anchorYUnits:C,color:T,crossOrigin:A,offset:b,offsetOrigin:F,height:U,width:z,size:N,declutterMode:D});return function(K){return h&&Z.setOpacity(h(K)),c&&Z.setDisplacement(c(K)),d&&Z.setRotation(d(K)),g&&Z.setRotateWithView(g(K)),u&&Z.setScale(u(K)),a&&Z.setAnchor(a(K)),Z}}function wC(i,t){const e="shape-",r=e+"points",s=e+"radius",a=Dl(i[r],r),u=Dl(i[s],s),h=Pr(i,e,t),c=Dr(i,e,t),d=xo(i,e+"scale",t),g=oo(i,e+"displacement",t),y=ge(i,e+"rotation",t),v=Bi(i,e+"rotate-with-view",t),C=ao(i,e+"radius2"),T=ao(i,e+"angle"),A=To(i,e+"declutter-mode"),b=new Co({points:a,radius:u,radius2:C,angle:T,declutterMode:A});return function(F){return h&&b.setFill(h(F)),c&&b.setStroke(c(F)),g&&b.setDisplacement(g(F)),y&&b.setRotation(y(F)),v&&b.setRotateWithView(v(F)),d&&b.setScale(d(F)),b}}function RC(i,t){const e="circle-",r=Pr(i,e,t),s=Dr(i,e,t),a=ge(i,e+"radius",t),u=xo(i,e+"scale",t),h=oo(i,e+"displacement",t),c=ge(i,e+"rotation",t),d=Bi(i,e+"rotate-with-view",t),g=To(i,e+"declutter-mode"),y=new Br({radius:5,declutterMode:g});return function(v){return a&&y.setRadius(a(v)),r&&y.setFill(r(v)),s&&y.setStroke(s(v)),h&&y.setDisplacement(h(v)),c&&y.setRotation(c(v)),d&&y.setRotateWithView(d(v)),u&&y.setScale(u(v)),y}}function ge(i,t,e){if(!(t in i))return;const r=Cn(i[t],lt,e);return function(s){return Dl(r(s),t)}}function vn(i,t,e){if(!(t in i))return null;const r=Cn(i[t],de,e);return function(s){return og(r(s),t)}}function CC(i,t,e){const r=vn(i,t+"pattern-src",e),s=Yf(i,t+"pattern-offset",e),a=Yf(i,t+"pattern-size",e),u=Cu(i,t+"color",e);return function(h){return{src:r(h),offset:s&&s(h),size:a&&a(h),color:u&&u(h)}}}function Bi(i,t,e){if(!(t in i))return null;const r=Cn(i[t],re,e);return function(s){const a=r(s);if(typeof a!="boolean")throw new Error(`Expected a boolean for ${t}`);return a}}function Cu(i,t,e){if(!(t in i))return null;const r=Cn(i[t],Je,e);return function(s){return ag(r(s),t)}}function sg(i,t,e){if(!(t in i))return null;const r=Cn(i[t],li,e);return function(s){return Yr(r(s),t)}}function oo(i,t,e){if(!(t in i))return null;const r=Cn(i[t],li,e);return function(s){const a=Yr(r(s),t);if(a.length!==2)throw new Error(`Expected two numbers for ${t}`);return a}}function Yf(i,t,e){if(!(t in i))return null;const r=Cn(i[t],li,e);return function(s){return lg(r(s),t)}}function xo(i,t,e){if(!(t in i))return null;const r=Cn(i[t],li|lt,e);return function(s){return bC(r(s),t)}}function ao(i,t){const e=i[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function xC(i,t){const e=i[t];if(e!==void 0){if(typeof e=="number")return _e(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function TC(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function Zf(i,t){const e=i[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function Vf(i,t){const e=i[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function IC(i,t){const e=i[t];if(e!==void 0)return Yr(e,t)}function To(i,t){const e=i[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function AC(i,t){const e=i[t];if(e!==void 0)return ag(e,t)}function Yr(i,t){if(!Array.isArray(i))throw new Error(`Expected an array for ${t}`);const e=i.length;for(let r=0;r<e;++r)if(typeof i[r]!="number")throw new Error(`Expected an array of numbers for ${t}`);return i}function og(i,t){if(typeof i!="string")throw new Error(`Expected a string for ${t}`);return i}function Dl(i,t){if(typeof i!="number")throw new Error(`Expected a number for ${t}`);return i}function ag(i,t){if(typeof i=="string")return i;const e=Yr(i,t),r=e.length;if(r<3||r>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function lg(i,t){const e=Yr(i,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function bC(i,t){return typeof i=="number"?i:lg(i,t)}const Hf={RENDER_ORDER:"renderOrder"};class LC extends wo{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(Hf.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const r=this.getDeclutter();r in t.declutter||(t.declutter[r]=new mR(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(Hf.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?rg:t;const e=SC(t);this.styleFunction_=t===null?void 0:dC(e),this.changed()}setDeclutter(t){this.declutter_=t?String(t):void 0,this.changed()}}function SC(i){if(i===void 0)return rg;if(!i)return null;if(typeof i=="function"||i instanceof Ke)return i;if(!Array.isArray(i))return Bf([i]);if(i.length===0)return[];const t=i.length,e=i[0];if(e instanceof Ke){const s=new Array(t);for(let a=0;a<t;++a){const u=i[a];if(!(u instanceof Ke))throw new Error("Expected a list of style instances");s[a]=u}return s}if("style"in e){const s=new Array(t);for(let a=0;a<t;++a){const u=i[a];if(!("style"in u))throw new Error("Expected a list of rules with a style property");s[a]=u}return pC(s)}return Bf(i)}class ug extends Un{constructor(t,e,r,s){super(t),this.inversePixelTransform=e,this.frameState=r,this.context=s}}class MC extends uo{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){ct()}calculateMatrices2D(t){const e=t.viewState,r=t.coordinateToPixelTransform,s=t.pixelToCoordinateTransform;Mr(r,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Id(s,r)}forEachFeatureAtCoordinate(t,e,r,s,a,u,h,c){let d;const g=e.viewState;function y(N,D,Z,K){return a.call(u,D,N?Z:null,K)}const v=g.projection,C=zE(t.slice(),v),T=[[0,0]];if(v.canWrapX()&&s){const N=v.getExtent(),D=Tt(N);T.push([-D,0],[D,0])}const A=e.layerStatesArray,b=A.length,F=[],z=[];for(let N=0;N<T.length;N++)for(let D=b-1;D>=0;--D){const Z=A[D],K=Z.layer;if(K.hasRenderer()&&_u(Z,g)&&h.call(c,K)){const X=K.getRenderer(),$=K.getSource();if(X&&$){const j=$.getWrapX()?C:t,Lt=y.bind(null,Z.managed);z[0]=j[0]+T[N][0],z[1]=j[1]+T[N][1],d=X.forEachFeatureAtCoordinate(z,e,r,Lt,F)}if(d)return d}}if(F.length===0)return;const U=1/F.length;return F.forEach((N,D)=>N.distanceSq+=D*U),F.sort((N,D)=>N.distanceSq-D.distanceSq),F.some(N=>d=N.callback(N.feature,N.layer,N.geometry)),d}hasFeatureAtCoordinate(t,e,r,s,a,u){return this.forEachFeatureAtCoordinate(t,e,r,s,qs,this,a,u)!==void 0}getMap(){return this.map_}renderFrame(t){ct()}scheduleExpireIconCache(t){Xe.canExpireCache()&&t.postRenderFunctions.push(OC)}}function OC(i,t){Xe.expire()}class PC extends MC{constructor(t){super(t),this.fontChangeListenerKey_=mt(yn,Lr.PROPERTYCHANGE,t.redrawText,t),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Eo+" ol-layers";const r=t.getViewport();r.insertBefore(this.element_,r.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const r=this.getMap();if(r.hasListener(t)){const s=new ug(t,void 0,e);r.dispatchEvent(s)}}disposeInternal(){Pt(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(on.PRECOMPOSE,t);const e=t.layerStatesArray.sort((h,c)=>h.zIndex-c.zIndex);e.some(h=>h.layer instanceof LC&&h.layer.getDeclutter())&&(t.declutter={});const s=t.viewState;this.children_.length=0;const a=[];let u=null;for(let h=0,c=e.length;h<c;++h){const d=e[h];t.layerIndex=h;const g=d.layer,y=g.getSourceState();if(!_u(d,s)||y!="ready"&&y!="undefined"){g.unrender();continue}const v=g.render(t,u);v&&(v!==u&&(this.children_.push(v),u=v),a.push(d))}this.declutter(t,a),Yw(this.element_,this.children_),this.dispatchRenderEvent(on.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let r=e.length-1;r>=0;--r){const s=e[r],a=s.layer;a.getDeclutter()&&a.renderDeclutter(t,s)}e.forEach(r=>r.layer.renderDeferred(t))}}}function hg(i){if(i instanceof wo){i.setMapInternal(null);return}i instanceof $i&&i.getLayers().forEach(hg)}function cg(i,t){if(i instanceof wo){i.setMapInternal(t);return}if(i instanceof $i){const e=i.getLayers().getArray();for(let r=0,s=e.length;r<s;++r)cg(e[r],t)}}let DC=class extends Rn{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=FC(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:_E,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=Ki(),this.pixelToCoordinateTransform_=Ki(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||$w(),this.interactions=e.interactions||_R({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new yE(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Qt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Qt.VIEW,this.handleViewChanged_),this.addChangeListener(Qt.SIZE,this.handleSizeChanged_),this.addChangeListener(Qt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const r=this;t.view&&!(t.view instanceof En)&&t.view.then(function(s){r.setView(new En(s))}),this.controls.addEventListener(We.ADD,s=>{s.element.setMap(this)}),this.controls.addEventListener(We.REMOVE,s=>{s.element.setMap(null)}),this.interactions.addEventListener(We.ADD,s=>{s.element.setMap(this)}),this.interactions.addEventListener(We.REMOVE,s=>{s.element.setMap(null)}),this.overlays_.addEventListener(We.ADD,s=>{this.addOverlayInternal_(s.element)}),this.overlays_.addEventListener(We.REMOVE,s=>{const a=s.element.getId();a!==void 0&&delete this.overlayIdIndex_[a.toString()],s.element.setMap(null)}),this.controls.forEach(s=>{s.setMap(this)}),this.interactions.forEach(s=>{s.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){cg(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,r){if(!this.frameState_||!this.renderer_)return;const s=this.getCoordinateFromPixelInternal(t);r=r!==void 0?r:{};const a=r.hitTolerance!==void 0?r.hitTolerance:0,u=r.layerFilter!==void 0?r.layerFilter:qs,h=r.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(s,this.frameState_,a,h,e,null,u,null)}getFeaturesAtPixel(t,e){const r=[];return this.forEachFeatureAtPixel(t,function(s){r.push(s)},e),r}getAllLayers(){const t=[];function e(r){r.forEach(function(s){s instanceof $i?e(s.getLayers()):t.push(s)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const r=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const s=e.layerFilter!==void 0?e.layerFilter:qs,a=e.hitTolerance!==void 0?e.hitTolerance:0,u=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(r,this.frameState_,a,u,s,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const r=this.viewport_.getBoundingClientRect(),s=this.getSize(),a=r.width/s[0],u=r.height/s[1],h="changedTouches"in t?t.changedTouches[0]:t;return[(h.clientX-r.left)/a,(h.clientY-r.top)/u]}getTarget(){return this.get(Qt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return bl(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Ie(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Qt.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof sn){e.setLayers(t);return}const r=e.getLayers();r.clear(),r.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,r=t.length;e<r;++e){const s=t[e];if(!s.visible)continue;const a=s.layer.getRenderer();if(a&&!a.ready)return!0;const u=s.layer.getSource();if(u&&u.loading)return!0}return!1}getPixelFromCoordinate(t){const e=mn(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Ie(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Qt.SIZE)}getView(){return this.get(Qt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,r,s){return vE(this.frameState_,t,e,r,s)}handleBrowserEvent(t,e){e=e||t.type;const r=new Fn(e,this,t);this.handleMapBrowserEvent(r)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,r=e.type;if(r===El.POINTERDOWN||r===it.WHEEL||r===it.KEYDOWN){const s=this.getOwnerDocument(),a=this.viewport_.getRootNode?this.viewport_.getRootNode():s,u=e.target,h=a instanceof ShadowRoot?a.host===u?a.host.ownerDocument:a:a===s?s.documentElement:a;if(this.overlayContainerStopEvent_.contains(u)||!h.contains(u))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const s=this.getInteractions().getArray().slice();for(let a=s.length-1;a>=0;a--){const u=s[a];if(u.getMap()!==this||!u.getActive()||!this.getTargetElement())continue;if(!u.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let s=this.maxTilesLoading_,a=s;if(t){const u=t.viewHints;if(u[Ue.ANIMATING]||u[Ue.INTERACTING]){const h=Date.now()-t.time>8;s=h?0:8,a=h?0:2}}e.getTilesLoading()<s&&(e.reprioritize(),e.loadMoreTiles(s,a))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(on.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(on.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Ni(Nn.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Ni(Nn.LOADSTART,this,t))));const r=this.postRenderFunctions_;if(t)for(let s=0,a=r.length;s<a;++s)r[s](this,t);r.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let r=0,s=this.targetChangeHandlerKeys_.length;r<s;++r)Pt(this.targetChangeHandlerKeys_[r]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(it.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(it.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const r=this.targetElement_.getRootNode();r instanceof ShadowRoot&&this.resizeObserver_.unobserve(r.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new PC(this)),this.mapBrowserEventHandler_=new pE(this,this.moveTolerance_);for(const a in xt)this.mapBrowserEventHandler_.addEventListener(xt[a],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(it.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(it.WHEEL,this.boundHandleBrowserEvent_,cd?{passive:!1}:!1);let r;if(this.keyboardEventTarget_)r=this.keyboardEventTarget_;else{const a=e.getRootNode();r=a instanceof ShadowRoot?a.host:e}this.targetChangeHandlerKeys_=[mt(r,it.KEYDOWN,this.handleBrowserEvent,this),mt(r,it.KEYPRESS,this.handleBrowserEvent,this)];const s=e.getRootNode();s instanceof ShadowRoot&&this.resizeObserver_.observe(s.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(Pt(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Pt(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=mt(t,Lr.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=mt(t,it.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Pt),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new zn("addlayer",t)),this.layerGroupPropertyListenerKeys_=[mt(t,Lr.PROPERTYCHANGE,this.render,this),mt(t,it.CHANGE,this.render,this),mt(t,"addlayer",this.handleLayerAdd_,this),mt(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,r=t.length;e<r;++e){const s=t[e].layer;s.hasRenderer()&&s.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){hg(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),r=this.getView(),s=this.frameState_;let a=null;if(e!==void 0&&Df(e)&&r&&r.isDef()){const u=r.getHints(this.frameState_?this.frameState_.viewHints:void 0),h=r.getState();if(a={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:xl(h.center,h.resolution,h.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:h,viewHints:u,wantedTiles:{},mapId:te(this),renderTargets:{}},h.nextCenter&&h.nextResolution){const c=isNaN(h.nextRotation)?h.rotation:h.nextRotation;a.nextExtent=xl(h.nextCenter,h.nextResolution,c,e)}}this.frameState_=a,this.renderer_.renderFrame(a),a&&(a.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,a.postRenderFunctions),s&&(!this.previousExtent_||!mo(this.previousExtent_)&&!Rl(a.extent,this.previousExtent_))&&(this.dispatchEvent(new Ni(Nn.MOVESTART,this,s)),this.previousExtent_=fo(this.previousExtent_)),this.previousExtent_&&!a.viewHints[Ue.ANIMATING]&&!a.viewHints[Ue.INTERACTING]&&!Rl(a.extent,this.previousExtent_)&&(this.dispatchEvent(new Ni(Nn.MOVEEND,this,a)),xE(a.extent,this.previousExtent_))),this.dispatchEvent(new Ni(Nn.POSTRENDER,this,a)),this.renderComplete_=(this.hasListener(Nn.LOADSTART)||this.hasListener(Nn.LOADEND)||this.hasListener(on.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new zn("removelayer",e)),this.set(Qt.LAYERGROUP,t)}setSize(t){this.set(Qt.SIZE,t)}setTarget(t){this.set(Qt.TARGET,t)}setView(t){if(!t||t instanceof En){this.set(Qt.VIEW,t);return}this.set(Qt.VIEW,new En);const e=this;t.then(function(r){e.setView(new En(r))})}updateSize(){const t=this.getTargetElement();let e;if(t){const s=getComputedStyle(t),a=t.offsetWidth-parseFloat(s.borderLeftWidth)-parseFloat(s.paddingLeft)-parseFloat(s.paddingRight)-parseFloat(s.borderRightWidth),u=t.offsetHeight-parseFloat(s.borderTopWidth)-parseFloat(s.paddingTop)-parseFloat(s.paddingBottom)-parseFloat(s.borderBottomWidth);!isNaN(a)&&!isNaN(u)&&(e=[Math.max(0,a),Math.max(0,u)],!Df(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&vd("No map visible because the map container's width or height are 0."))}const r=this.getSize();e&&(!r||!ho(e,r))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function FC(i){let t=null;i.keyboardEventTarget!==void 0&&(t=typeof i.keyboardEventTarget=="string"?document.getElementById(i.keyboardEventTarget):i.keyboardEventTarget);const e={},r=i.layers&&typeof i.layers.getLayers=="function"?i.layers:new $i({layers:i.layers});e[Qt.LAYERGROUP]=r,e[Qt.TARGET]=i.target,e[Qt.VIEW]=i.view instanceof En?i.view:new En;let s;i.controls!==void 0&&(Array.isArray(i.controls)?s=new sn(i.controls.slice()):(wt(typeof i.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),s=i.controls));let a;i.interactions!==void 0&&(Array.isArray(i.interactions)?a=new sn(i.interactions.slice()):(wt(typeof i.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),a=i.interactions));let u;return i.overlays!==void 0?Array.isArray(i.overlays)?u=new sn(i.overlays.slice()):(wt(typeof i.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),u=i.overlays):u=new sn,{controls:s,interactions:a,keyboardEventTarget:t,overlays:u,values:e}}const $f="olcControlUid";class MT{constructor(t){this.map=t}getMap(){return this.map}hasControl(t){return!!this.map.getControls().getArray().find(e=>e.get($f)===t)}addControl(t,e){this.hasControl(t)||(e.set($f,t),this.map.addControl(e))}static createEmptyMap(){return new DC({controls:[],layers:[]})}}class xu extends co{constructor(t,e,r){super(),r=r||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=r.transition===void 0?250:r.transition,this.transitionStarts_={},this.interpolate=!!r.interpolate}changed(){this.dispatchEvent(it.CHANGE)}release(){this.setState(B.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==B.EMPTY){if(this.state!==B.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){ct()}getAlpha(t,e){if(!this.transition_)return 1;let r=this.transitionStarts_[t];if(!r)r=e,this.transitionStarts_[t]=r;else if(r===-1)return 1;const s=e-r+1e3/60;return s>=this.transition_?1:yd(s/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}}function Fl(i){return i instanceof Image||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap?i:null}const NC=new Error("disposed"),zC=[256,256];class qf extends xu{constructor(t){const e=B.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=Fl(this.data_);return t?[t.width,t.height]:zC}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==B.IDLE&&this.state!==B.ERROR)return;this.state=B.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=B.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=B.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(NC),this.controller_=null),super.disposeInternal()}}class fg extends xu{constructor(t,e,r,s,a,u){super(t,e,u),this.crossOrigin_=s,this.src_=r,this.key=r,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=a}getImage(){return this.image_}setImage(t){this.image_=t,this.state=B.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=B.ERROR,this.unlistenImage_(),this.image_=GC(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=B.LOADED:this.state=B.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==B.ERROR&&(this.state=B.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==B.IDLE&&(this.state=B.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=iC(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}}function GC(){const i=se(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}class Tu{constructor(t,e,r,s){this.minX=t,this.maxX=e,this.minY=r,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function Di(i,t,e,r,s){return s!==void 0?(s.minX=i,s.maxX=t,s.minY=e,s.maxY=r,s):new Tu(i,t,e,r)}let gl;const Yi=[];function jf(i,t,e,r,s){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(r,s),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,r)+1,Math.max(e,s)),i.restore()}function _l(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function UC(){if(gl===void 0){const i=se(6,6,Yi);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",jf(i,4,5,4,0),jf(i,4,5,0,5);const t=i.getImageData(0,0,3,3).data;gl=_l(t,0)||_l(t,4)||_l(t,8),cu(i),Yi.push(i.canvas)}return gl}function Jf(i,t,e,r){const s=Td(e,t,i);let a=vf(t,r,e);const u=t.getMetersPerUnit();u!==void 0&&(a*=u);const h=i.getMetersPerUnit();h!==void 0&&(a/=h);const c=i.getExtent();if(!c||Zl(c,s)){const d=vf(i,a,s)/a;isFinite(d)&&d>0&&(a/=d)}return a}function WC(i,t,e,r){const s=Zi(e);let a=Jf(i,t,s,r);return(!isFinite(a)||a<=0)&&_d(e,function(u){return a=Jf(i,t,u,r),isFinite(a)&&a>0}),a}function kC(i,t,e,r,s,a,u,h,c,d,g,y,v,C){const T=se(Math.round(e*i),Math.round(e*t),Yi);if(y||(T.imageSmoothingEnabled=!1),c.length===0)return T.canvas;T.scale(e,e);function A(D){return Math.round(D*e)/e}T.globalCompositeOperation="lighter";const b=hi();c.forEach(function(D,Z,K){AE(b,D.extent)});let F;const z=e/r,U=(y?1:1+Math.pow(2,-24))/z;F=se(Math.round(Tt(b)*z),Math.round(ke(b)*z),Yi),y||(F.imageSmoothingEnabled=!1),c.forEach(function(D,Z,K){if(D.image.width>0&&D.image.height>0){if(D.clipExtent){F.save();const St=(D.clipExtent[0]-b[0])*z,ht=-(D.clipExtent[3]-b[3])*z,Ut=Tt(D.clipExtent)*z,Ft=ke(D.clipExtent)*z;F.rect(y?St:Math.round(St),y?ht:Math.round(ht),y?Ut:Math.round(St+Ut)-Math.round(St),y?Ft:Math.round(ht+Ft)-Math.round(ht)),F.clip()}const X=(D.extent[0]-b[0])*z,$=-(D.extent[3]-b[3])*z,j=Tt(D.extent)*z,Lt=ke(D.extent)*z;F.drawImage(D.image,d,d,D.image.width-2*d,D.image.height-2*d,y?X:Math.round(X),y?$:Math.round($),y?j:Math.round(X+j)-Math.round(X),y?Lt:Math.round($+Lt)-Math.round($)),D.clipExtent&&F.restore()}});const N=ci(u);return h.getTriangles().forEach(function(D,Z,K){const X=D.source,$=D.target;let j=X[0][0],Lt=X[0][1],St=X[1][0],ht=X[1][1],Ut=X[2][0],Ft=X[2][1];const Ye=A(($[0][0]-N[0])/a),pe=A(-($[0][1]-N[1])/a),yt=A(($[1][0]-N[0])/a),At=A(-($[1][1]-N[1])/a),Xt=A(($[2][0]-N[0])/a),Wt=A(-($[2][1]-N[1])/a),be=j,Le=Lt;j=0,Lt=0,St-=be,ht-=Le,Ut-=be,Ft-=Le;const Ze=[[St,ht,0,0,yt-Ye],[Ut,Ft,0,0,Xt-Ye],[0,0,St,ht,At-pe],[0,0,Ut,Ft,Wt-pe]],Kt=wE(Ze);if(!Kt)return;if(T.save(),T.beginPath(),UC()||!y){T.moveTo(yt,At);const $t=4,ye=Ye-yt,oe=pe-At;for(let Se=0;Se<$t;Se++)T.lineTo(yt+A((Se+1)*ye/$t),At+A(Se*oe/($t-1))),Se!=$t-1&&T.lineTo(yt+A((Se+1)*ye/$t),At+A((Se+1)*oe/($t-1)));T.lineTo(Xt,Wt)}else T.moveTo(yt,At),T.lineTo(Ye,pe),T.lineTo(Xt,Wt);T.clip(),T.transform(Kt[0],Kt[2],Kt[1],Kt[3],Ye,pe),T.translate(b[0]-be,b[3]-Le);let me;if(F)me=F.canvas,T.scale(U,-U);else{const $t=c[0],ye=$t.extent;me=$t.image,T.scale(Tt(ye)/me.width,-ke(ye)/me.height)}T.drawImage(me,0,0),T.restore()}),F&&(cu(F),Yi.push(F.canvas)),g&&(T.save(),T.globalCompositeOperation="source-over",T.strokeStyle="black",T.lineWidth=1,h.getTriangles().forEach(function(D,Z,K){const X=D.target,$=(X[0][0]-N[0])/a,j=-(X[0][1]-N[1])/a,Lt=(X[1][0]-N[0])/a,St=-(X[1][1]-N[1])/a,ht=(X[2][0]-N[0])/a,Ut=-(X[2][1]-N[1])/a;T.beginPath(),T.moveTo(Lt,St),T.lineTo($,j),T.lineTo(ht,Ut),T.closePath(),T.stroke()}),T.restore()),T.canvas}const XC=10,Qf=.25;class KC{constructor(t,e,r,s,a,u,h){this.sourceProj_=t,this.targetProj_=e;let c={};const d=h?_w(U=>Ie(h,Td(U,this.targetProj_,this.sourceProj_))):io(this.targetProj_,this.sourceProj_);this.transformInv_=function(U){const N=U[0]+"/"+U[1];return c[N]||(c[N]=d(U)),c[N]},this.maxSourceExtent_=s,this.errorThresholdSquared_=a*a,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&Tt(s)>=Tt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?Tt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?Tt(this.targetProj_.getExtent()):null;const g=ci(r),y=po(r),v=_o(r),C=go(r),T=this.transformInv_(g),A=this.transformInv_(y),b=this.transformInv_(v),F=this.transformInv_(C),z=XC+(u?Math.max(0,Math.ceil(Math.log2(Cl(r)/(u*u*256*256)))):0);if(this.addQuad_(g,y,v,C,T,A,b,F,z),this.wrapsXInSource_){let U=1/0;this.triangles_.forEach(function(N,D,Z){U=Math.min(U,N.source[0][0],N.source[1][0],N.source[2][0])}),this.triangles_.forEach(N=>{if(Math.max(N.source[0][0],N.source[1][0],N.source[2][0])-U>this.sourceWorldWidth_/2){const D=[[N.source[0][0],N.source[0][1]],[N.source[1][0],N.source[1][1]],[N.source[2][0],N.source[2][1]]];D[0][0]-U>this.sourceWorldWidth_/2&&(D[0][0]-=this.sourceWorldWidth_),D[1][0]-U>this.sourceWorldWidth_/2&&(D[1][0]-=this.sourceWorldWidth_),D[2][0]-U>this.sourceWorldWidth_/2&&(D[2][0]-=this.sourceWorldWidth_);const Z=Math.min(D[0][0],D[1][0],D[2][0]);Math.max(D[0][0],D[1][0],D[2][0])-Z<this.sourceWorldWidth_/2&&(N.source=D)}})}c={}}addTriangle_(t,e,r,s,a,u){this.triangles_.push({source:[s,a,u],target:[t,e,r]})}addQuad_(t,e,r,s,a,u,h,c,d){const g=uf([a,u,h,c]),y=this.sourceWorldWidth_?Tt(g)/this.sourceWorldWidth_:null,v=this.sourceWorldWidth_,C=this.sourceProj_.canWrapX()&&y>.5&&y<1;let T=!1;if(d>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const b=uf([t,e,r,s]);T=Tt(b)/this.targetWorldWidth_>Qf||T}!C&&this.sourceProj_.isGlobal()&&y&&(T=y>Qf||T)}if(!T&&this.maxSourceExtent_&&isFinite(g[0])&&isFinite(g[1])&&isFinite(g[2])&&isFinite(g[3])&&!Wr(g,this.maxSourceExtent_))return;let A=0;if(!T&&(!isFinite(a[0])||!isFinite(a[1])||!isFinite(u[0])||!isFinite(u[1])||!isFinite(h[0])||!isFinite(h[1])||!isFinite(c[0])||!isFinite(c[1]))){if(d>0)T=!0;else if(A=(!isFinite(a[0])||!isFinite(a[1])?8:0)+(!isFinite(u[0])||!isFinite(u[1])?4:0)+(!isFinite(h[0])||!isFinite(h[1])?2:0)+(!isFinite(c[0])||!isFinite(c[1])?1:0),A!=1&&A!=2&&A!=4&&A!=8)return}if(d>0){if(!T){const b=[(t[0]+r[0])/2,(t[1]+r[1])/2],F=this.transformInv_(b);let z;C?z=(ri(a[0],v)+ri(h[0],v))/2-ri(F[0],v):z=(a[0]+h[0])/2-F[0];const U=(a[1]+h[1])/2-F[1];T=z*z+U*U>this.errorThresholdSquared_}if(T){if(Math.abs(t[0]-r[0])<=Math.abs(t[1]-r[1])){const b=[(e[0]+r[0])/2,(e[1]+r[1])/2],F=this.transformInv_(b),z=[(s[0]+t[0])/2,(s[1]+t[1])/2],U=this.transformInv_(z);this.addQuad_(t,e,b,z,a,u,F,U,d-1),this.addQuad_(z,b,r,s,U,F,h,c,d-1)}else{const b=[(t[0]+e[0])/2,(t[1]+e[1])/2],F=this.transformInv_(b),z=[(r[0]+s[0])/2,(r[1]+s[1])/2],U=this.transformInv_(z);this.addQuad_(t,b,z,s,a,F,U,c,d-1),this.addQuad_(b,e,r,z,F,u,h,U,d-1)}return}}if(C){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}(A&11)==0&&this.addTriangle_(t,r,s,a,h,c),(A&14)==0&&this.addTriangle_(t,r,e,a,h,u),A&&((A&13)==0&&this.addTriangle_(e,s,t,u,c,a),(A&7)==0&&this.addTriangle_(e,s,r,u,c,h))}calculateSourceExtent(){const t=hi();return this.triangles_.forEach(function(e,r,s){const a=e.source;Hs(t,a[0]),Hs(t,a[1]),Hs(t,a[2])}),t}getTriangles(){return this.triangles_}}const BC=.5;class dg extends xu{constructor(t,e,r,s,a,u,h,c,d,g,y,v){super(a,B.IDLE,v),this.renderEdges_=y!==void 0?y:!1,this.pixelRatio_=h,this.gutter_=c,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=u||a,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const C=s.getTileCoordExtent(this.wrappedTileCoord_),T=this.targetTileGrid_.getExtent();let A=this.sourceTileGrid_.getExtent();const b=T?si(C,T):C;if(Cl(b)===0){this.state=B.EMPTY;return}const F=t.getExtent();F&&(A?A=si(A,F):A=F);const z=s.getResolution(this.wrappedTileCoord_[0]),U=WC(t,r,b,z);if(!isFinite(U)||U<=0){this.state=B.EMPTY;return}const N=g!==void 0?g:BC;if(this.triangulation_=new KC(t,r,b,A,U*N,z),this.triangulation_.getTriangles().length===0){this.state=B.EMPTY;return}this.sourceZ_=e.getZForResolution(U);let D=this.triangulation_.calculateSourceExtent();if(A&&(t.canWrapX()?(D[1]=Dt(D[1],A[1],A[3]),D[3]=Dt(D[3],A[1],A[3])):D=si(D,A)),!Cl(D))this.state=B.EMPTY;else{let Z=0,K=0;t.canWrapX()&&(Z=Tt(F),K=Math.floor((D[0]-F[0])/Z)),PE(D.slice(),t,!0).forEach($=>{const j=e.getTileRangeForExtentAndZ($,this.sourceZ_);for(let Lt=j.minX;Lt<=j.maxX;Lt++)for(let St=j.minY;St<=j.maxY;St++){const ht=d(this.sourceZ_,Lt,St,h);if(ht){const Ut=K*Z;this.sourceTiles_.push({tile:ht,offset:Ut})}}++K}),this.sourceTiles_.length===0&&(this.state=B.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{var s;const r=e.tile;if(r&&r.getState()==B.LOADED){const a=this.sourceTileGrid_.getTileCoordExtent(r.tileCoord);a[0]+=e.offset,a[2]+=e.offset;const u=(s=this.clipExtent_)==null?void 0:s.slice();u&&(u[0]+=e.offset,u[2]+=e.offset),t.push({extent:a,clipExtent:u,image:r.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=B.ERROR;else{const e=this.wrappedTileCoord_[0],r=this.targetTileGrid_.getTileSize(e),s=typeof r=="number"?r:r[0],a=typeof r=="number"?r:r[1],u=this.targetTileGrid_.getResolution(e),h=this.sourceTileGrid_.getResolution(this.sourceZ_),c=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=kC(s,a,this.pixelRatio_,h,this.sourceTileGrid_.getExtent(),u,c,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=B.LOADED}this.changed()}load(){if(this.state==B.IDLE){this.state=B.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const r=e.getState();if(r==B.IDLE||r==B.LOADING){t++;const s=mt(e,it.CHANGE,a=>{const u=e.getState();(u==B.LOADED||u==B.ERROR||u==B.EMPTY)&&(Pt(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},r,s){e.getState()==B.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(Pt),this.sourcesListenerKeys_=null}release(){this.canvas_&&(cu(this.canvas_.getContext("2d")),Yi.push(this.canvas_),this.canvas_=null),super.release()}}class YC{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof uo&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const r=this.entries_[t];return wt(r!==void 0,"Tried to get a value for a key that does not exist in the cache"),r===this.newest_||(r===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(r.newer.older=r.older,r.older.newer=r.newer),r.newer=null,r.older=this.newest_,this.newest_.newer=r,this.newest_=r),r.value_}remove(t){const e=this.entries_[t];return wt(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,r;for(r=this.newest_;r;r=r.older)t[e++]=r.key_;return t}getValues(){const t=new Array(this.count_);let e=0,r;for(r=this.newest_;r;r=r.older)t[e++]=r.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return(e=this.entries_[t])==null?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){wt(!(t in this.entries_),"Tried to set a value for a key that is used already");const r={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=r:this.oldest_=r,this.newest_=r,this.entries_[t]=r,++this.count_}setSize(t){this.highWaterMark=t}}function lo(i,t,e,r){return r!==void 0?(r[0]=i,r[1]=t,r[2]=e,r):[i,t,e]}function ZC(i,t,e){return i+"/"+t+"/"+e}function VC(i){return HC(i[0],i[1],i[2])}function HC(i,t,e){return(t<<i)+e}function $C(i,t){const e=i[0],r=i[1],s=i[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const a=t.getFullTileRange(e);return a?a.containsXY(r,s):!0}class qC{constructor(){pr(this,"pushMethodArgs_",(...t)=>(this.push_(t),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(ro(),{get:(t,e)=>{if(typeof ro()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,r)=>(this.push_(e,r),!0)})}push_(...t){const e=this.instructions_,r=this.zIndex+this.offset_;e[r]||(e[r]=[]),e[r].push(...t)}pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let r=0,s=e.length;r<s;++r){const a=e[r];if(typeof a=="function"){a(t);continue}const u=e[++r];if(typeof t[a]=="function")t[a](...u);else{if(typeof u=="function"){t[a]=u(t);continue}t[a]=u}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const jC=5;class JC extends Gr{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=jC}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return ct()}getData(t){return null}prepareFrame(t){return ct()}renderFrame(t,e){return ct()}forEachFeatureAtCoordinate(t,e,r,s,a){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===ut.LOADED||e.getState()===ut.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=ut.LOADED&&e!=ut.ERROR&&t.addEventListener(it.CHANGE,this.boundHandleImageChange_),e==ut.IDLE&&(t.load(),e=t.getState()),e==ut.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}const OT=[];let Ui=null;function QC(){Ui=se(1,1,void 0,{willReadFrequently:!0})}class tx extends JC{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Ki(),this.pixelTransform=Ki(),this.inversePixelTransform=Ki(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,r){Ui||QC(),Ui.clearRect(0,0,1,1);let s;try{Ui.drawImage(t,e,r,1,1,0,0,1,1),s=Ui.getImageData(0,0,1,1).data}catch{return Ui=null,null}return s}getBackground(t){let r=this.getLayer().getBackground();return typeof r=="function"&&(r=r(t.viewState.resolution)),r||void 0}useContainer(t,e,r){const s=this.getLayer().getClassName();let a,u;if(t&&t.className===s&&(!r||t&&t.style.backgroundColor&&ho(qi(t.style.backgroundColor),qi(r)))){const h=t.firstElementChild;h instanceof HTMLCanvasElement&&(u=h.getContext("2d"))}if(u&&ww(u.canvas.style.transform,e)?(this.container=t,this.context=u,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){a=document.createElement("div"),a.className=s;let h=a.style;h.position="absolute",h.width="100%",h.height="100%",u=se();const c=u.canvas;a.appendChild(c),h=c.style,h.position="absolute",h.left="0",h.transformOrigin="top left",this.container=a,this.context=u}!this.containerReused&&r&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=r)}clipUnrotated(t,e,r){const s=ci(r),a=po(r),u=_o(r),h=go(r);Ie(e.coordinateToPixelTransform,s),Ie(e.coordinateToPixelTransform,a),Ie(e.coordinateToPixelTransform,u),Ie(e.coordinateToPixelTransform,h);const c=this.inversePixelTransform;Ie(c,s),Ie(c,a),Ie(c,u),Ie(c,h),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(u[0]),Math.round(u[1])),t.lineTo(Math.round(h[0]),Math.round(h[1])),t.clip()}prepareContainer(t,e){const r=t.extent,s=t.viewState.resolution,a=t.viewState.rotation,u=t.pixelRatio,h=Math.round(Tt(r)/s*u),c=Math.round(ke(r)/s*u);Mr(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/u,1/u,a,-h/2,-c/2),Id(this.inversePixelTransform,this.pixelTransform);const d=Ew(this.pixelTransform);if(this.useContainer(e,d,this.getBackground(t)),!this.containerReused){const g=this.context.canvas;g.width!=h||g.height!=c?(g.width=h,g.height=c):this.context.clearRect(0,0,h,c),d!==g.style.transform&&(g.style.transform=d)}}dispatchRenderEvent_(t,e,r){const s=this.getLayer();if(s.hasListener(t)){const a=new ug(t,this.inversePixelTransform,r,e);s.dispatchEvent(a)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(on.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(on.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new qC),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(on.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(on.POSTRENDER,this.context,t))}getRenderTransform(t,e,r,s,a,u,h){const c=a/2,d=u/2,g=s/e,y=-g,v=-t[0]+h,C=-t[1];return Mr(this.tempTransform,c,d,g,y,-r,v,C)}disposeInternal(){delete this.frameState,super.disposeInternal()}}function pl(i,t,e,r){return`${i},${ZC(t,e,r)}`}function ml(i,t,e){if(!(e in i))return i[e]=new Set([t]),!0;const r=i[e],s=r.has(t);return s||r.add(t),!s}function ex(i,t,e){const r=i[e];return r?r.delete(t):!1}function td(i,t){const e=i.layerStatesArray[i.layerIndex];e.extent&&(t=si(t,ni(e.extent,i.viewState.projection)));const r=e.layer.getRenderSource();if(!r.getWrapX()){const s=r.getTileGridForProjection(i.viewState.projection).getExtent();s&&(t=si(t,s))}return t}class nx extends tx{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=hi(),this.tempTileRange_=new Tu(0,0,0,0),this.tempTileCoord_=lo(0,0,0);const r=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new YC(r),this.maxStaleKeys=r*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,r,s){const a=this.tileCache_,h=this.getLayer().getSource(),c=pl(h.getKey(),t,e,r);let d;if(a.containsKey(c))d=a.get(c);else{if(d=h.getTile(t,e,r,s.pixelRatio,s.viewState.projection),!d)return null;a.set(c,d)}return d}getTile(t,e,r,s){const a=this.getOrCreateTile(t,e,r,s);return a||null}getData(t){const e=this.frameState;if(!e)return null;const r=this.getLayer(),s=Ie(e.pixelToCoordinateTransform,t.slice()),a=r.getExtent();if(a&&!Zl(a,s))return null;const u=e.viewState,h=r.getRenderSource(),c=h.getTileGridForProjection(u.projection),d=h.getTilePixelRatio(e.pixelRatio);for(let g=c.getZForResolution(u.resolution);g>=c.getMinZoom();--g){const y=c.getTileCoordForCoordAndZ(s,g),v=this.getTile(g,y[1],y[2],e);if(!v||v.getState()!==B.LOADED)continue;const C=c.getOrigin(g),T=_e(c.getTileSize(g)),A=c.getResolution(g);let b;if(v instanceof fg||v instanceof dg)b=v.getImage();else if(v instanceof qf){if(b=Fl(v.getData()),!b)continue}else continue;const F=Math.floor(d*((s[0]-C[0])/A-y[1]*T[0])),z=Math.floor(d*((C[1]-s[1])/A-y[2]*T[1])),U=Math.round(d*h.getGutterForProjection(u.projection));return this.getImageData(b,F+U,z+U)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const r=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==r&&(this.renderedRevision_=r,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=r,!0}enqueueTiles(t,e,r,s,a){const u=t.viewState,h=this.getLayer(),c=h.getRenderSource(),d=c.getTileGridForProjection(u.projection),g=te(c);g in t.wantedTiles||(t.wantedTiles[g]={});const y=t.wantedTiles[g],v=h.getMapInternal(),C=Math.max(r-a,d.getMinZoom(),d.getZForResolution(Math.min(h.getMaxResolution(),v?v.getView().getResolutionForZoom(Math.max(h.getMinZoom(),0)):d.getResolution(0)),c.zDirection)),T=u.rotation,A=T?pd(u.center,u.resolution,T,t.size):void 0;for(let b=r;b>=C;--b){const F=d.getTileRangeForExtentAndZ(e,b,this.tempTileRange_),z=d.getResolution(b);for(let U=F.minX;U<=F.maxX;++U)for(let N=F.minY;N<=F.maxY;++N){if(T&&!d.tileCoordIntersectsViewport([b,U,N],A))continue;const D=this.getTile(b,U,N,t);if(!D||!ml(s,D,b))continue;const K=D.getKey();if(y[K]=!0,D.getState()===B.IDLE&&!t.tileQueue.isKeyQueued(K)){const X=lo(b,U,N,this.tempTileCoord_);t.tileQueue.enqueue([D,g,d.getTileCoordCenter(X),z])}}}}findStaleTile_(t,e){const r=this.tileCache_,s=t[0],a=t[1],u=t[2],h=this.getStaleKeys();for(let c=0;c<h.length;++c){const d=pl(h[c],s,a,u);if(r.containsKey(d)){const g=r.peek(d);if(g.getState()===B.LOADED)return g.endTransition(te(this)),ml(e,g,s),!0}}return!1}findAltTiles_(t,e,r,s){const a=t.getTileRangeForTileCoordAndZ(e,r,this.tempTileRange_);if(!a)return!1;let u=!0;const h=this.tileCache_,d=this.getLayer().getRenderSource().getKey();for(let g=a.minX;g<=a.maxX;++g)for(let y=a.minY;y<=a.maxY;++y){const v=pl(d,r,g,y);let C=!1;if(h.containsKey(v)){const T=h.peek(v);T.getState()===B.LOADED&&(ml(s,T,r),C=!0)}C||(u=!1)}return u}renderFrame(t,e){this.renderComplete=!0;const r=t.layerStatesArray[t.layerIndex],s=t.viewState,a=s.projection,u=s.resolution,h=s.center,c=t.pixelRatio,d=this.getLayer(),g=d.getSource(),y=g.getTileGridForProjection(a),v=y.getZForResolution(u,g.zDirection),C=y.getResolution(v),T=g.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==T&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=T):this.renderedSourceKey_=T;let A=t.extent;const b=g.getTilePixelRatio(c);this.prepareContainer(t,e);const F=this.context.canvas.width,z=this.context.canvas.height,U=r.extent&&ni(r.extent);U&&(A=si(A,ni(r.extent)));const N=C*F/2/b,D=C*z/2/b,Z=[h[0]-N,h[1]-D,h[0]+N,h[1]+D],K={};this.renderedTiles.length=0;const X=d.getPreload();if(t.nextExtent){const yt=y.getZForResolution(s.nextResolution,g.zDirection),At=td(t,t.nextExtent);this.enqueueTiles(t,At,yt,K,X)}const $=td(t,A);if(this.enqueueTiles(t,$,v,K,0),X>0&&setTimeout(()=>{this.enqueueTiles(t,$,v-1,K,X-1)},0),!(v in K))return this.container;const j=te(this),Lt=t.time;for(const yt of K[v]){const At=yt.getState();if(At===B.EMPTY)continue;const Xt=yt.tileCoord;if(At===B.LOADED&&yt.getAlpha(j,Lt)===1){yt.endTransition(j);continue}if(At!==B.ERROR&&(this.renderComplete=!1),this.findStaleTile_(Xt,K)){ex(K,yt,v),t.animate=!0;continue}if(this.findAltTiles_(y,Xt,v+1,K))continue;const Le=y.getMinZoom();for(let Ze=v-1;Ze>=Le&&!this.findAltTiles_(y,Xt,Ze,K);--Ze);}const St=C/u*c/b,ht=this.getRenderContext(t);Mr(this.tempTransform,F/2,z/2,St,St,0,-F/2,-z/2),r.extent&&this.clipUnrotated(ht,t,U),g.getInterpolate()||(ht.imageSmoothingEnabled=!1),this.preRender(ht,t);const Ut=Object.keys(K).map(Number);Ut.sort(Fr);let Ft;const Ye=[],pe=[];for(let yt=Ut.length-1;yt>=0;--yt){const At=Ut[yt],Xt=g.getTilePixelSize(At,c,a),be=y.getResolution(At)/C,Le=Xt[0]*be*St,Ze=Xt[1]*be*St,Kt=y.getTileCoordForCoordAndZ(ci(Z),At),me=y.getTileCoordExtent(Kt),$t=Ie(this.tempTransform,[b*(me[0]-Z[0])/C,b*(Z[3]-me[3])/C]),ye=b*g.getGutterForProjection(a);for(const oe of K[At]){if(oe.getState()!==B.LOADED)continue;const Se=oe.tileCoord,Wn=Kt[1]-Se[1],di=Math.round($t[0]-(Wn-1)*Le),Ji=Kt[2]-Se[2],ve=Math.round($t[1]-(Ji-1)*Ze),ae=Math.round($t[0]-Wn*Le),tn=Math.round($t[1]-Ji*Ze),le=di-ae,kn=ve-tn,Zr=Ut.length===1;let an=!1;Ft=[ae,tn,ae+le,tn,ae+le,tn+kn,ae,tn+kn];for(let qt=0,Xn=Ye.length;qt<Xn;++qt)if(!Zr&&At<pe[qt]){const Bt=Ye[qt];Wr([ae,tn,ae+le,tn+kn],[Bt[0],Bt[3],Bt[4],Bt[7]])&&(an||(ht.save(),an=!0),ht.beginPath(),ht.moveTo(Ft[0],Ft[1]),ht.lineTo(Ft[2],Ft[3]),ht.lineTo(Ft[4],Ft[5]),ht.lineTo(Ft[6],Ft[7]),ht.moveTo(Bt[6],Bt[7]),ht.lineTo(Bt[4],Bt[5]),ht.lineTo(Bt[2],Bt[3]),ht.lineTo(Bt[0],Bt[1]),ht.clip())}Ye.push(Ft),pe.push(At),this.drawTile(oe,t,ae,tn,le,kn,ye,Zr),an&&ht.restore(),this.renderedTiles.unshift(oe),this.updateUsedTiles(t.usedTiles,g,oe)}}if(this.renderedResolution=C,this.extentChanged=!this.renderedExtent_||!Rl(this.renderedExtent_,Z),this.renderedExtent_=Z,this.renderedPixelRatio=c,this.postRender(this.context,t),r.extent&&ht.restore(),ht.imageSmoothingEnabled=!0,this.renderComplete){const yt=(At,Xt)=>{const Wt=te(g),be=Xt.wantedTiles[Wt],Le=be?Object.keys(be).length:0;this.updateCacheSize(Le),this.tileCache_.expireCache()};t.postRenderFunctions.push(yt)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,r,s,a,u,h,c){let d;if(t instanceof qf){if(d=Fl(t.getData()),!d)throw new Error("Rendering array data is not yet supported")}else d=this.getTileImage(t);if(!d)return;const g=this.getRenderContext(e),y=te(this),v=e.layerStatesArray[e.layerIndex],C=v.opacity*(c?t.getAlpha(y,e.time):1),T=C!==g.globalAlpha;T&&(g.save(),g.globalAlpha=C),g.drawImage(d,h,h,d.width-2*h,d.height-2*h,r,s,a,u),T&&g.restore(),C!==v.opacity?e.animate=!0:c&&t.endTransition(y)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,r){const s=te(e);s in t||(t[s]={}),t[s][r.getKey()]=!0}}const Zs={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class ix extends wo{constructor(t){t=t||{};const e=Object.assign({},t),r=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=r,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Zs.PRELOAD)}setPreload(t){this.set(Zs.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Zs.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Zs.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}class PT extends ix{constructor(t){super(t)}createRenderer(){return new nx(this,{cacheSize:this.getCacheSize()})}}class rx extends Rn{constructor(t){super(),this.projection=Ae(t.projection),this.attributions_=ed(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(r,s){e.viewResolver=r,e.viewRejector=s})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=ed(t),this.changed()}setState(t){this.state_=t,this.changed()}}function ed(i){return i?typeof i=="function"?i:(Array.isArray(i)||(i=[i]),t=>i):null}const Fi=[0,0,0],Dn=5;class gg{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,wt(lE(this.resolutions_,(s,a)=>a-s),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let s=0,a=this.resolutions_.length-1;s<a;++s)if(!e)e=this.resolutions_[s]/this.resolutions_[s+1];else if(this.resolutions_[s]/this.resolutions_[s+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,wt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const r=t.extent;r!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=ci(r)),wt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,wt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:uu,wt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=r!==void 0?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((s,a)=>{const u=new Tu(Math.min(0,s[0]),Math.max(s[0]-1,-1),Math.min(0,s[1]),Math.max(s[1]-1,-1));if(r){const h=this.getTileRangeForExtentAndZ(r,a);u.minX=Math.max(h.minX,u.minX),u.maxX=Math.min(h.maxX,u.maxX),u.minY=Math.max(h.minY,u.minY),u.maxY=Math.min(h.maxY,u.maxY)}return u}):r&&this.calculateTileRanges_(r)}forEachTileCoord(t,e,r){const s=this.getTileRangeForExtentAndZ(t,e);for(let a=s.minX,u=s.maxX;a<=u;++a)for(let h=s.minY,c=s.maxY;h<=c;++h)r([e,a,h])}forEachTileCoordParentTileRange(t,e,r,s){let a,u,h,c=null,d=t[0]-1;for(this.zoomFactor_===2?(u=t[1],h=t[2]):c=this.getTileCoordExtent(t,s);d>=this.minZoom;){if(u!==void 0&&h!==void 0?(u=Math.floor(u/2),h=Math.floor(h/2),a=Di(u,u,h,h,r)):a=this.getTileRangeForExtentAndZ(c,d,r),e(d,a))return!0;--d}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,r){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const a=t[1]*2,u=t[2]*2;return Di(a,a+1,u,u+1,e)}const s=this.getTileCoordExtent(t,r||this.tmpExtent_);return this.getTileRangeForExtentAndZ(s,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,r){if(e>this.maxZoom||e<this.minZoom)return null;const s=t[0],a=t[1],u=t[2];if(e===s)return Di(a,u,a,u,r);if(this.zoomFactor_){const c=Math.pow(this.zoomFactor_,e-s),d=Math.floor(a*c),g=Math.floor(u*c);if(e<s)return Di(d,d,g,g,r);const y=Math.floor(c*(a+1))-1,v=Math.floor(c*(u+1))-1;return Di(d,y,g,v,r)}const h=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(h,e,r)}getTileRangeForExtentAndZ(t,e,r){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,Fi);const s=Fi[1],a=Fi[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,Fi);const u=Fi[1],h=Fi[2];return Di(s,u,a,h,r)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),r=this.getResolution(t[0]),s=_e(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*s[0]*r,e[1]-(t[2]+.5)*s[1]*r]}getTileCoordExtent(t,e){const r=this.getOrigin(t[0]),s=this.getResolution(t[0]),a=_e(this.getTileSize(t[0]),this.tmpSize_),u=r[0]+t[1]*a[0]*s,h=r[1]-(t[2]+1)*a[1]*s,c=u+a[0]*s,d=h+a[1]*s;return Ur(u,h,c,d,e)}getTileCoordForCoordAndResolution(t,e,r){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,r)}getTileCoordForXYAndResolution_(t,e,r,s,a){const u=this.getZForResolution(r),h=r/this.getResolution(u),c=this.getOrigin(u),d=_e(this.getTileSize(u),this.tmpSize_);let g=h*(t-c[0])/r/d[0],y=h*(c[1]-e)/r/d[1];return s?(g=Gs(g,Dn)-1,y=Gs(y,Dn)-1):(g=zs(g,Dn),y=zs(y,Dn)),lo(u,g,y,a)}getTileCoordForXYAndZ_(t,e,r,s,a){const u=this.getOrigin(r),h=this.getResolution(r),c=_e(this.getTileSize(r),this.tmpSize_);let d=(t-u[0])/h/c[0],g=(u[1]-e)/h/c[1];return s?(d=Gs(d,Dn)-1,g=Gs(g,Dn)-1):(d=zs(d,Dn),g=zs(g,Dn)),lo(r,d,g,a)}getTileCoordForCoordAndZ(t,e,r){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,r)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const r=Kl(this.resolutions_,t,e||0);return Dt(r,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return kd(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,r=new Array(e);for(let s=this.minZoom;s<e;++s)r[s]=this.getTileRangeForExtentAndZ(t,s);this.fullTileRanges_=r}}function _g(i){let t=i.getDefaultTileGrid();return t||(t=lx(i),i.setDefaultTileGrid(t)),t}function sx(i,t,e){const r=t[0],s=i.getTileCoordCenter(t),a=Iu(e);if(!Zl(a,s)){const u=Tt(a),h=Math.ceil((a[0]-s[0])/u);return s[0]+=u*h,i.getTileCoordForCoordAndZ(s,r)}return t}function ox(i,t,e,r){r=r!==void 0?r:"top-left";const s=pg(i,t,e);return new gg({extent:i,origin:LE(i,r),resolutions:s,tileSize:e})}function ax(i){const t=i||{},e=t.extent||Ae("EPSG:3857").getExtent(),r={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:pg(e,t.maxZoom,t.tileSize,t.maxResolution)};return new gg(r)}function pg(i,t,e,r){t=t!==void 0?t:Gw,e=_e(e!==void 0?e:uu);const s=ke(i),a=Tt(i);r=r>0?r:Math.max(a/e[0],s/e[1]);const u=t+1,h=new Array(u);for(let c=0;c<u;++c)h[c]=r/Math.pow(2,c);return h}function lx(i,t,e,r){const s=Iu(i);return ox(s,t,e,r)}function Iu(i){i=Ae(i);let t=i.getExtent();if(!t){const e=180*Hl.degrees/i.getMetersPerUnit();t=Ur(-e,-e,e,e)}return t}const ux=/\{z\}/g,hx=/\{x\}/g,cx=/\{y\}/g,fx=/\{-y\}/g;function dx(i,t,e,r,s){return i.replace(ux,t.toString()).replace(hx,e.toString()).replace(cx,r.toString()).replace(fx,function(){if(s===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(s-r).toString()})}function gx(i){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(i);if(e){const r=e[1].charCodeAt(0),s=e[2].charCodeAt(0);let a;for(a=r;a<=s;++a)t.push(i.replace(e[0],String.fromCharCode(a)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(i),e){const r=parseInt(e[2],10);for(let s=parseInt(e[1],10);s<=r;s++)t.push(i.replace(e[0],s.toString()));return t}return t.push(i),t}function _x(i,t){return function(e,r,s){if(!e)return;let a;const u=e[0];if(t){const h=t.getFullTileRange(u);h&&(a=h.getHeight()-1)}return dx(i,u,e[1],e[2],a)}}function px(i,t){const e=i.length,r=new Array(e);for(let s=0;s<e;++s)r[s]=_x(i[s],t);return mx(r)}function mx(i){return i.length===1?i[0]:function(t,e,r){if(!t)return;const s=VC(t),a=ri(s,i.length);return i[a](t,e,r)}}class yx extends rx{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&_e(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tmpSize=[0,0],this.key_=t.key||te(this),this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,r,s,a){return ct()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:_g(t)}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,r){const s=this.getTileGridForProjection(r),a=this.getTilePixelRatio(e),u=_e(s.getTileSize(t),this.tmpSize);return a==1?u:OR(u,a,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){const r=e!==void 0?e:this.getProjection(),s=e!==void 0?this.getTileGridForProjection(r):this.tileGrid||this.getTileGridForProjection(r);return this.getWrapX()&&r.isGlobal()&&(t=sx(s,t,r)),$C(t,s)?t:null}clear(){}refresh(){this.clear(),super.refresh()}}class vx extends Un{constructor(t,e){super(t),this.tile=e}}const yl={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class Au extends yx{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===Au.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,r=te(e),s=e.getState();let a;s==B.LOADING?(this.tileLoadingKeys_[r]=!0,a=yl.TILELOADSTART):r in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[r],a=s==B.ERROR?yl.TILELOADERROR:s==B.LOADED?yl.TILELOADEND:void 0),a!=null&&this.dispatchEvent(new vx(a,e))}setTileLoadFunction(t){this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=gx(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(px(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,r){}}class Ex extends Au{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:wx,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:fg,this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}getGutterForProjection(t){return this.getProjection()&&t&&!qa(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||qa(e,t)))return this.tileGrid;const r=te(t);return r in this.tileGridForProjection||(this.tileGridForProjection[r]=_g(t)),this.tileGridForProjection[r]}createTile_(t,e,r,s,a,u){const h=[t,e,r],c=this.getTileCoordForTileUrlFunction(h,a),d=c?this.tileUrlFunction(c,s,a):void 0,g=new this.tileClass(h,d!==void 0?B.IDLE:B.EMPTY,d!==void 0?d:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return g.key=u,g.addEventListener(it.CHANGE,this.handleTileChange.bind(this)),g}getTile(t,e,r,s,a){const u=this.getProjection();if(!u||!a||qa(u,a))return this.getTileInternal(t,e,r,s,u||a);const h=[t,e,r],c=this.getKey(),d=this.getTileGridForProjection(u),g=this.getTileGridForProjection(a),y=this.getTileCoordForTileUrlFunction(h,a),v=new dg(u,d,a,g,h,y,this.getTilePixelRatio(s),this.getGutter(),(C,T,A,b)=>this.getTileInternal(C,T,A,b,u),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return v.key=c,v}getTileInternal(t,e,r,s,a){const u=this.getKey();return this.createTile_(t,e,r,s,a,u)}setRenderReprojectionEdges(t){this.renderReprojectionEdges_!=t&&(this.renderReprojectionEdges_=t,this.changed())}setTileGridForProjection(t,e){const r=Ae(t);if(r){const s=te(r);s in this.tileGridForProjection||(this.tileGridForProjection[s]=e)}}}function wx(i,t){i.getImage().src=t}class Rx extends Ex{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",r=t.tileGrid!==void 0?t.tileGrid:ax({extent:Iu(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:r,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}const Cx='&#169; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors.';class DT extends Rx{constructor(t){t=t||{};let e;t.attributions!==void 0?e=t.attributions:e=[Cx];const r=t.crossOrigin!==void 0?t.crossOrigin:"anonymous",s=t.url!==void 0?t.url:"https://tile.openstreetmap.org/{z}/{x}/{y}.png";super({attributions:e,attributionsCollapsible:!1,cacheSize:t.cacheSize,crossOrigin:r,interpolate:t.interpolate,maxZoom:t.maxZoom!==void 0?t.maxZoom:19,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileLoadFunction:t.tileLoadFunction,transition:t.transition,url:s,wrapX:t.wrapX,zDirection:t.zDirection})}}var Nl=function(i,t){return Nl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])},Nl(i,t)};function Io(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Nl(i,t);function e(){this.constructor=i}i.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function zl(i){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&i[t],r=0;if(e)return e.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&r>=i.length&&(i=void 0),{value:i&&i[r++],done:!i}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Gl(i,t){var e=typeof Symbol=="function"&&i[Symbol.iterator];if(!e)return i;var r=e.call(i),s,a=[],u;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(h){u={error:h}}finally{try{s&&!s.done&&(e=r.return)&&e.call(r)}finally{if(u)throw u.error}}return a}function Ul(i,t,e){if(e||arguments.length===2)for(var r=0,s=t.length,a;r<s;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return i.concat(a||Array.prototype.slice.call(t))}function wn(i){return typeof i=="function"}function mg(i){var t=function(r){Error.call(r),r.stack=new Error().stack},e=i(t);return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var vl=mg(function(i){return function(e){i(this),this.message=e?e.length+` errors occurred during unsubscription:
`+e.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=e}});function Wl(i,t){if(i){var e=i.indexOf(t);0<=e&&i.splice(e,1)}}var Ao=function(){function i(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var t,e,r,s,a;if(!this.closed){this.closed=!0;var u=this._parentage;if(u)if(this._parentage=null,Array.isArray(u))try{for(var h=zl(u),c=h.next();!c.done;c=h.next()){var d=c.value;d.remove(this)}}catch(A){t={error:A}}finally{try{c&&!c.done&&(e=h.return)&&e.call(h)}finally{if(t)throw t.error}}else u.remove(this);var g=this.initialTeardown;if(wn(g))try{g()}catch(A){a=A instanceof vl?A.errors:[A]}var y=this._finalizers;if(y){this._finalizers=null;try{for(var v=zl(y),C=v.next();!C.done;C=v.next()){var T=C.value;try{nd(T)}catch(A){a=a??[],A instanceof vl?a=Ul(Ul([],Gl(a)),Gl(A.errors)):a.push(A)}}}catch(A){r={error:A}}finally{try{C&&!C.done&&(s=v.return)&&s.call(v)}finally{if(r)throw r.error}}}if(a)throw new vl(a)}},i.prototype.add=function(t){var e;if(t&&t!==this)if(this.closed)nd(t);else{if(t instanceof i){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}},i.prototype._hasParent=function(t){var e=this._parentage;return e===t||Array.isArray(e)&&e.includes(t)},i.prototype._addParent=function(t){var e=this._parentage;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t},i.prototype._removeParent=function(t){var e=this._parentage;e===t?this._parentage=null:Array.isArray(e)&&Wl(e,t)},i.prototype.remove=function(t){var e=this._finalizers;e&&Wl(e,t),t instanceof i&&t._removeParent(this)},i.EMPTY=function(){var t=new i;return t.closed=!0,t}(),i}(),yg=Ao.EMPTY;function vg(i){return i instanceof Ao||i&&"closed"in i&&wn(i.remove)&&wn(i.add)&&wn(i.unsubscribe)}function nd(i){wn(i)?i():i.unsubscribe()}var xx={Promise:void 0},Tx={setTimeout:function(i,t){for(var e=[],r=2;r<arguments.length;r++)e[r-2]=arguments[r];return setTimeout.apply(void 0,Ul([i,t],Gl(e)))},clearTimeout:function(i){return clearTimeout(i)},delegate:void 0};function Ix(i){Tx.setTimeout(function(){throw i})}function id(){}function $s(i){i()}var Eg=function(i){Io(t,i);function t(e){var r=i.call(this)||this;return r.isStopped=!1,e?(r.destination=e,vg(e)&&e.add(r)):r.destination=Lx,r}return t.create=function(e,r,s){return new kl(e,r,s)},t.prototype.next=function(e){this.isStopped||this._next(e)},t.prototype.error=function(e){this.isStopped||(this.isStopped=!0,this._error(e))},t.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},t.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,i.prototype.unsubscribe.call(this),this.destination=null)},t.prototype._next=function(e){this.destination.next(e)},t.prototype._error=function(e){try{this.destination.error(e)}finally{this.unsubscribe()}},t.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},t}(Ao),Ax=function(){function i(t){this.partialObserver=t}return i.prototype.next=function(t){var e=this.partialObserver;if(e.next)try{e.next(t)}catch(r){Vs(r)}},i.prototype.error=function(t){var e=this.partialObserver;if(e.error)try{e.error(t)}catch(r){Vs(r)}else Vs(t)},i.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(e){Vs(e)}},i}(),kl=function(i){Io(t,i);function t(e,r,s){var a=i.call(this)||this,u;return wn(e)||!e?u={next:e??void 0,error:r??void 0,complete:s??void 0}:u=e,a.destination=new Ax(u),a}return t}(Eg);function Vs(i){Ix(i)}function bx(i){throw i}var Lx={closed:!0,next:id,error:bx,complete:id},Sx=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Mx(i){return i}function Ox(i){return i.length===0?Mx:i.length===1?i[0]:function(e){return i.reduce(function(r,s){return s(r)},e)}}var rd=function(){function i(t){t&&(this._subscribe=t)}return i.prototype.lift=function(t){var e=new i;return e.source=this,e.operator=t,e},i.prototype.subscribe=function(t,e,r){var s=this,a=Dx(t)?t:new kl(t,e,r);return $s(function(){var u=s,h=u.operator,c=u.source;a.add(h?h.call(a,c):c?s._subscribe(a):s._trySubscribe(a))}),a},i.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){t.error(e)}},i.prototype.forEach=function(t,e){var r=this;return e=sd(e),new e(function(s,a){var u=new kl({next:function(h){try{t(h)}catch(c){a(c),u.unsubscribe()}},error:a,complete:s});r.subscribe(u)})},i.prototype._subscribe=function(t){var e;return(e=this.source)===null||e===void 0?void 0:e.subscribe(t)},i.prototype[Sx]=function(){return this},i.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Ox(t)(this)},i.prototype.toPromise=function(t){var e=this;return t=sd(t),new t(function(r,s){var a;e.subscribe(function(u){return a=u},function(u){return s(u)},function(){return r(a)})})},i.create=function(t){return new i(t)},i}();function sd(i){var t;return(t=i??xx.Promise)!==null&&t!==void 0?t:Promise}function Px(i){return i&&wn(i.next)&&wn(i.error)&&wn(i.complete)}function Dx(i){return i&&i instanceof Eg||Px(i)&&vg(i)}var Fx=mg(function(i){return function(){i(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),wg=function(i){Io(t,i);function t(){var e=i.call(this)||this;return e.closed=!1,e.currentObservers=null,e.observers=[],e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return t.prototype.lift=function(e){var r=new od(this,this);return r.operator=e,r},t.prototype._throwIfClosed=function(){if(this.closed)throw new Fx},t.prototype.next=function(e){var r=this;$s(function(){var s,a;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var u=zl(r.currentObservers),h=u.next();!h.done;h=u.next()){var c=h.value;c.next(e)}}catch(d){s={error:d}}finally{try{h&&!h.done&&(a=u.return)&&a.call(u)}finally{if(s)throw s.error}}}})},t.prototype.error=function(e){var r=this;$s(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=e;for(var s=r.observers;s.length;)s.shift().error(e)}})},t.prototype.complete=function(){var e=this;$s(function(){if(e._throwIfClosed(),!e.isStopped){e.isStopped=!0;for(var r=e.observers;r.length;)r.shift().complete()}})},t.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(t.prototype,"observed",{get:function(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0},enumerable:!1,configurable:!0}),t.prototype._trySubscribe=function(e){return this._throwIfClosed(),i.prototype._trySubscribe.call(this,e)},t.prototype._subscribe=function(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)},t.prototype._innerSubscribe=function(e){var r=this,s=this,a=s.hasError,u=s.isStopped,h=s.observers;return a||u?yg:(this.currentObservers=null,h.push(e),new Ao(function(){r.currentObservers=null,Wl(h,e)}))},t.prototype._checkFinalizedStatuses=function(e){var r=this,s=r.hasError,a=r.thrownError,u=r.isStopped;s?e.error(a):u&&e.complete()},t.prototype.asObservable=function(){var e=new rd;return e.source=this,e},t.create=function(e,r){return new od(e,r)},t}(rd),od=function(i){Io(t,i);function t(e,r){var s=i.call(this)||this;return s.destination=e,s.source=r,s}return t.prototype.next=function(e){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,e)},t.prototype.error=function(e){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,e)},t.prototype.complete=function(){var e,r;(r=(e=this.destination)===null||e===void 0?void 0:e.complete)===null||r===void 0||r.call(e)},t.prototype._subscribe=function(e){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(e))!==null&&s!==void 0?s:yg},t}(wg);const Nx=(i,t,e,r)=>{t.set(e,r);let s=i.getArray().findIndex(a=>(a.get(e)||0)>=r);s<0&&(s=i.getLength()),i.insertAt(s,t)},FT=new Ke,ad=(i,t)=>i.get(t);var Xl=(i=>(i.LayerUid="olcLayerUid",i.Label="olcLabel",i.visible="olcVisible",i))(Xl||{});class zx{constructor(t,e){pr(this,"layerAddedId","olcLayerAdded");pr(this,"map");pr(this,"layerGroup");this.map=t,this.addObservables(e)}get layerAdded(){return ad(this.map,this.getObservableName(this.layerAddedId))}getLayerGroup(){return this.layerGroup}clearAll(){this.layerGroup.getLayers().getArray().slice().forEach(t=>this.map.removeLayer(t)),this.layerGroup.setLayers(new sn)}addLayer(t,e){this.setupAddLayer(t,e)&&(this.layerGroup.getLayers().push(t),this.layerAdded.next(t))}getLayer(t){return this.layerGroup.getLayers().getArray().find(e=>e.get("olcLayerUid")===t)||null}getAttributions(){return ti.uniq(ti.flatten(this.layerGroup.getLayers().getArray().filter(t=>t.getVisible()).map(t=>this.getAttributionFromLayer(t))))}refreshSource(){this.getAllSources().forEach(t=>t.refresh())}getAllSources(){return this.layerGroup.getLayers().getArray().filter(t=>t.get("source")).map(t=>t.get("source")).filter(t=>!ti.isNil(t))}setupAddLayer(t,e){if(ti.isNil(e)||ti.isNil(t)||e.length===0){let r=`Unable to add layer ${e||"<empty>"}.`;return ti.isNil(t)&&(r=`${r} The layer is not defined.`),console.error(r),!1}return this.getLayer(e)?!1:(t.set("olcLayerUid",e),!0)}addLayerGroup(t,e){const r=this.findLayerGroup(t);if(r){this.layerGroup=r;return}this.layerGroup=new $i({properties:{olcLayerUid:t}}),Nx(this.map.getLayers(),this.layerGroup,`olcPosition-${t}`,e)}findLayerGroup(t){return this.map.getLayers().getArray().find(e=>e.get("olcLayerUid")===t&&e instanceof $i)||null}getObservableName(t){const e=this.layerGroup.get("olcLayerUid");return this.getObservableNameFromLayerUid(t,e)}getObservableNameFromLayerUid(t,e){return`${t}-${e}`}addObservables(t){const e=this.getObservableNameFromLayerUid(this.layerAddedId,t);ad(this.map,e)||this.map.set(e,new wg)}getAttributionFromLayer(t){var s;const e=(s=t.getSource())==null?void 0:s.getAttributions(),r=e?e({}):[];return Array.isArray(r)?r:[r]}}const Gx="olcBackgroundLayerGroup";class NT extends zx{constructor(t,e={}){const r=e[Xl.LayerUid]||Gx;super(t,r);const s=ti.isNil(e.position)?0:e.position;this.addLayerGroup(r,s)}toggleVisible(t){const e=this.layerGroup.getLayers().getArray(),r=e.find(s=>s.get(Xl.LayerUid)===t);e.forEach(s=>{s.setVisible(s===r)})}}export{xt as $,dd as A,Jx as B,Qx as C,rT as D,it as E,jx as F,Iw as G,hT as H,eT as I,sT as J,uT as K,iT as L,Hi as M,lT as N,tT as O,nu as P,cE as Q,Kr as R,eu as S,Nr as T,qs as U,mn as V,md as W,Vd as X,eR as Y,iR as Z,Mf as _,fd as a,Ki as a$,Fn as a0,uf as a1,Vx as a2,Cf as a3,_T as a4,LT as a5,Un as a6,Yl as a7,Dt as a8,rR as a9,Ke as aA,Br as aB,oi as aC,ui as aD,FT as aE,Xl as aF,Zl as aG,hf as aH,Vt as aI,Xx as aJ,Gf as aK,Wf as aL,ET as aM,wT as aN,kf as aO,hC as aP,lC as aQ,xE as aR,Uf as aS,uC as aT,Si as aU,RE as aV,xT as aW,CT as aX,RT as aY,vT as aZ,TT as a_,dT as aa,pT as ab,sn as ac,We as ad,TE as ae,te as af,to as ag,bl as ah,ni as ai,pw as aj,Bx as ak,ho as al,FE as am,Hx as an,hi as ao,oT as ap,Zx as aq,fT as ar,MT as as,PT as at,DT as au,En as av,NT as aw,ti as ax,gT as ay,mT as az,fo as b,qC as b0,AT as b1,Mr as b2,Ie as b3,bT as b4,Ad as b5,$x as b6,IT as b7,se as b8,Hs as b9,mR as bA,Rl as bB,rx as bC,js as bD,Lr as bE,PE as bF,mo as bG,zx as bH,ad as bI,wg as bJ,Hw as bK,Fr as ba,ld as bb,kx as bc,qx as bd,wu as be,ut as bf,tx as bg,Ue as bh,Tt as bi,ke as bj,cu as bk,OT as bl,on as bm,Yx as bn,zE as bo,OE as bp,LC as bq,Rn as br,wt as bs,IE as bt,Wx as bu,Wd as bv,cT as bw,Ae as bx,uE as by,Ud as bz,Ur as c,bw as d,AE as e,_d as f,Zi as g,aE as h,Wr as i,Od as j,Mw as k,mt as l,Sd as m,Nd as n,Gd as o,ru as p,Dd as q,Rw as r,Md as s,Pd as t,Pt as u,zd as v,nT as w,aT as x,Fd as y,ki as z};
